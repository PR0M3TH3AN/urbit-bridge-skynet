{"version":3,"sources":["indigo-react/components/IndigoApp.js","indigo-react/components/Grid.js","indigo-react/components/Flex.js","indigo-react/components/Typography.js","indigo-react/components/Input.js","indigo-react/components/AccessoryIcon.js","indigo-react/components/SelectInput.js","indigo-react/lib/useOnClickOutside.js","indigo-react/components/CheckboxInput.js","indigo-react/components/LinkButton.js","indigo-react/components/ToggleInput.js","indigo-react/components/Button.js","indigo-react/components/IconButton.js","lib/useRouter.js","form/helpers.js","lib/useBreakpoints.js","nockjs/list.js","nockjs/bits.js","nockjs/hamt.js","components/Router.js","store/online.js","lib/starRelease.js","store/starRelease.js","store/lib/useInvitesStore.js","lib/useSetState.js","lib/need.js","store/lib/useResidentsStore.ts","store/lib/usePointStore.js","store/lib/useDetailsStore.js","store/lib/useBirthdaysStore.js","store/lib/useRekeyDateStore.js","store/lib/useControlledPointsStore.js","store/lib/useEclipticOwnerStore.js","store/pointCache.js","store/txnCursor.js","store/Provider.js","lib/nest.js","store/lib/useStarReleaseStore.js","lib/routeNames.js","lib/useLocalStorageState.js","lib/useHasDisclaimed.js","components/WarningBox.js","views/Disclaimer.js","lib/flowCommand.ts","assets/secret-show.svg","lib/timeout.js","assets/secret-hidden.svg","views/Login/Ticket.js","lib/useImpliedPoint.js","components/Accordion.js","components/UploadButton.js","form/UploadInput.js","views/Login/Metamask.js","lib/useWalletConnect.ts","views/Login/WalletConnect.tsx","views/Login/Other.js","views/Login/Keystore.js","views/Login/Mnemonic.js","components/ViewHeader.js","lib/tank.js","lib/usePreviousValue.js","lib/useDeepEqualReference.js","lib/getSuggestedGasPrice.js","lib/useGasPrice.js","assets/info.svg","lib/useEthereumTransaction.js","lib/explorer.js","lib/useCopiable.js","components/CopyButton.js","components/ProgressButton.js","assets/copy.svg","components/Highlighted.js","components/WithTooltip.tsx","components/CopiableWithTooltip.js","components/CopiableAddress.js","components/NeedFundsNotice.js","components/NoticeBox.js","components/InlineEthereumTransaction.js","views/Senate/Documents.js","lib/child.js","components/Tabs.js","lib/usePermissionsForPoint.js","lib/useSyncPoints.js","lib/point.js","views/Release/Active.js","lib/pluralize.js","views/Release/Locked.js","views/Release.js","views/Release/Transfer.js","components/Greeting.js","lib/useWasGreeted.js","lib/card.js","components/Passport.js","components/BarGraph.js","components/Chip.js","components/InviteSigilList.js","lib/useInvites.js","lib/useCurrentPermissions.js","lib/useBlockWindowClose.js","lib/inviteMail.js","lib/useMailer.js","lib/useInviter.js","form/EmailChipInput.js","views/Invite/Email.js","views/Invite/Url.js","views/Invite/Inviter.js","views/Point.js","lib/useLifecycle.js","views/Points.js","views/Activate/ActivateFlow.js","components/FooterButton.js","lib/invite.js","lib/useImpliedTicket.js","components/PaperBuilder.js","components/Steps.js","views/Activate/PassportView.js","views/Activate/PassportVerify.js","lib/reticket.js","components/LoadingBar.js","views/Activate/PassportTransfer.js","views/Activate/ActivatePassport.js","views/Activate/PassportDownload.js","assets/search.svg","views/Activate.js","views/Activate/ActivateCode.js","components/Crumbs.js","views/Invite/Cohort.js","lib/useCurrentPointName.js","views/CancelTransfer.js","components/NetworkingKeys.js","components/AlertBox.tsx","components/DownloadKeyfileButton.js","lib/useKeyfileGenerator.js","components/CopyButtonWide.tsx","views/UrbitOS/AccessCode.tsx","views/UrbitOS/ChangeSponsor.js","views/UrbitOS.js","views/UrbitOS/Home.tsx","views/UrbitOS/NetworkingKeys.js","lib/proxy.js","lib/capitalize.js","lib/useSigilDownloader.js","lib/SigilDownloader.js","form/ColorInput.js","views/UrbitID/SigilGenerator.js","views/UrbitID/ResetKeys/ResetVerify.js","views/UrbitID/ResetKeys/ResetExecute.js","views/UrbitID/ResetKeys.js","views/UrbitID/ResetKeys/ResetConfirm.js","views/UrbitID/ResetKeys/ResetDownload.js","views/UrbitID.js","views/UrbitID/Home.js","views/UrbitID/DownloadKeys.js","views/UrbitID/SetProxy.js","views/UrbitID/Transfer.js","views/Residents.js","components/CopiableAddressWrap.js","views/Bitcoin/SignTransaction.js","lib/router.js","views/Activate/useActivateFlowState.js","views/Login.tsx","lib/useIsEclipticOwner.js","lib/useRejectedIncomingPointTransfers.js","views/CreateGalaxy.js","views/IssueChild.js","lib/useConstant.js","views/Senate.js","views/Senate/Upgrades.js","views/Party/PartySetPoolSize.js","views/AcceptTransfer.js","views/AcceptLockup.js","views/Adopt.js","views/Bitcoin/Bitcoin.js","views/Bitcoin/Xpub.js","components/WithErrorBoundary.js","components/GlobalErrorBoundary.js","Bridge.js","index.js","components/Footer.js","lib/authToken.ts","lib/ledger.js","lib/walletgen.js","nockjs/noun.js","components/Sigil.js","lib/trezor.ts","components/AspectRatio.js","components/MaybeSigil.js","lib/networkCode.js","lib/constants.ts","lib/isPromise.js","form/validators.js","lib/contracts.js","store/network.js","store/pointCursor.js","lib/dateFormat.js","lib/metamask.ts","lib/useMedia.js","lib/MediaQuery.js","lib/LocalRouter.js","store/wallet.js","components/Buttons.js","form/ValuesHandler.js","form/ValidationPauser.js","form/BridgeForm.js","lib/utils/address.ts","components/InputSigil.js","form/Inputs.js","components/MiniBackButton.js","components/View.js","form/FormError.js","lib/validators.js","lib/convertToInt.js","views/Login/PrivateKey.js","views/Login/Ledger.tsx","lib/WalletConnect.ts","views/Login/Trezor.tsx","form/SubmitButton.js","nockjs/serial.js","store/history.js","components/Blinky.js","lib/useInterval.js","lib/txn.ts","lib/lib.js","lib/flags.js","lib/network.js","lib/keys.js","form/Condition.js","lib/patp2dec.js","lib/wallet.ts","lib/useLoginView.js","components/NavHeader.js","form/formatters.js","lib/error.js"],"names":["IndigoApp","debug","rest","className","cn","style","position","Grid","React","forwardRef","ref","as","As","gap","align","justify","Item","full","half","third","fourth","rows","cols","justifySelf","alignSelf","length","Divider","color","Flex","row","wrap","col","Error","flex","typeWith","DefaultComponent","defaultClassName","H1","H3","H4","H5","P","B","Breadcrumb","Text","HelpText","ErrorText","Input","type","name","label","accessory","labelAccessory","disabled","mono","config","obscure","onEnter","useField","input","meta","active","error","submitError","dirtySinceLastSubmit","submitting","submitSucceeded","touched","valid","BaseComponent","indicateError","pointerEvents","cursor","black","gray4","htmlFor","minHeight","id","undefined","top","right","height","width","overflow","AccessoryIcon","props","Pending","Success","Failure","SelectInput","placeholder","options","warning","useState","isOpen","setIsOpen","useRef","handler","useEffect","listener","event","current","contains","target","document","addEventListener","removeEventListener","useOnClickOutside","useCallback","toggleOpen","onFocus","text","find","o","value","onClick","left","maxHeight","map","option","e","stopPropagation","onChange","onBlur","CheckboxInput","inline","white","mv2","mr3","mr1","checked","LinkButton","children","rel","ToggleInput","inverseLabel","inverseColor","small","pointer","f5","f6","Button","solid","success","disabledDetail","detail","detailClassName","background","center","tabIndex","onKeyPress","key","p4","display","IconButton","secondary","hpadding","vpadding","ph2","pv2","fontSize","fontWeight","NULL_DATA","useRouter","names","views","initialRoutes","routes","setRoutes","oldPopState","size","push","data","Object","keys","join","popAndPush","slice","pop","count","window","history","pushState","popTo","index","findIndex","route","peek","last","replaceWith","reset","includes","_includes","r","useMemo","get","Route","scrollTo","onpopstate","stopImmediatePropagation","WARNING","onlyHasWarning","obj","useBreakpoints","values","useMediaQuery","noun","require","Cell","zero","Atom","yes","module","exports","flop","a","b","equals","deep","head","tail","forEach","n","f","BigInteger","one","no","met","bits","number","bitLength","gth","compareTo","sub","subtract","signum","bytesToWords","bytes","i","w","len","trim","words","Array","wordsToBytes","buf","bytesToAtom","byt","parts","toString","atomToBytes","atom","atomToWords","wordsToAtom","malt","slaq","bloq","chop","fum","wid","tou","dst","src","j","mek","baf","bat","hut","san","wuf","wut","waf","raf","wat","rat","hop","maxCat","fromInt","catBits","cut","c","d","ai","intValue","bi","ci","sal","add","dec","lth","gte","lte","bex","ONE","shiftLeft","lsh","rsh","shiftRight","end","mix","xor","cat","lew","ler","all","can","pos","i_cab","pi_cab","qi_cab","tot","cab","Slot","Node","call","this","slots","Bucket","singles","Single","val","NounMap","prototype","create","constructor","insert","lef","rem","inx","sot","s","rom","mug","m","Router","useHistory","ONLINE_STATUS","ONLINE","Symbol","OFFLINE","UNKNOWN","getNetworkState","navigator","onLine","OnlineContext","createContext","mapRange","amount","cb","generateWithdrawTxs","contracts","batchLimits","to","generateConditionalWithdrawTxs","csrTxs","lsrTxs","linearSR","withdrawTo","generateLinearWithdrawTxs","offset","next","currentAmount","Math","min","conditionalSR","getLockupKind","address","getCommitment","conditional","getBatch","linear","haveConditional","total","haveLinear","getConditional","Promise","getBatches","getRemainingStars","commitment","batches","remaining","available","withdrawn","balance","_","idx","getWithdrawLimit","limits","parseInt","getWithdrawn","getForfeited","forfeited","availableInBatch","withdrawnTotal","reduce","acc","approvedTransferTo","getLinear","batch","limit","StarReleaseCacheContext","useStarReleaseCache","useContext","EMPTY_INVITES","availableInvites","Nothing","sentInvites","acceptedInvites","acceptedPoints","pendingPoints","useInvitesStore","useNetwork","initialState","initialStateRef","state","_setState","setState","items","useSetState","invitesCache","addToInvitesCache","getInvites","point","syncInvites","_contracts","getOrElse","azimuth","getTotalUsableInvites","getInvited","invitedPoints","invitedPoint","isActive","activity","filter","chain","zipWith","partition","arr","x","Just","needBuilder","fn","matchWith","p","details","BRIDGE_ERROR","MISSING_POINT_DETAILS","web3","MISSING_WEB3","MISSING_CONTRACTS","wallet","MISSING_WALLET","urbitWallet","MISSING_URBIT_WALLET","addressFromWallet","MISSING_POINT","emptyCacheEntry","residentCount","requestCount","residents","requests","usePointStore","detailsCache","_setDetailsCache","addToDetails","entry","cache","getDetails","syncDetails","getPoint","pointCache","useDetailsStore","birthdayCache","_setBirthdayCache","addToBirthdayCache","getBirthday","syncBirthday","_web3","hasInstance","getActivationBlock","birthBlock","eth","getBlock","block","Date","timestamp","useBirthdaysStore","birthdays","rekeyDateCache","_setRekeyDateCache","addToRekeyDateCache","getRekeyDate","syncRekeyDate","getPastEvents","fromBlock","toBlock","logs","blockNumber","Result","Ok","useRekeyDateStore","rekeyDates","invites","useWallet","controlledPoints","_setControlledPoints","syncControlledPoints","_wallet","getOwnedPoints","getTransferringFor","getManagerFor","getVotingFor","getSpawningFor","ownedPoints","incomingPoints","managingPoints","votingPoints","spawningPoints","console","useControlledPointsStore","residentCache","_setResidentCache","addToResidentCache","getResidents","need","syncResidentCount","pointSize","getPointSize","PointSize","Planet","isGalaxy","Galaxy","getSponsoringCount","getEscapeRequestsCount","parsedCount","Number","_residentCount","syncResidents","getSponsoring","getEscapeRequests","_residents","useResidents","ecliptic","eclipticOwner","_setEclipticOwner","syncEclipticOwner","owner","useEclipticOwnerStore","syncDates","syncExtras","PointCacheContext","usePointCache","TxnCursorContext","nest","components","createFactory","reduceRight","child","factory","HistoryProvider","online","setOnline","handleOnlineStatus","_useOnline","Provider","NetworkProvider","WalletProvider","PointCursorProvider","txnCursor","setTxnCursor","_useTxnCursor","MediaQueryProvider","starReleaseDetails","_setDetails","setBatchLimits","syncStarReleaseDetails","kind","result","withdraw","useStarReleaseStore","ROUTE_NAMES","DEFAULT","DISCLAIMER","ACTIVATE","INVITE_TRANSACTIONS","INVITES_MANAGE","LOGIN","LOGIN_OTHER","REDOWNLOAD","RETICKET","PERMISSIONS","ACCEPT_TRANSFER","CANCEL_TRANSFER","POINTS","POINT","SIGIL_GENERATOR","CREATE_GALAXY","SENATE","DOCUMENTS","UPGRADES","ISSUE_CHILD","PARTY_SET_POOL_SIZE","INVITE_COHORT","STAR_RELEASE","ACCEPT_LOCKUP","URBIT_OS","URBIT_ID","RESIDENTS","ADOPT","BITCOIN","BITCOIN_XPUB","BITCOIN_SIGN_TRANSACTION","useLocalStorageState","initialValue","localStorage","getItem","setItem","JSON","stringify","parse","useHasDisclaimed","WarningBox","TEXT_STYLE","ActivateDisclaimer","useLocalRouter","setHasDisclaimed","validate","composeValidator","checkbox","buildCheckboxValidator","initialValues","goNext","View","BridgeForm","afterSubmit","handleSubmit","SubmitButton","COMMANDS","useFlowCommand","flow","location","search","substr","split","arg","pam","decodeURIComponent","lock","isValidAddress","from","atob","utx","log","_rect","_path","timeout","ms","resolve","setTimeout","_extends","assign","arguments","source","hasOwnProperty","apply","_objectWithoutProperties","excluded","sourceKeys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","SvgSecretShow","_ref","svgRef","title","titleId","viewBox","fill","xmlns","fillRule","clipRule","_g","_defs","ForwardRef","SvgSecretHidden","y","filterUnits","colorInterpolationFilters","floodOpacity","in","dx","mode","in2","AdvancedOptions","Condition","when","is","boxSizing","TicketInputAccessory","Ticket","goHome","useLoginView","WALLET_TYPES","TICKET","setUrbitWallet","setPointCursor","usePointCursor","impliedPoint","subdomain","host","patp","ensurePatFormat","ob","isValidPatp","useImpliedPoint","didWarn","validateForm","errors","useShards","shard1","shard2","shard3","empty","ticket","onSubmit","kg","v","patp2dec","urbitWalletFromTicket","passphrase","isOwner","ownership","isTransferProxy","FORM_ERROR","useAdvanced","usePassphrase","buildPointValidator","buildPatqValidator","buildShardValidator","ticketHidden","buildPassphraseValidator","usePasshrase","PointInput","TicketInput","hidden","PassphraseInput","FormError","isWarning","Accordion","currentTab","onTabChange","Tab","Fragment","gray3","UploadButton","button","UploadInput","validating","handleUpload","element","file","files","item","reader","FileReader","onload","failure","onerror","onabort","readAsText","Login","ethereum","selectedAddress","abbreviateAddress","useWalletConnect","setWallet","setAuthToken","resetWallet","connector","setConnector","setAddress","peerMeta","setPeerMeta","resetConnector","newConnector","WalletConnect","bridge","qrcodeModal","QRCodeModal","accounts","connect","connected","createSession","disconnect","killSession","authenticate","authToken","getAuthToken","walletType","WALLET_CONNECT","token","message","warn","isConnected","peerIcon","icons","iconCandidates","pm","signTransaction","gas","gasPrice","nonce","reject","then","signature","catch","sendTransaction","txHash","on","payload","params","_payload","off","WalletConnectLogin","LegacyText","gridArea","ForwardButton","NAMES","PRIVATE_KEY","KEYSTORE","LEDGER","TREZOR","METAMASK","MNEMONIC","VIEWS","PrivateKey","keystore","buildUploadValidator","json","privateKey","keythereum","EthereumWallet","Ledger","Trezor","setWalletType","send","MetamaskWallet","href","setAuthMnemonic","setWalletHdPath","anyMnemonic","setAnyMnemonic","mnemonicValidator","buildAnyMnemonicValidator","buildMnemonicValidator","mnemonic","hdpath","buildHdPathValidator","onValues","walletFromMnemonic","DEFAULT_HD_PATH","MnemonicInput","HdPathInput","OPTIONS","Other","setCurrentTab","hardwareAllowed","ViewHeader","TANK_ADDRESS","port","isRopsten","baseUrl","sendRequest","where","what","fetch","method","headers","body","response","ok","remainingTransactions","fundTransactions","signedTxs","txs","ensureFundsFor","cost","askForFunding","gotFunding","some","tx","toBN","getBalance","res","waitForTransactionConfirm","newBalance","lt","waitForBalance","minBalance","retry","bail","RETRY_OPTIONS","usePreviousValue","prev","curr","useDeepEqualReference","prevValue","isEqual","getSuggestedGasPrice","networkType","NETWORK_TYPES","ROPSTEN","LOCAL","DEFAULT_GAS_PRICE_GWEI","status","suggestedGasPrice","ProposeGasPrice","isNaN","MAX_GAS_PRICE_GWEI","useGasPrice","initialGasPrice","setSuggestedGasPrice","setGasPrice","mounted","resetGasPrice","STATE","useEthereumTransaction","transactionBuilder","refetch","initialGasLimit","GAS_LIMITS","walletHdPath","pointCursor","wcSign","wcSend","_setError","setError","chainId","setChainId","setNonce","gasLimit","unsignedTransactions","setUnsignedTransactions","signedTransactions","setSignedTransactions","txHashes","setTxHashes","needFunds","setNeedFunds","confirmationProgress","setConfirmationProgress","finalCost","setFinalCost","initializing","constructed","isDefaultState","signed","fakeSigned","broadcasted","confirmed","completed","inputsLocked","canSign","construct","unconstruct","generateAndSign","utxs","isArray","txnSigner","txnSender","txn","toFixed","txns","Transaction","broadcast","rawTxs","stx","hexify","serialize","costGwei","mul","safeToWei","usedTank","hashes","sendSignedTransaction","hash","PROGRESS_ANIMATION_DELAY_MS","receipts","safeFromWei","receipt","gasUsed","getTransactionCount","net","getId","bind","SvgInfo","useEtherscanDomain","MAINNET","useCopiable","didCopy","setDidCopy","clearTimeout","copy","renderDefaultCopyText","CopyButton","doCopy","green3","ProgressButton","progress","blinkIf","bottom","Highlighted","red3","SvgCopy","TooltipPosition","WithTooltip","content","Top","isHovered","setHovered","onMouseEnter","onMouseLeave","positionStyle","TopRight","CopiableWithTooltip","CopiableAddress","NeedFundsNotice","Blinky","NoticeBox","InlineEthereumTransaction","onReturn","showReceipt","setShowReceipt","toggleShowReceipt","showConfigureInput","showBroadcastButton","showLoadingButton","canBroadcast","showSignedTx","showGasDetails","_setShowGasDetails","toggleGasDetails","viewSigned","form","serializedTxsHex","numTxs","maxCost","gasInfo","extra","RestartButton","TransactionReceipt","onClose","GenerateButton","loading","max","convertToInt","SignedTransactionList","serializedTxHex","txUrls","domain","useExploreTxUrls","renderDocumentHash","doc","MIN_STAR","pow","MIN_PLANET","MAX_GALAXY","MAX_STAR","getSpawnCandidate","galaxy","floor","random","star","Tabs","isFirst","NULL_PERMISSIONS","isActiveOwner","isManagementProxy","isSpawnProxy","isVotingProxy","isManagementProxySet","isSpawnProxySet","isVotingProxySet","isTransferProxySet","canManage","canTransfer","canSpawn","canVote","spawnIsDelegatedSending","usePermissionsForPoint","isPlanet","isStar","Star","isParent","staticPermissions","eqAddr","managementProxy","spawnProxy","votingProxy","transferProxy","isZeroAddress","keyRevisionNumber","delegatedSending","buildSyncHook","getFn","points","prevPoints","newPoints","difference","useSyncDates","useSyncDetails","useSyncExtras","buildKeyType","permissions","ActiveViewRow","goPoint","keyType","Sigil","colors","pluralize","singular","plural","isPlural","MatchPluralizeStars","quantity","_quantity","green2","red4","matchBlinky","AddressIndicator","isOwn","ps","Boolean","goActive","useWithdrawStars","convertToNumber","numStars","canWithdraw","buildNumberValidator","NumberInput","AddressInput","approvedFor","approved","approveCommitmentTransfer","approveBatchTransfer","useTransferLockup","theirs","wasGreeted","setWasGreeted","pointName","dismiss","mapToRange","l1","h1","l2","h2","seq","num","Matrix","at","nn","ne","ee","se","ss","sw","ww","nw","set","coord","dirs","NN","NE","EE","SE","SS","SW","WW","NW","new","rs","cs","chunkStr","str","RegExp","match","Base3Mapping","makeSigil","margin","renderer","reactRenderer","sigil","symbols","Passport","inverted","animationMode","makeMatrix","addr","onlyTheNumberPart","substring","big","BN","b10","padStart","chunkSize","ceil","chunks","startMatrix","chunk","int","matrix","vect","sx","sy","walk","ch","rand","bgColor","fgColor","fontFamily","backgroundColor","border","borderRadius","marginBottom","minWidth","flexDirection","padding","alignItems","marginLeft","marginTop","paddingTop","_row","justifyContent","_col","spriteSheet","spriteSheetHeight","spriteSheetWidth","backgroundImage","backgroundPosition","backgroundSize","maxWidth","animationDelay","Mini","BarGraph","sent","accepted","_available","_sent","_accepted","Chip","InviteSigilList","_acceptedPoints","take","_pendingPoints","renderSigil","klassName","MaybeSigil","useInvites","useCurrentPermissions","onBeforeUnload","preventDefault","returnValue","useBlockWindowClose","hasReceived","recipient","sendMail","sender","STUB_MAILER","process","REACT_APP_STUB_MAILER","GAS_LIMIT","GIFT_PLANET","STATUS","useInviter","setInvites","setProgress","txStatus","setTxStatus","isDone","resetInvites","generateInvites","numInvites","_authToken","getPlanetsToSend","planets","signedInvites","planet","wg","inviteTx","sendPoint","signedTx","rawTx","totalCost","tank","si","tankWasUsed","inviteErrors","confirmedInvites","txAndMailings","invite","onDelete","subscription","EmailChipInput","useFieldArray","fields","setValue","handleChange","addToChips","concat","handleKeyDown","handleDelete","remove","handleBlur","hasError","hasErrors","onKeyDown","INPUT","SENDING","SUCCESS","FAILURE","InviteMail","setSubmitting","getHasReceived","email","useMailer","setStatus","setCount","canInput","isSending","isFailed","FAILED","sendInvites","emails","compact","zip","mailingErrors","emailCount","mailErrors","validateHasReceived","buttonText","renderButton","percentProgress","uniq","buildArrayValidator","buildEmailValidator","initialValuesEqual","InviteUrl","generateInvite","renderGenerateButton","url","MAIL","URL","Inviter","condition","tab","setTab","newTab","InviteForm","showInviteForm","setShowInviteForm","goCohort","showInvites","_totalInvites","_pendingInvites","useLifecycle","maybeGetResult","defaultValue","hasTransferProxy","PointList","actions","ActionButtons","action","ActivateFlowContext","ActivateFlowProvider","useActivateFlow","FooterButton","Footer","generateWallet","boot","downloadWallet","paperWallets","keyfile","keyfilename","JSZip","ship","replace","zipName","folder","frames","frame","filename","givenName","image","generateAsync","saveAs","useImpliedTicket","isValidPatq","PaperBuilder","wallets","callback","show","output","Steps","PassportView","header","step","STUB_VERIFY_TICKET","isDevelopment","TRANSACTION_PROGRESS","reticketPointBetweenWallets","fromWallet","fromWalletType","fromWalletHdPath","toWallet","onUpdate","transferEth","nextRevision","transferTmpTx","transferPoint","TRANSFER","deriveNetworkSeedFromUrbitWallet","seed","networkSeed","networkKeys","deriveNetworkKeys","keysTx","configureKeys","addHexPrefix","crypt","public","auth","CRYPTO_SUITE_VERSION","CONFIGURE_KEYS","managementTx","setManagementProxy","management","SET_PROXY","spawnTx","setSpawnProxy","spawn","votingTx","setVotingProxy","voting","transferFinalTx","gasPriceGwei","gasPriceWeiBN","inviteNonce","txPairs","raw","sendAndAwaitAllSerial","realCost","sum","SEND_ETH","sendEthCost","remainder","gt","LoadingBar","labelForProgress","DOWNLOAD","VERIFY","derivedPoint","derivedWallet","generated","setGenerated","paper","setPaper","downloaded","setDownloaded","pointAsString","download","netkey","compileNetworkingKey","network","goToVerify","DownloadButton","goToTransfer","validateExactly","showTicket","resetActivateRouter","inviteWallet","resetActivateFlow","generalError","setGeneralError","setProcesss","goToLogin","goToRestart","handleUpdate","claimPoint","_inviteWallet","_point","CODE","PASSPORT","impliedTicket","hasDisclaimed","setDerivedWallet","setInviteWallet","setDerivedPoint","activationAllowed","goToPassport","generateTemporaryOwnershipWallet","owned","transferring","incoming","inset","router","publicToAddress","publicKey","LocalRouter","Disclaimer","Crumbs","lastIndex","textStyle","SvgSearch","SearchInput","CohortMember","pending","DetailText","CohortList","onlyPending","onSelectInvite","query","setQuery","filterPoints","startsWith","selectInvite","CohortMemberExpanded","hider","code","setCode","codeVisible","setCodeVisible","_details","fetchWallet","ALL","PENDING","useCurrentPointName","AdminCancelTransfer","setTransferProxy","ETH_ZERO_ADDR","useCancelTransfer","chainKeyProp","CURVE_ZERO_ADDR","renderNetworkKey","segments","segmentNetworkKey","NetworkingKeys","hasKeys","renderNetworkKeySection","renderDetail","continuityNumber","cryptoSuiteVersion","date","formatDotsWithTime","AlertBox","icon","DownloadKeyfileButton","generating","notice","useKeyfileGenerator","manualNetworkSeed","authMnemonic","setNotice","setGenerating","setKeyfile","networkRevision","hasNetworkingKeys","generate","attemptNetworkSeedDerivation","revision","_networkSeed","pair","keysMatchChain","generateCode","Blob","CopyButtonWide","AccessCode","data-testid","ChangeSponsor","onDone","sponsor","escape","useChangeSponsor","validateFormAsync","sponsorSize","validateMinimumPatpByteLength","CurrentEscape","cancelEscape","useCancelEscape","newSponsor","escapeRequestedTo","HOME","CHANGE_SPONSOR","NETWORKING_KEYS","showKeys","setShowKeys","showSponsor","toggleShowKeys","hasSetNetworkingKeys","networkKeysAction","goNetworkingKeys","goChangeSponsor","keyBind","escapeRequested","requested","setRequested","setManualNetworkSeed","randomSeed","keyfileAvailable","keyfileGenerating","keyfileBind","buildNetworkSeed","manualSeed","newNetworkRevision","randomHex","isDiscontinuity","_completed","useSetKeys","useNetworkSeed","buildHexValidator","useDiscontinuity","change","viewTitle","HexInput","PROXY_TYPE","proxyTypeToHuman","proxyType","proxyTypeToHumanDescription","capitalize","charAt","toUpperCase","useSigilDownloader","canvasRef","downloadSigil","_size","devicePixelRatio","canvas","ctx","getContext","ratio","scale","initCanvas","svg","stringRenderer","svgDocument","DOMParser","parseFromString","documentElement","baseVal","valueAsString","svgText","XMLSerializer","serializeToString","img","Image","loadImg","btoa","drawImage","png","dataURI","byteString","mimeString","ab","ArrayBuffer","ia","Uint8Array","charCodeAt","dataURItoBlob","toDataURL","clearRect","cleanupCanvas","ColorInput","isWhite","BG_COLORS","blue","blueLight","blueDark","redLight","red","redDark","greenLight","green","greenDark","yellowLight","yellow","yellowDark","FG_COLORS","CONFIRM","EXECUTE","newWallet","setNewWallet","generatedWallet","setGeneratedWallet","wal","goDownload","paperRenderer","goVerify","goExecute","loginAndGoHome","STEPS","DOWNLOAD_KEYS","RESET_KEYS","goSigil","goDownloadKeys","goResetKeys","isMasterTicket","isSenate","goSetProxy","goTransfer","renderProxyAction","_urbitWallet","doDownload","goBack","_setNewWallet","properProxyType","txArgs","unset","useSetProxy","buildAddressValidator","proxyAddress","proxyFromDetails","isProxySet","useTransfer","needLockupWarning","az","humanizeName","onAccept","onDecline","page","setPage","start","pointsCount","maxPage","hasNext","hasPrev","_points","onNext","onPrev","Resident","isRequest","CopiableAddressWrap","BITCOIN_MAINNET_INFO","messagePrefix","bech32","bip32","private","pubKeyHash","scriptHash","wif","BITCOIN_TESTNET_INFO","ROUTES","useActivateFlowState","replaceState","isOther","setisOther","goToActivate","command","flowDescription","versionLabel","isEclipticOwner","useIsEclipticOwner","rejectedPoints","setRejectedPoints","addRejectedPoint","useRejectedIncomingPointTransfers","maybeOutgoingPoints","has","every","outgoing","outgoingPoints","allPoints","displayEmptyState","starReleasing","goCreateGalaxy","goStarRelease","newGithubIssueUrl","user","repo","hideBack","NavHeader","canBitcoin","hasInvites","loadedInvites","goSenate","goUrbitOS","goBitcoin","goUrbitID","goResidents","goPartiesSetPoolSize","goIssuePoint","inviteButton","senateButton","_requestCount","setGalaxy","createGalaxy","useCreateGalaxy","getOwner","galaxyName","currentOwner","availablePointsPromise","useConstant","getUnspawnedChildren","Set","candidates","getCandidate","spawnedPoint","setSpawnedPoint","useIssueChild","validateChild","goDocuments","goUpgrades","accept","castDocumentVote","useCastDocumentVote","majorities","setMajorities","proposals","setProposals","polls","setPolls","setLoading","votingOn","setVotingOn","now","round","getTime","getDocumentProposals","getDocumentMajorities","getDocumentPoll","poll","endTime","duration","hasVotedOnDocumentPoll","hasVoted","open","closed","doVote","didVote","majorityList","class","openList","castUpgradeVote","useCastUpgradeVote","getUpgradeProposals","getUpgradePoll","hasVotedOnUpgradePoll","hasKeysSet","encryptionKey","authenticationKey","poolOwner","poolSize","setPoolSize","useSetPoolSize","_address","transaction","useAcceptTransfer","noReset","_acceptedInvites","selectedInvite","_setSelectedInvite","setSelectedInvite","old","onBack","transferCommitment","transferBatch","TRANSFER_LOCKUP","useAcceptLockup","getApproved","memoize","lok","homeAction","lastCrumb","_setCurrentTab","isRequests","_onAccept","adoptee","denied","_onDecline","adopt","useAdopt","goXpub","goSignTransaction","zpub","bitcoinMainnet","xpub","bitcoinTestnet","setSignedTx","psbt","setPsbt","zprv","xprv","vprv","unsignedTransaction","buildPsbtValidator","newPsbt","bitcoin","fromBase64","isTestnet","inputs","bip32Derivation","path","derivationPrefix","btcWallet","fromBase58","hex","prv","derivePath","signInput","fromPrivateKey","finalizeAllInputs","extractTransaction","toHex","PsbtInput","txOutputs","WithErrorBoundary","render","Component","buildTitle","buildBody","stack","GlobalErrorBoundary","labels","role","aria-label","reload","INITIAL_NETWORK_TYPE","isMainnet","SHOULD_STUB_LOCAL","REACT_APP_STUB_LOCAL","IS_STUBBED","INITIAL_WALLET","REACT_APP_DEV_MNEMONIC","REACT_APP_HD_PATH","INITIAL_MNEMONIC","INITIAL_POINT_CURSOR","Bridge","hasImpliedTicket","isActivateUrl","pathname","useInitialRoutes","initialNetworkType","initialWallet","initialMnemonic","initialPointCursor","ReactDOM","getElementById","FooterTeleporter","createTeleporter","Source","Target","MESSAGE","getMetamaskAuthToken","request","personal","sign","getLedgerAuthToken","ledgerSignMessage","getTrezorAuthToken","trezorSignMessage","getWalletConnectAuthToken","signPersonalMessage","getDefaultAuthToken","msg","hashed","crypto","sha256","Buffer","ecdsaSign","ethSignature","signMessage","args","LEDGER_LEGACY_PATH","LEDGER_LIVE_PATH","chopHdPrefix","addHdPrefix","ledgerSignTransaction","hdPath","Transport","transport","Eth","serializedTx","sig","SEED_LENGTH_BYTES","SEED_ENTROPY_BITS","getTicketBitSize","GALAXY_ENTROPY_BITS","STAR_ENTROPY_BITS","PLANET_ENTROPY_BITS","makeTicket","getRandomValues","gen","more","desired","flatMap","entropy","patq","hex2patq","makeDeterministicTicket","pointSalt","shas","seedSize","password","revisions","generateOwnershipWallet","ZOD","generateTemporaryDeterministicWallet","Noun","_mug","_mug_fnv","has_w","imul","_mug_out","_mug_both","lef_w","rit_w","out_w","loob","pretty","calculateMug","mugged","bump","unify","out","fragCache","0","1","fragmenter","shortCode","mas","cap","valueOf","shortBi","toByteArray","cordToString","chars","String","fromCharCode","tap","isTa","isTas","ida","heda","tala","octs","testBit","l","addTop","mask","and","bot","dwim","cel","fromMote","fromString","radix","TREZOR_PATH","trezorSignTransaction","trezorFormattedTxn","common","TrezorConnect","ethereumSignTransaction","ethereumSignMessage","AspectRatio","aspectRatio","percent","validPatp","shax","jssha256","array","hex2buf","reverse","salt","isBuffer","byteLength","ring","createRing","halfway","shaf","hex2patp","CHECK_BLOCK_EVERY_MS","MIN_GALAXY","SPAWN","ESCAPE","CANCEL_ESCAPE","REJECT","DETACH","ETH_ZERO_ADDR_SHORT","SHARDS","NONCUSTODIAL_WALLETS","isPromise","buildValidator","validators","validator","errorsOrPromises","iter","validateNotEmpty","validatePatq","validateShard","validateMnemonic","mustBe","validateOneOf","validateHdPath","validateMaximumPatpByteLength","validatePoint","buildSelectValidator","validateHexPrefix","validateHexString","validateHexLength","buildPrivateKeyValidator","validateLength","validateNotNullAddress","validateEthereumAddress","validateGreaterThan","validateLessThan","validateEmail","validatePsbt","fieldValidators","formValidator","fieldLevelValidators","fieldLevelValidator","memo","errorsOrPromise","runFormValidator","CONTRACT_ADDRESSES","DEV","NetworkContext","setNetworkType","metamask","setMetamask","setWeb3","setContracts","chainIdToNetworkType","initWeb3","provider","contractAddresses","_provider","Web3","newLinearStarRelease","newConditionalStarRelease","newDelegatedSending","protocol","endpoint","hostname","providers","WebsocketProvider","HttpProvider","_useNetwork","PointCursorContext","_usePointCursor","formatDots","getFullYear","getMonth","getDate","toLocaleTimeString","formatTime","metamaskSignTransaction","FakeSignResult","metamaskSendTransaction","metamaskFormattedTxn","transactionHash","useMedia","queries","reverseValues","mediaQueryLists","q","matchMedia","getValue","mql","matches","addListener","removeListener","BREAKPOINTS","MediaQueryContext","LocalRouterContext","LocalRouterProvider","WalletContext","DEFAULT_WALLET_TYPE","_setWalletType","_setWallet","_setUrbitWallet","setNetworkSeed","setNetworkRevision","INVALID_WALLET_TYPE","_useWallet","OutButton","ValuesHandler","useForm","validationPaused","isValidationPaused","ValidationPauser","pauseValidation","noop","_onSubmit","mutators","arrayMutators","formProps","stripHexPrefix","isAddress","toChecksumAddress","toLowerCase","keccak256","char","addr0","addr1","pubToAddress","selectColorway","InputSigil","lastValidPatp","setLastValidPatp","PLACEHOLDER_HD_PATH","formatPat","buildFormatter","downcase","autoCapitalize","autoCorrect","autoComplete","ensureHexPrefix","PrivateKeyInput","format","MiniBackButton","isExit","isMobile","shouldInset","insetPadding","pt7","pt5","goLogout","showBackButton","Header","logout","mw1","Full","useFormState","submitErrors","validationError","showValidationError","showSubmitError","emailRegExp","isHexString","isHexPrefixed","bip39","isHdPath","test","patpStringLength","validateNotAny","validateUnique","ourShip","sein","base64","sec","PATH_OPTIONS","ACCOUNT_OPTIONS","times","useCustomPath","derivationpath","account","getAddress","info","chainCode","pub","publicKeyConvert","hd","fromPublicKey","isHTTPS","pr1","pl1","walletConnectSignTransaction","wcFormattedTx","toJSON","walletConnectSendTransaction","fromSerializedTx","manifest","appUrl","getPublicKey","hasValidationErrors","hasSubmitErrors","onlyWarningInSubmitErrors","canSubmit","showWarningSubmitText","list","two","three","rub","z","cue_in","u","mat","_jam_in_flat","_jam_in","h_a","t_a","_jam_in_pair","u_c","_jam_in_ptr","cue","jam","HistoryContext","buildDate","t","delayed","delay","savedCallback","setInterval","clearInterval","useInterval","retries","factor","minTimeout","randomize","txParams","eip155Params","defaultEip155Networks","needEip155Params","signingParams","txConfig","freeze","Chain","Ropsten","Mainnet","Common","hardfork","Hardfork","MuirGlacier","fromTxData","doubtNonceError","eventEmitter","err","isKnownError","isNonceError","utils","wrappedErr","getTransactionReceipt","stxs","promise","fromWei","toWei","compose","fs","pF","nF","strSplice","REACT_APP_ROPSTEN","REACT_APP_MAINNET","REACT_APP_BRIDGE_VERSION","version","bnsec","cmpn","andln","shrn","b64","serial","pad","deriveNetworkSeedFromMnemonic","deriveNetworkSeedFromManagementMnemonic","deriveNetworkSeedFromAuthToken","managementSeed","sl","rowFrom","secp256k1","skipMnemonicCheck","sd","fromSeed","NavHeaderTeleporter","HEX_PREFIX","formatters","dashAt","TICKET_MAX_BYTE_LEN","dashIndex","sep","MISSING_TXN","MISSING_KEYSTORE","MISSING_MNEMONIC","INVALID_ROUTE","INVALID_NETWORK_TYPE"],"mappings":"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","file":"static/js/main.c02dd66f.chunk.js","sourcesContent":["import React from 'react';\nimport cn from 'classnames';\n\nexport const IndigoApp = function({ debug = false, ...rest }) {\n  return (\n    <main\n      className={cn('minh-100', { debug })}\n      style={{ position: 'relative' }}\n      {...rest}\n    />\n  );\n};\n","import React from 'react';\nimport cn from 'classnames';\n\nconst Grid = React.forwardRef(function Grid(\n  { as: As = 'div', gap = 0, align, justify, className, ...rest },\n  ref\n) {\n  return (\n    <As\n      ref={ref}\n      className={cn(\n        'grid12',\n        gap && `gap${gap}`,\n        {\n          [`justify-${justify}`]: justify,\n          [`align-${align}`]: align,\n        },\n        className\n      )}\n      {...rest}\n    />\n  );\n});\n\nGrid.Item = React.forwardRef(function GridItem(\n  {\n    as: As = 'div',\n    full = false,\n    half = 0,\n    third = 0,\n    fourth = 0,\n    rows = [],\n    cols = [],\n    justifySelf,\n    alignSelf,\n    className,\n    ...rest\n  },\n  ref\n) {\n  return (\n    <As\n      ref={ref}\n      className={cn(\n        {\n          full,\n          [`half-${half}`]: half,\n          [`third-${third}`]: third,\n          [`fourth-${fourth}`]: fourth,\n        },\n        {\n          [`r${rows[0]}-${rows[1]}`]: rows.length === 2,\n          [`c${cols[0]}-${cols[1]}`]: cols.length === 2,\n        },\n        {\n          [`justify-self-${justifySelf}`]: justifySelf,\n          [`align-self-${alignSelf}`]: alignSelf,\n        },\n        className\n      )}\n      {...rest}\n    />\n  );\n});\n\nGrid.Divider = function GridDivider({ color = 'gray2', className, ...rest }) {\n  return <div className={cn('full', `bt1 b-${color}`, className)} {...rest} />;\n};\n\nexport default Grid;\n","import React from 'react';\nimport cn from 'classnames';\n\nconst Flex = React.forwardRef(function Flex(\n  {\n    as: As = 'div',\n    row = false,\n    wrap = false,\n    col = false,\n    align,\n    justify,\n    className,\n    ...rest\n  },\n  ref\n) {\n  if (row && col) {\n    throw new Error('Only one of row or col must be true, not both.');\n  }\n  return (\n    <As\n      ref={ref}\n      className={cn(\n        'flex',\n        {\n          'flex-row': row,\n          'flex-col': col,\n          'flex-wrap': wrap,\n        },\n        {\n          [`align-${align}`]: align,\n          [`justify-${justify}`]: justify,\n        },\n        className\n      )}\n      {...rest}\n    />\n  );\n});\n\n// flex can be boolean {true} or integer flex\nFlex.Item = React.forwardRef(function FlexItem(\n  { as: As = 'div', flex, className, ...rest },\n  ref\n) {\n  if (flex === true) {\n    flex = 1;\n  }\n\n  return (\n    <As\n      ref={ref}\n      className={cn(\n        {\n          [`flex${flex}`]: flex,\n        },\n        className\n      )}\n      {...rest}\n    />\n  );\n});\n\nexport default Flex;\n","import React from 'react';\nimport cn from 'classnames';\n\nconst typeWith = (DefaultComponent, defaultClassName) =>\n  function({ as: As = DefaultComponent, className, ...rest }) {\n    return <As className={cn(defaultClassName, className)} {...rest} />;\n  };\n\nexport const H1 = typeWith('h1');\nexport const H2 = typeWith('h2');\nexport const H3 = typeWith('h3');\nexport const H4 = typeWith('h4');\nexport const H5 = typeWith('h5');\nexport const H6 = typeWith('h6');\nexport const Caption = typeWith('caption');\nexport const P = typeWith('p');\nexport const B = typeWith('b', 'fw-bold');\n\nexport const Breadcrumb = typeWith('span', 'f6');\nexport const Text = typeWith('span');\nexport const HelpText = typeWith('span', 'f6 gray4');\nexport const ErrorText = typeWith('span', 'f6 red3');\n","import React from 'react';\nimport cn from 'classnames';\nimport { useField } from 'react-final-form';\nimport Flex from './Flex';\nimport { ErrorText } from './Typography';\n\nexport default function Input({\n  // visuals\n  type,\n  name,\n  label,\n  className,\n  accessory,\n  labelAccessory,\n  disabled = false,\n  mono = false,\n  obscure,\n\n  // callbacks\n  onEnter,\n\n  // state\n  config,\n\n  // extra\n  ...rest\n}) {\n  const {\n    input,\n    meta: {\n      active,\n      error,\n      submitError,\n      dirtySinceLastSubmit,\n      submitting,\n      submitSucceeded,\n      touched,\n      valid,\n    },\n  } = useField(name, config);\n\n  disabled = disabled || submitting || submitSucceeded;\n\n  // choose the base dom component\n  const BaseComponent = type === 'textarea' ? 'textarea' : 'input';\n\n  // notify parent of enter keypress iff not disabled and passing\n  // TODO: integrate this into react-final-form submission\n  // const onKeyPress = useCallback(\n  //   e => !disabled && valid && e.key === 'Enter' && onEnter && onEnter(),\n  //   [disabled, valid] // eslint-disable-line react-hooks/exhaustive-deps\n  // );\n\n  const showError = !!error;\n  const showSubmitError = !!submitError && !dirtySinceLastSubmit;\n  const indicateError = touched && !active && (showError || showSubmitError);\n\n  return (\n    <Flex\n      col\n      className={cn(className, 'mb1')}\n      style={{\n        ...(disabled && {\n          pointerEvents: 'none',\n          cursor: 'not-allowed',\n        }),\n      }}>\n      <Flex.Item\n        as={Flex}\n        justify=\"between\"\n        align=\"center\"\n        className={cn('f6 lh-tall', {\n          black: !disabled,\n          gray4: disabled,\n        })}>\n        <Flex.Item as=\"label\" justify=\"center\" htmlFor={name}>\n          {label}\n        </Flex.Item>\n        {labelAccessory && <Flex.Item>{labelAccessory}</Flex.Item>}\n      </Flex.Item>\n      <Flex.Item as={Flex} row className=\"rel\">\n        <Flex.Item\n          flex\n          as={BaseComponent}\n          {...rest}\n          // NOTE: 1.15 from input line-height, 24px = 12px * 2 (from p3 styling)\n          style={type === 'textarea' ? { minHeight: 'calc(1.5rem * 3)' } : {}}\n          className={cn(\n            'b b1 p3 outline-none bs-none',\n            { mono },\n            {\n              'bg-white': !disabled,\n              'bg-gray1': disabled,\n            },\n            {\n              gray4: !(active || touched),\n              black: active || touched,\n            },\n            {\n              'b-green3': valid,\n              'b-black': !valid && active,\n              'b-yellow3': !valid && !active && touched,\n              'b-gray2': !valid && !active && !touched,\n            }\n          )}\n          id={name}\n          name={name}\n          {...input}\n          type={type === 'textarea' ? undefined : type}\n        />\n        {accessory && (\n          <div\n            className=\"abs\"\n            style={{\n              top: 0,\n              right: 0,\n              height: '100%',\n              width: 'calc(1.5em + 24px)',\n              overflow: 'hidden',\n            }}>\n            {accessory}\n          </div>\n        )}\n      </Flex.Item>\n\n      {indicateError && (\n        <Flex.Item as={ErrorText} className=\"mv1\">\n          {error || submitError}\n        </Flex.Item>\n      )}\n    </Flex>\n  );\n}\n","import React from 'react';\n\nimport Flex from './Flex';\n\nconst PENDING_ACCESSORY = '⋯';\nconst SUCCESS_ACCESSORY = '✓';\nconst FAILURE_ACCESSORY = '!';\n\nfunction AccessoryIcon({ ...props }) {\n  return (\n    <Flex\n      justify=\"center\"\n      align=\"center\"\n      style={{ height: '100%', width: '100%' }}\n      {...props}\n    />\n  );\n}\n\nAccessoryIcon.Pending = () => (\n  <AccessoryIcon>{PENDING_ACCESSORY}</AccessoryIcon>\n);\n\nAccessoryIcon.Success = () => (\n  <AccessoryIcon>{SUCCESS_ACCESSORY}</AccessoryIcon>\n);\n\nAccessoryIcon.Failure = () => (\n  <AccessoryIcon>{FAILURE_ACCESSORY}</AccessoryIcon>\n);\n\nexport default AccessoryIcon;\n","import React, { useCallback, useRef, useState } from 'react';\nimport cn from 'classnames';\nimport { useField } from 'react-final-form';\nimport useOnClickOutside from 'indigo-react/lib/useOnClickOutside';\n\nimport Flex from './Flex';\nimport { ErrorText } from './Typography';\nimport AccessoryIcon from './AccessoryIcon';\n\n// NOTE: if we really care about accessibility, we should pull in a dependency\nexport default function SelectInput({\n  name,\n  label,\n  placeholder,\n  className,\n  mono = false,\n  options = [],\n  disabled = false,\n  warning,\n}) {\n  const {\n    input,\n    meta: { active, error, submitting, submitSucceeded, touched, valid },\n  } = useField(name, {\n    type: 'select',\n  });\n\n  disabled = disabled || submitting || submitSucceeded;\n\n  const [isOpen, setIsOpen] = useState(false);\n  const ref = useRef();\n\n  // close select on outside clicks\n  useOnClickOutside(\n    ref,\n    useCallback(() => setIsOpen(false), [setIsOpen])\n  );\n\n  const toggleOpen = useCallback(() => {\n    input.onFocus();\n    setIsOpen(isOpen => !isOpen);\n  }, [input]);\n\n  const onChange = value => {\n    // construct a pseudo event that sets the value correctly\n    input.onChange({ target: { value } });\n    input.onBlur();\n    setIsOpen(false);\n  };\n\n  const text = options.find(o => o.value === input.value).text;\n\n  return (\n    <Flex\n      ref={ref}\n      className={cn(className, 'mb1 us-none')}\n      col\n      style={{\n        ...(disabled && {\n          pointerEvents: 'none',\n          cursor: 'not-allowed',\n        }),\n      }}>\n      <Flex.Item as=\"label\" className=\"f6 lh-tall\" htmlFor={name}>\n        {label}\n      </Flex.Item>\n      <Flex.Item as={Flex} row className=\"rel pointer\" onClick={toggleOpen}>\n        <Flex.Item\n          flex\n          className={cn(\n            'b b1 p3 outline-none',\n            { mono },\n            {\n              'bg-white': !disabled,\n              'bg-gray1': disabled,\n            },\n            {\n              gray4: isOpen,\n              black: !isOpen,\n            },\n            {\n              'b-green3': valid,\n              'b-black': !valid && active,\n              'b-yellow3': !valid && !active && touched && error,\n              'b-gray2': !valid && !active && !touched && !error,\n            }\n          )}\n          id={name}\n          name={name}>\n          {isOpen ? placeholder : text}\n        </Flex.Item>\n        <div\n          className=\"abs\"\n          style={{\n            top: 0,\n            right: 0,\n            height: '100%',\n            width: '44px',\n            overflow: 'hidden',\n          }}>\n          <AccessoryIcon className=\"gray4\">{isOpen ? '▲' : '▼'}</AccessoryIcon>\n        </div>\n        {isOpen && (\n          <Flex\n            col\n            className=\"abs bg-white b-black b1 z10\"\n            style={{\n              top: 'calc(100% + 4px)',\n              left: 0,\n              right: 0,\n              overflow: 'auto',\n              maxHeight: '30vh',\n            }}>\n            {options.map(option => (\n              <Flex.Item\n                key={option.value}\n                className=\"pv2 ph3 hover-bg-grey3\"\n                onClick={e => {\n                  e.stopPropagation();\n                  onChange(option.value);\n                }}>\n                {option.text}\n              </Flex.Item>\n            ))}\n          </Flex>\n        )}\n      </Flex.Item>\n\n      {warning && (\n        <Flex.Item as={ErrorText} className=\"mv1\">\n          {warning}\n        </Flex.Item>\n      )}\n\n      {touched && !active && error && (\n        <Flex.Item as={ErrorText} className=\"mv1\">\n          {error}\n        </Flex.Item>\n      )}\n    </Flex>\n  );\n}\n","import { useEffect } from 'react';\n\n// via https:// usehooks.com/useOnClickOutside/\nexport default function useOnClickOutside(ref, handler) {\n  useEffect(() => {\n    const listener = event => {\n      // Do nothing if clicking ref's element or descendent elements\n      if (!ref.current || ref.current.contains(event.target)) {\n        return;\n      }\n\n      handler(event);\n    };\n\n    document.addEventListener('mousedown', listener);\n    document.addEventListener('touchstart', listener);\n\n    return () => {\n      document.removeEventListener('mousedown', listener);\n      document.removeEventListener('touchstart', listener);\n    };\n  }, [ref, handler]);\n}\n","import React from 'react';\nimport cn from 'classnames';\n\nimport Flex from './Flex';\nimport { useField } from 'react-final-form';\n\nexport default function CheckboxInput({\n  // visuals\n  name,\n  label,\n  className,\n  style,\n  inline = false,\n  white = false,\n\n  disabled,\n}) {\n  const {\n    input,\n    meta: { submitting, submitSucceeded },\n  } = useField(name, { type: 'checkbox' });\n\n  disabled = disabled || submitting || submitSucceeded;\n\n  return (\n    <Flex\n      row\n      align=\"center\"\n      className={cn(className, {\n        mv2: !inline,\n        black: !disabled,\n        gray4: disabled,\n      })}\n      style={{\n        ...(disabled && {\n          pointerEvents: 'none',\n          cursor: 'not-allowed',\n        }),\n      }}>\n      {/* we totally hide the checkbox itself */}\n      <Flex.Item as=\"input\" className=\"super-hidden\" id={name} {...input} />\n      {/* and then display a prettier one in its stead */}\n      <Flex.Item\n        flex\n        as=\"label\"\n        className={cn(\n          { mr3: !inline },\n          'f6 lh-tall us-none pointer flex-row align-center'\n        )}\n        htmlFor={name}>\n        <Flex\n          justify=\"center\"\n          align=\"center\"\n          className={cn('b1 p1', {\n            mr3: !inline,\n            mr1: inline,\n            'bg-gray1': disabled,\n            'bg-black white b-black': !disabled && (input.checked || white),\n            'bg-white black b-black': !disabled && !input.checked,\n          })}\n          style={{\n            height: '14px',\n            width: '14px',\n            ...style,\n          }}>\n          {input.checked && '✓'}\n        </Flex>\n        {label}\n      </Flex.Item>\n    </Flex>\n  );\n}\n","import React from 'react';\nimport cn from 'classnames';\n\nexport default function LinkButton({\n  as: As = 'a',\n  disabled = false,\n  className,\n  onClick,\n  children,\n  ...rest\n}) {\n  return (\n    <As\n      onClick={!disabled && onClick ? onClick : undefined}\n      style={{\n        ...(disabled && {\n          pointerEvents: 'none',\n          cursor: 'not-allowed',\n        }),\n      }}\n      className={cn(\n        'us-none pointer underline',\n        {\n          // NOTE: inherit styling from parent otherwise\n          gray4: disabled,\n        },\n        className\n      )}\n      target=\"_blank\"\n      rel=\"noopener noreferrer\"\n      {...rest}>\n      {children}\n    </As>\n  );\n}\n","import React from 'react';\nimport cn from 'classnames';\n\nimport Flex from './Flex';\nimport LinkButton from './LinkButton';\nimport { useField } from 'react-final-form';\n\nexport default function ToggleInput({\n  // visuals\n  name,\n  label,\n  inverseLabel,\n  inverseColor = 'black',\n  small = false,\n  className,\n\n  //\n  disabled = false,\n\n  ...rest\n}) {\n  const {\n    input,\n    meta: { submitting, submitSucceeded },\n  } = useField(name, { type: 'checkbox' });\n\n  disabled = disabled || submitting || submitSucceeded;\n\n  return (\n    <Flex\n      className={className}\n      row\n      align=\"center\"\n      style={{\n        ...(disabled && {\n          pointerEvents: 'none',\n          cursor: 'not-allowed',\n        }),\n      }}>\n      {/* we totally hide the checkbox itself */}\n      <Flex.Item\n        as=\"input\"\n        {...rest}\n        className={cn('super-hidden')}\n        id={name}\n        name={name}\n        {...input}\n      />\n      {/* and then display a prettier one in its stead */}\n      <Flex.Item\n        flex\n        as=\"label\"\n        className={cn('f6 pv2 lh-tall us-none flex-row align-center', {\n          pointer: !disabled,\n        })}\n        htmlFor={name}>\n        <LinkButton\n          disabled={disabled}\n          className={cn({\n            f5: !small,\n            f6: small,\n            black: !input.checked,\n            [inverseColor]: input.checked,\n          })}>\n          {input.checked ? inverseLabel : label}\n        </LinkButton>\n      </Flex.Item>\n    </Flex>\n  );\n}\n","import React from 'react';\nimport cn from 'classnames';\n\nimport Grid from './Grid';\nimport Flex from './Flex';\nimport { HelpText } from './Typography';\n\nexport default function Button({\n  as: As = 'span',\n  solid = false,\n  success = false,\n  disabled = false,\n  disabledDetail,\n  detail,\n  className,\n  detailClassName,\n  accessory = '→',\n  onClick,\n  background,\n  type,\n  children,\n  center = false,\n  ...rest\n}) {\n  const handleKeyPress = e => {\n    if (e.key === 'Enter' && !disabled) {\n      onClick();\n    }\n  };\n  return (\n    <Grid\n      as={As}\n      gap={1}\n      tabIndex={!disabled ? 0 : undefined}\n      onKeyPress={handleKeyPress}\n      className={cn(\n        'rel pointer pv4 truncate flex-row justify-between us-none',\n        {\n          p4: solid,\n        },\n        {\n          'bg-green3': success && !disabled,\n          'bg-green1': success && disabled,\n          'bg-black': !success && solid && !disabled,\n          'bg-gray3': !success && solid && disabled,\n          'bg-transparent': !success && !solid,\n        },\n        {\n          white: solid,\n          black: !solid && !disabled,\n          gray4: !solid && disabled,\n        },\n        className\n      )}\n      style={{\n        ...(disabled && {\n          pointerEvents: 'none',\n          cursor: 'not-allowed',\n        }),\n      }}\n      onClick={!disabled && onClick ? onClick : undefined}\n      {...rest}>\n      {background}\n      <Grid.Item\n        full\n        as={Flex}\n        justify=\"between\"\n        className={cn('z2', { 'flex-center': center })}>\n        <span>{children}</span>\n        {type && <button type={type} style={{ display: 'none' }}></button>}\n        {!center && <div className={cn('pl4')}>{accessory}</div>}\n      </Grid.Item>\n      {detail && (\n        <Grid.Item full as={HelpText} className={cn('z2', detailClassName)}>\n          {detail}\n        </Grid.Item>\n      )}\n      {disabled && disabledDetail && (\n        <Grid.Item full className=\"f6 black mt1 z2\">\n          {disabledDetail}\n        </Grid.Item>\n      )}\n    </Grid>\n  );\n}\n","import React from 'react';\nimport cn from 'classnames';\n\nimport Flex from './Flex';\n\nexport default function IconButton({\n  children,\n  className,\n  onClick,\n  disabled = false,\n  secondary = false,\n  solid = false,\n  hpadding = true,\n  vpadding = true,\n  ...rest\n}) {\n  return (\n    <Flex\n      as=\"a\"\n      align=\"center\"\n      justify=\"center\"\n      className={cn(\n        'pointer',\n        {\n          ph2: hpadding,\n          pv2: vpadding,\n        },\n        {\n          'bg-black': solid && !secondary && !disabled,\n          'bg-gray3': (solid && disabled) || (solid && secondary),\n          'bg-gray2': !solid && secondary && disabled,\n          'bg-transparent': !solid,\n        },\n        {\n          white: solid,\n          black: !solid && !disabled,\n          gray4: !solid && disabled,\n        },\n        className\n      )}\n      style={{\n        width: '1rem',\n        height: '1rem',\n        fontSize: '1rem',\n        fontWeight: 'bold',\n        ...(disabled && {\n          pointerEvents: 'none',\n          cursor: 'not-allowed',\n        }),\n      }}\n      onClick={onClick ? () => !disabled && onClick() : undefined}\n      {...rest}>\n      {children}\n    </Flex>\n  );\n}\n","import { useCallback, useMemo, useState, useRef, useEffect } from 'react';\nimport { last, includes as _includes, findIndex, get } from 'lodash';\n\nconst NULL_DATA = {};\n\n/**\n * @param names map of string to view key, used for consumer references\n * @param views map of view keys to react component views\n * @param initialRoutes initial set of routes following the { key, data } format\n */\nexport default function useRouter({\n  names = {},\n  views = {},\n  initialRoutes = [],\n}) {\n  const [routes, setRoutes] = useState(initialRoutes);\n\n  const oldPopState = useRef();\n\n  const size = routes.length;\n  const push = useCallback(\n    (key, data) => {\n      if (!views[key]) {\n        throw new Error(\n          `Invalid Route: ${key}. Possible Routes: ${Object.keys(views).join(\n            ', '\n          )}`\n        );\n      }\n      setRoutes(routes => [...routes, { key, data }]);\n    },\n    [setRoutes, views]\n  );\n  const popAndPush = useCallback(\n    (key, data = {}) => {\n      if (!views[key]) {\n        throw new Error(\n          `Invalid Route: ${key}. Possible Routes: ${Object.keys(views).join(\n            ', '\n          )}`\n        );\n      }\n\n      setRoutes(routes => [\n        ...routes.slice(0, routes.length - 1),\n        { key, data },\n      ]);\n    },\n    [setRoutes, views]\n  );\n  const pop = useCallback(\n    (count = 1) => {\n      if (size <= 1) {\n        // if we are at the root, pass this event to our parent\n        if (oldPopState.current) {\n          oldPopState.current();\n        }\n        return;\n      }\n\n      // on pop, tell the browser of a new state to avoid giving the user\n      // the ability to go forward\n      // TODO: allow the user to go forward by storing our data in history\n      // and using the url for other state\n      // (or just importing an actually good router lib)\n      window.history.pushState(null, null, null);\n\n      // pop as expected\n      return setRoutes(routes => [...routes.slice(0, routes.length - count)]);\n    },\n    [size, setRoutes, oldPopState]\n  );\n  const popTo = useCallback(\n    name => {\n      const index = findIndex(routes, route => route.key === name);\n      return pop(routes.length - 1 - index);\n    },\n    [pop, routes]\n  );\n  const peek = useCallback(() => last(routes), [routes]);\n  const replaceWith = useCallback(routes => setRoutes(() => routes), [\n    setRoutes,\n  ]);\n  const reset = useCallback(() => setRoutes(initialRoutes), [\n    setRoutes,\n    initialRoutes,\n  ]);\n  const includes = useCallback(\n    key =>\n      _includes(\n        routes.map(r => r.key),\n        key\n      ),\n    [routes]\n  );\n  const data = useMemo(() => {\n    return get(last(routes), 'data', NULL_DATA);\n  }, [routes]);\n  const Route = useMemo(() => views[peek().key], [views, peek]);\n\n  // Scroll to top of page with each route transition\n  useEffect(() => {\n    window.scrollTo(0, 0);\n  }, [routes]);\n\n  useEffect(() => {\n    // on router mount, register new state with browser\n    window.history.pushState(null, null, null);\n  }, []);\n\n  // capture browser pop in primary router\n  useEffect(() => {\n    // store the previous onpopstate handler\n    oldPopState.current = window.onpopstate;\n\n    // construct new onpopstate handler\n    window.onpopstate = e => {\n      e && e.stopImmediatePropagation();\n      pop();\n    };\n\n    return () => {\n      // reset the onpopstate to the previous version\n      window.onpopstate = oldPopState.current;\n    };\n  }, [size, pop, oldPopState]);\n\n  return {\n    Route,\n    names,\n    routes,\n    push,\n    popAndPush,\n    pop,\n    popTo,\n    replaceWith,\n    reset,\n    peek,\n    size,\n    includes,\n    data,\n  };\n}\n","export const WARNING = 'warn';\n\n// if the object only has the WARNING key\nexport const onlyHasWarning = obj =>\n  !!obj && Object.keys(obj).length === 1 && !!obj[WARNING];\n","import { useMediaQuery } from './MediaQuery';\n\nexport default function useBreakpoints(values = [null, null, null]) {\n  return values[useMediaQuery()];\n}\n","var noun = require('./noun.js'),\n    Cell = noun.Cell,\n    zero = noun.Atom.yes;\n\nfunction flop(a) {\n\tvar b = zero;\n\n\twhile ( true ) {\n\t\tif ( zero.equals(a) ) {\n\t\t\treturn b;\n\t\t}\n\t\telse if ( !a.deep ) {\n      throw new Error(\"Bail\");\n\t\t}\n\t\telse {\n      b = new Cell(a.head, b);\n      a = a.tail;\n\t\t}\n\t}\n}\n\nfunction forEach(n, f) {\n  while ( true ) {\n    if ( zero.equals(n) ) {\n      return;\n    }\n    else if ( !n.deep ) {\n      throw new Error(\"Bail\");\n    }\n    else {\n      f(n.head);\n      n = n.tail;\n    }\n  }\n}\n\nmodule.exports = {\n  flop: flop,\n  forEach: forEach,\n};\n","var noun = require('./noun.js'),\n    BigInteger = require('jsbn').BigInteger,\n    zero = noun.Atom.yes,\n    one  = noun.Atom.no;\n\n// a is native, returns native\nfunction met(a, b) {\n  var bits = b.number.bitLength(),\n      full = bits >>> a,\n      part = (full << a) !== bits;\n\n  return part ? full + 1 : full;\n}\n\nfunction gth(a, b) {\n  return a.number.compareTo(b.number) > 0;\n}\n\nfunction lth(a, b) {\n  return a.number.compareTo(b.number) < 0;\n}\n\nfunction gte(a, b) {\n  return a.number.compareTo(b.number) >= 0;\n}\n\nfunction lte(a, b) {\n  return a.number.compareTo(b.number) <= 0;\n}\n\nfunction add(a, b) {\n  return new noun.Atom.Atom(a.number.add(b.number));\n}\n\nfunction dec(a) {\n  return sub(a, one);\n}\n\nfunction bex(a) {\n  return new noun.Atom.Atom(BigInteger.ONE.shiftLeft(a.number.intValue()));\n}\n\nfunction sub(a, b) {\n  var r = a.number.subtract(b.number);\n  if ( r.signum < 0 ) {\n    throw new Error(\"subtract underflow\");\n  }\n  else {\n    return new noun.Atom.Atom(r);\n  }\n}\n\nfunction lsh(a, b, c) {\n  var bits = b.number.shiftLeft(a.number.intValue()).intValue();\n  return new noun.Atom.Atom(c.number.shiftLeft(bits));\n}\n\nfunction rsh(a, b, c) {\n  var bits = b.number.shiftLeft(a.number.intValue()).intValue();\n  return new noun.Atom.Atom(c.number.shiftRight(bits));\n}\n\n// to/from little-endian 32-bit word array, as used in vere\n// TODO: efficiency is horrible here, but can be improved using internals\nfunction bytesToWords(bytes) {\n  var len   = bytes.length,\n      trim  = len % 4;\n  var i, b, w;\n\n\tif ( trim > 0 ) {\n    len += (4-trim);\n    for ( i = 0; i < trim; ++i ) {\n      bytes.push(0);\n    }\n\t}\n\n  var size = len >> 2;\n  var words = new Array(size);\n  for ( i = 0, b = 0; i < size; ++i ) {\n    w =  (bytes[b++] << 0)  & 0x000000FF;\n    w ^= (bytes[b++] << 8)  & 0x0000FF00;\n    w ^= (bytes[b++] << 16) & 0x00FF0000;\n    w ^= (bytes[b++] << 24) & 0xFF000000;\n    words[i] = w;\n  }\n  return words;\n};\n\nfunction wordsToBytes(words) {\n  var buf = [];\n  var w, i, b;\n  for ( i = 0, b = 0; i < words.length; ++i ) {\n    w = words[i];\n    buf[b++] = 0xff & (w & 0x000000FF);\n    buf[b++] = 0xff & ((w & 0x0000FF00) >>> 8);\n    buf[b++] = 0xff & ((w & 0x00FF0000) >>> 16);\n    buf[b++] = 0xff & ((w & 0xFF000000) >>> 24);\n  }\n  // or here. one of the 'get rid of extra zeros' functions.\n  while ( buf[--b] === 0 ) {\n    buf.pop();\n  }\n  return buf;\n};\n\nfunction bytesToAtom(bytes) {\n  var byt, parts = [];\n  for ( var i = bytes.length - 1; i >= 0; --i ) {\n    byt = bytes[i] & 0xff;\n    parts.push(byt < 16 ? (\"0\" + byt.toString(16)) : byt.toString(16));\n  }\n  return new noun.Atom.Atom(new BigInteger(parts.join(''), 16));\n}\n\nfunction atomToBytes(atom) {\n  return atom.bytes();\n}\n\nfunction atomToWords(atom) {\n  return bytesToWords(atomToBytes(atom));\n}\n\nfunction wordsToAtom(words) {\n  return bytesToAtom(wordsToBytes(words));\n}\n\nvar malt = wordsToAtom;\n\n// XX: INTERNAL\nfunction slaq(bloq, len) {\n  return new Array(((len << bloq) + 31) >>> 5);\n}\n\n// src is atom, all others native\nfunction chop(met, fum, wid, tou, dst, src) {\n  var buf = atomToWords(src),\n      len = buf.length,\n      i, j, mek, baf, bat, hut, san,\n      wuf, wut, waf, raf, wat, rat, hop;\n\n  if ( met < 5 ) {\n    san = 1 << met;\n    mek = ((1 << san) - 1);\n    baf = fum << met;\n    bat = tou << met;\n\n    for ( i = 0; i < wid; ++i ) {\n      waf = baf >>> 5;\n      raf = baf & 31;\n      wat = bat >>> 5;\n      rat = bat & 31;\n      hop = ((waf >= len) ? 0 : buf[waf]);\n      hop = ((hop >>> raf) & mek);\n      dst[wat] ^= hop << rat;\n      baf += san;\n      bat += san;\n    }\n  }\n  else {\n    hut = met - 5;\n    san = 1 << hut;\n\n    for ( i = 0; i < wid; ++i ) {\n      wuf = (fum + i) << hut;\n      wut = (tou + i) << hut;\n\n      for ( j = 0; j < san; ++j ) {\n        dst[wut + j] ^= ((wuf + j) >= len)\n                      ? 0\n                      : buf[wuf + j];\n      }\n    }\n  }\n}\n\nfunction cut(a, b, c, d) {\n  var ai = a.number.intValue(),\n      bi = b.number.intValue(),\n      ci = c.number.intValue();\n\n  var len = met(ai, d);\n  if ( zero.equals(c) || bi >= len ) {\n    return zero;\n  }\n  if ( bi + ci > len ) {\n    ci = len - b;\n  }\n  if ( 0 === bi && ci === len ) {\n    return d;\n  }\n  else {\n    var sal = slaq(ai, ci);\n    chop(ai, bi, ci, 0, sal, d);\n    return malt(sal);\n  }\n}\n\nvar maxCat = noun.Atom.fromInt(0xffffffff);\nvar catBits = noun.Atom.fromInt(32);\n\nfunction end(a, b, c) {\n  if ( gth(a, catBits) ) {\n    throw new Error(\"Fail\");\n  }\n  else if ( gth(b, maxCat) ) {\n    return c;\n  }\n\telse {\n    var ai = a.number.intValue(),\n        bi = b.number.intValue(),\n       len = met(ai, c);\n\n    if ( 0 === bi ) {\n      return zero;\n    }\n    else if ( bi >= len ) {\n      return c;\n    }\n    else {\n      var sal = slaq(ai, bi);\n      chop(ai, 0, bi, 0, sal, c);\n      return malt(sal);\n    }\n\t}\n}\n\nfunction mix(a, b) {\n  return new noun.Atom.Atom(a.number.xor(b.number));\n}\n\nfunction cat(a, b, c) {\n\tif ( gth(a, catBits) ) {\n\t\tthrow new Error(\"Fail\");\n\t}\n\telse {\n\t\tvar ai = a.number.intValue(),\n       lew = met(ai, b),\n       ler = met(ai, c),\n       all = lew + ler;\n\n    if ( 0 === all ) {\n      return zero;\n    }\n    else {\n      var sal = slaq(ai, all);\n      chop(ai, 0, lew, 0, sal, b);\n      chop(ai, 0, ler, lew, sal, c);\n      return malt(sal);\n    }\n\t}\n}\n\nfunction can(a, b) {\n  if ( gth(a, catBits) ) {\n    throw new Error(\"Fail\");\n  }\n  else {\n    var ai = a.number.intValue(),\n      tot = 0,\n      cab = b,\n      pos, i_cab, pi_cab, qi_cab;\n\n    // measure\n    while ( true ) {\n      if ( zero.equals(cab) ) {\n        break;\n      }\n      if ( !cab.deep ) {\n        throw new Error(\"Fail\");\n      }\n      i_cab = cab.head;\n      if ( !i_cab.deep ) {\n        throw new Error(\"Fail\");\n      }\n      pi_cab = i_cab.head;\n      qi_cab = i_cab.tail;\n      if ( gth(pi_cab, maxCat) ) {\n        throw new Error(\"Fail\");\n      }\n      if ( qi_cab.deep ) {\n        throw new Error(\"Fail\");\n      }\n      if ( (tot + pi_cab) < tot ) {\n        throw new Error(\"Fail\");\n      }\n      tot += pi_cab;\n      cab = cab.tail;\n    }\n    if ( 0 === tot ) {\n      return zero;\n    }\n    var sal = slaq(ai, tot);\n\n    // chop the list atoms in\n    cab = b;\n    pos = 0;\n    while ( !zero.equals(cab) ) {\n      i_cab  = cab.head;\n      pi_cab = i_cab.head.number.intValue();\n      qi_cab = i_cab.tail;\n\n      chop(ai, 0, pi_cab, pos, sal, qi_cab);\n      pos += pi_cab;\n      cab = cab.tail;\n    }\n    return malt(sal);\n  }\n}\n\nmodule.exports = {\n  met: met,\n  cut: cut,\n\tadd: add,\n\tsub: sub,\n  dec: dec,\n  gth: gth,\n  lth: lth,\n  gte: gte,\n  lte: lte,\n  bex: bex,\n  lsh: lsh,\n  rsh: rsh,\n  end: end,\n  mix: mix,\n  cat: cat,\n  can: can,\n  bytesToWords: bytesToWords,\n  wordsToBytes: wordsToBytes,\n  bytesToAtom: bytesToAtom,\n  atomToBytes: atomToBytes,\n  atomToWords: atomToWords,\n  wordsToAtom: wordsToAtom,\n};\n","/* keys can be any noun, values aren't constrained */\n\nfunction Slot() {\n}\n\nfunction Node() {\n  Slot.call(this);\n  this.slots = new Array(32);\n}\nNode.prototype = Object.create(Slot.prototype);\nNode.prototype.constructor = Node;\n\nNode.prototype.insert = function(key, val, lef, rem) {\n  var inx;\n  lef -= 5;\n  inx = rem >>> lef;\n  rem &= ((1 << lef) - 1);\n\n  this.slots[inx] = ( undefined === this.slots[inx] )\n                  ? new Single(key, val)\n                  : this.slots[inx].insert(key, val, lef, rem);\n  return this;\n};\n\nNode.prototype.get = function(key, lef, rem) {\n  var inx, sot;\n  lef -= 5;\n  inx = rem >>> lef;\n  rem &= ((1 << lef) - 1);\n  sot = this.slots[inx];\n\n  return ( undefined === sot ) ? undefined : sot.get(key, lef, rem);\n};\n\nfunction Bucket() {\n  this.singles = [];\n}\nBucket.prototype = Object.create(Slot.prototype);\nBucket.prototype.constructor = Bucket;\n\nBucket.prototype.insert = function(key, val, lef, rem) {\n  var s, a = this.singles;\n\n  for ( var i = 0; i < a.length; ++i ) {\n    s = a[i];\n    if ( s.key.equals(key) ) {\n      s.val = val;\n      return this;\n    }\n  }\n  a.push(new Single(key, val));\n  return this;\n};\n\nBucket.prototype.get = function(key, lef, rem) {\n  var s, a = this.singles;\n\n  for ( var i = 0; i < a.length; ++i ) {\n    s = a[i];\n    if ( s.key.equals(key) ) {\n      return s.val;\n    }\n  }\n\n  return undefined;\n};\n\nfunction Single(key, val) {\n  Slot.call(this);\n  this.key = key;\n  this.val = val;\n}\nSingle.prototype = Object.create(Slot.prototype);\nSingle.prototype.constructor = Single;\n\nSingle.prototype.insert = function(key, val, lef, rem) {\n  if ( this.key.equals(key) ) {\n    this.val = val;\n    return this;\n  }\n  else {\n    var n, rom = this.key.mug() & ((1 << lef) - 1);\n\n    if ( lef > 0 ) {\n      n = new Node();\n    }\n    else {\n      n = new Bucket();\n    }\n    n.insert(this.key, this.val, lef, rom);\n    n.insert(key, val, lef, rem);\n    return n;\n  }\n};\n\nSingle.prototype.get = function(key, lef, rem) {\n  if ( this.key.equals(key) ) {\n    return this.val;\n  }\n  else {\n    return undefined;\n  }\n};\n\nfunction NounMap() {\n  this.slots = new Array(64);\n}\n\nNounMap.prototype.insert = function(key, val) {\n  var m    = key.mug();\n  var inx  = m >>> 25;\n  var sot  = this.slots;\n  if ( undefined === sot[inx] ) {\n    sot[inx] = new Single(key, val);\n  }\n  else {\n    var rem  = m & ((1 << 25) - 1);\n    sot[inx] = sot[inx].insert(key, val, 25, rem);\n  }\n};\n\nNounMap.prototype.get = function(key) {\n  var m = key.mug();\n  var inx = m >>> 25;\n  var sot = this.slots[inx];\n  if ( undefined === sot ) {\n    return undefined;\n  }\n  else {\n    var rem  = m & ((1 << 25) - 1);\n    return sot.get(key, 25, rem);\n  }\n};\n\nmodule.exports = {\n  NounMap: NounMap\n};\n","import React from 'react';\n\nimport { useHistory } from 'store/history';\n\nexport default function Router() {\n  const { Route } = useHistory();\n\n  return <Route />;\n}\n","import React, {\n  createContext,\n  forwardRef,\n  useContext,\n  useEffect,\n  useState,\n} from 'react';\n\nexport const ONLINE_STATUS = {\n  ONLINE: Symbol('ONLINE'),\n  OFFLINE: Symbol('OFFLINE'),\n  UNKNOWN: Symbol('UNKNOWN'),\n};\n\nconst getNetworkState = () => {\n  if ('onLine' in navigator) {\n    return navigator.onLine ? ONLINE_STATUS.ONLINE : ONLINE_STATUS.OFFLINE;\n  }\n\n  return ONLINE_STATUS.UNKNOWN;\n};\n\nfunction _useOnline() {\n  const [online, setOnline] = useState(getNetworkState());\n\n  useEffect(() => {\n    function handleOnlineStatus(event) {\n      setOnline(getNetworkState());\n    }\n\n    window.addEventListener('online', handleOnlineStatus);\n    window.addEventListener('offline', handleOnlineStatus);\n\n    return () => {\n      window.removeEventListener('online', handleOnlineStatus);\n      window.removeEventListener('offline', handleOnlineStatus);\n    };\n  }, []);\n\n  return online;\n}\n\nconst OnlineContext = createContext(null);\n\n// provider\nexport function OnlineProvider({ children }) {\n  const online = _useOnline();\n  return (\n    <OnlineContext.Provider value={online}>{children}</OnlineContext.Provider>\n  );\n}\n\n// hook consumer\nexport function useOnline() {\n  return useContext(OnlineContext);\n}\n\n// hoc consumer\nexport const withOnline = Component =>\n  forwardRef((props, ref) => {\n    return (\n      <OnlineContext.Consumer>\n        {online => <Component ref={ref} online={online} {...props} />}\n      </OnlineContext.Consumer>\n    );\n  });\n","import { linearSR, conditionalSR } from 'azimuth-js';\n\nfunction mapRange(amount, cb) {\n  return [...Array(amount).keys()].map(cb);\n}\n\n// Preferentially withdraw from conditional contracts and use linear\n// to mop up the rest\nexport function generateWithdrawTxs(contracts, batchLimits, amount, to) {\n  const [left, ...csrTxs] = generateConditionalWithdrawTxs(\n    contracts,\n    batchLimits,\n    amount,\n    to\n  );\n  const lsrTxs = generateLinearWithdrawTxs(contracts, left, to);\n  return [...csrTxs, ...lsrTxs];\n}\n\n/**\n * Recurse over batchLimits to generate a valid number of withdraw txs.\n * amount may exceed the number of withdraw txs available in the consolidated SR contract.\n *\n * @param {object} contracts - The azimuth contracts object\n * @param {array} batchLimits - An array of the maximum withdraw limit for each batch\n * @param {amount} amount - The number of txs to be generated\n * @param {string} to - The addresss to withdraw to\n * @return {array} An array with the number of transactions missing as the head\n * (i.e. requested amount exceeded available), and the generated transactions\n * as the rest of the list\n */\nfunction generateConditionalWithdrawTxs(\n  contracts,\n  batchLimits,\n  amount,\n  to,\n  offset = 0\n) {\n  // Successfully withdrawn all requested, none missing\n  if (amount <= 0) {\n    return [0];\n  }\n  // Return missing amount in head of list\n  if (batchLimits.length === 0) {\n    return [amount];\n  }\n  const [next, ...rest] = batchLimits;\n  const currentAmount = Math.min(amount, next);\n  return [\n    ...generateConditionalWithdrawTxs(\n      contracts,\n      rest,\n      amount - currentAmount,\n      to,\n      offset + 1\n    ),\n    ...mapRange(currentAmount, () =>\n      conditionalSR.withdrawTo(contracts, offset, to)\n    ),\n  ];\n}\n\nfunction generateLinearWithdrawTxs(contracts, amount, to) {\n  return mapRange(amount, () => linearSR.withdrawTo(contracts, to));\n}\n\nexport async function getLockupKind(contracts, address) {\n  const conditional = await conditionalSR.getCommitment(contracts, address);\n  const linear = await linearSR.getBatch(contracts, address);\n  const haveConditional = conditional.total > 0;\n  const haveLinear = linear.amount > 0;\n  if (haveConditional && !haveLinear) return 'conditional';\n  if (!haveConditional && haveLinear) return 'linear';\n  if (haveConditional && haveLinear) return 'both';\n  return 'none';\n}\n\nexport async function getConditional(contracts, address) {\n  const [commitment, batches, remaining] = await Promise.all([\n    conditionalSR.getCommitment(contracts, address),\n    conditionalSR.getBatches(contracts, address),\n    conditionalSR.getRemainingStars(contracts, address),\n  ]);\n\n  if (batches === [] || commitment.total === '0') {\n    return { total: 0, available: 0, withdrawn: 0, batchLimits: [] };\n  }\n\n  const total = remaining.length;\n  let balance = total;\n\n  //NOTE  we don't strictly need to convert the received number-strings to\n  //      integers, but it helps keep the shenanigans at bay.\n\n  // does not account for forfeiting or withdrawl\n  const limits = (\n    await Promise.all(\n      batches.map((_, idx) =>\n        conditionalSR.getWithdrawLimit(contracts, address, idx)\n      )\n    )\n  ).map(n => parseInt(n));\n\n  const withdrawn = (\n    await conditionalSR.getWithdrawn(contracts, address)\n  ).map(n => parseInt(n));\n\n  const forfeited = await conditionalSR.getForfeited(contracts, address);\n\n  const batchLimits = [];\n\n  for (let i = 0; i < limits.length; i++) {\n    // skip batch if forfeited or no stars left\n    if (forfeited[i] || balance === 0) {\n      batchLimits.push(0);\n      continue;\n    }\n    const availableInBatch = limits[i] - withdrawn[i];\n    if (balance < availableInBatch) {\n      batchLimits.push(balance);\n      balance = 0;\n      continue;\n    }\n    batchLimits.push(availableInBatch);\n    balance = balance - availableInBatch;\n  }\n\n  const withdrawnTotal = withdrawn.reduce((acc, val) => acc + val, 0);\n  const available = batchLimits.reduce((acc, val) => acc + val, 0);\n\n  return {\n    total,\n    available,\n    withdrawn: withdrawnTotal,\n    batchLimits,\n    approvedTransferTo: commitment.approvedTransferTo,\n  };\n}\n\nexport async function getLinear(contracts, address) {\n  const batch = await linearSR.getBatch(contracts, address);\n\n  //NOTE  careful, we get the batch data as strings!\n  const amount = parseInt(batch.amount);\n  const withdrawn = parseInt(batch.withdrawn);\n\n  if (amount === 0) {\n    return { available: 0, withdrawn: 0, total: 0 };\n  }\n\n  //NOTE  be careful, getting the withdraw limit for an address that doesn't\n  //      have a lockup throws an exception!\n  const limit = await linearSR.getWithdrawLimit(contracts, address);\n  const remaining = (await linearSR.getRemainingStars(contracts, address))\n    .length;\n\n  const available = Math.min(limit - withdrawn, remaining);\n  const total = Math.min(amount, remaining);\n\n  return {\n    available,\n    withdrawn,\n    total,\n    approvedTransferTo: batch.approvedTransferTo,\n  };\n}\n","import React, { createContext, useContext } from 'react';\n\nimport useStarReleaseStore from './lib/useStarReleaseStore';\n\nexport const StarReleaseCacheContext = createContext(null);\n\nexport function StarReleaseCacheProvider({ children }) {\n  const cache = useStarReleaseStore();\n\n  return (\n    <StarReleaseCacheContext.Provider value={cache}>\n      {children}\n    </StarReleaseCacheContext.Provider>\n  );\n}\n\n// Hook version\nexport function useStarReleaseCache() {\n  return useContext(StarReleaseCacheContext);\n}\n","import { useCallback } from 'react';\nimport { Just, Nothing } from 'folktale/maybe';\nimport * as azimuth from 'azimuth-js';\nimport { chain } from 'lodash';\n\nimport { useNetwork } from '../network';\nimport useSetState from 'lib/useSetState';\n\n// the default value of a point's invites\nconst EMPTY_INVITES = {\n  availableInvites: Nothing(),\n  sentInvites: Nothing(),\n  acceptedInvites: Nothing(),\n  acceptedPoints: Nothing(),\n  pendingPoints: Nothing(),\n};\n\nexport default function useInvitesStore() {\n  const { contracts } = useNetwork();\n  const [invitesCache, addToInvitesCache] = useSetState({});\n\n  const getInvites = useCallback(\n    point => invitesCache[point] || EMPTY_INVITES,\n    [invitesCache]\n  );\n\n  const syncInvites = useCallback(\n    async point => {\n      const _contracts = contracts.getOrElse(null);\n      if (!_contracts) {\n        return;\n      }\n\n      const [availableInvites, invitedPoints] = await Promise.all([\n        azimuth.delegatedSending.getTotalUsableInvites(_contracts, point),\n        azimuth.delegatedSending.getInvited(_contracts, point),\n      ]);\n\n      const activity = await Promise.all(\n        invitedPoints.map(invitedPoint =>\n          azimuth.azimuth.isActive(_contracts, invitedPoint)\n        )\n      );\n\n      const sentInvites = invitedPoints.length;\n      const acceptedInvites = activity.filter(i => !!i).length;\n\n      const [acceptedPoints, pendingPoints] = chain(invitedPoints)\n        .zipWith(activity, (point, active) => ({\n          point,\n          active: !!active,\n        }))\n        .partition('active')\n        .map(arr => arr.map(x => x.point))\n        .value();\n\n      addToInvitesCache({\n        [point]: {\n          availableInvites: Just(availableInvites),\n          sentInvites: Just(sentInvites),\n          acceptedInvites: Just(acceptedInvites),\n          pendingPoints: Just(pendingPoints),\n          acceptedPoints: Just(acceptedPoints),\n        },\n      });\n    },\n    [contracts, addToInvitesCache]\n  );\n\n  return { getInvites, syncInvites };\n}\n","import { useCallback, useRef, useState } from 'react';\n\nexport default function useSetState(initialState = {}) {\n  const initialStateRef = useRef(initialState);\n  const [state, _setState] = useState(initialState);\n  const setState = useCallback(\n    items => _setState(state => ({ ...state, ...items })),\n    [_setState]\n  );\n\n  const reset = useCallback(() => _setState(initialStateRef.current), [\n    _setState,\n  ]);\n\n  return [state, setState, reset];\n}\n","// need.js: +need but worse\n//\n\nimport { BRIDGE_ERROR } from './error';\n\nconst needBuilder = fn => obj => {\n  if (!obj) {\n    fn();\n  }\n\n  return obj.matchWith({\n    Nothing: fn,\n    Just: p => p.value,\n  });\n};\n\n// simpler function for inline need.value(thing, () => {})\nexport const value = (obj, fn) => needBuilder(fn)(obj);\n\nexport const details = needBuilder(() => {\n  throw new Error(BRIDGE_ERROR.MISSING_POINT_DETAILS);\n});\n\nexport const web3 = needBuilder(() => {\n  throw new Error(BRIDGE_ERROR.MISSING_WEB3);\n});\n\nexport const contracts = needBuilder(() => {\n  throw new Error(BRIDGE_ERROR.MISSING_CONTRACTS);\n});\n\nexport const wallet = needBuilder(() => {\n  throw new Error(BRIDGE_ERROR.MISSING_WALLET);\n});\n\nexport const urbitWallet = needBuilder(() => {\n  throw new Error(BRIDGE_ERROR.MISSING_URBIT_WALLET);\n});\n\nexport const addressFromWallet = obj => wallet(obj).address;\n\nexport const point = needBuilder(() => {\n  throw new Error(BRIDGE_ERROR.MISSING_POINT);\n});\n\nexport const pointCache = needBuilder(() => {\n  throw new Error(BRIDGE_ERROR.MISSING_POINT);\n});\n\nexport const fromPointCache = (cache, point) => {\n  if (!(point in cache)) {\n    throw new Error(BRIDGE_ERROR.MISSING_POINT);\n  }\n\n  return cache[point];\n};\n\nexport const keystore = obj => {\n  const ks = needBuilder(BRIDGE_ERROR.MISSING_KEYSTORE)(obj);\n  return ks.value.matchWith({\n    Ok: result => result.value,\n    Error: _ => {\n      throw new Error(BRIDGE_ERROR.MISSING_KEYSTORE);\n    },\n  });\n};\n","import { useState, useCallback } from 'react';\nimport { Just, Nothing } from 'folktale/maybe';\n\nimport { azimuth } from 'azimuth-js';\n\nimport { useNetwork } from 'store/network';\n\nimport * as need from 'lib/need';\n\nconst emptyCacheEntry = {\n  residentCount: Nothing(),\n  requestCount: Nothing(),\n  residents: Nothing(),\n  requests: Nothing(),\n};\n\nexport default function useResidents() {\n  const [residentCache, _setResidentCache] = useState({});\n\n  const addToResidentCache = useCallback(\n    (point, entry) =>\n      _setResidentCache(cache => ({ ...cache, [point]: entry })),\n    [_setResidentCache]\n  );\n\n  const getResidents = useCallback(\n    point => residentCache[point] || emptyCacheEntry,\n    [residentCache]\n  );\n\n  const { contracts } = useNetwork();\n  const _contracts = need.contracts(contracts);\n\n  const syncResidentCount = useCallback(\n    async point => {\n      // Do nothing if we've already fetched in full\n      // or we aren't a sponsor\n      const pointSize = azimuth.getPointSize(point);\n      if (Just.hasInstance(getResidents(point).residents)) {\n        return;\n      }\n      if (pointSize === azimuth.PointSize.Planet) {\n        addToResidentCache(point, {\n          residentCount: Just(0),\n          requestCount: Just(0),\n          requests: Just([]),\n          residents: Just([]),\n        });\n        return;\n      }\n\n      const isGalaxy = pointSize === azimuth.PointSize.Galaxy;\n      const [residentCount, requestCount] = await Promise.all([\n        azimuth.getSponsoringCount(_contracts, point),\n        azimuth.getEscapeRequestsCount(_contracts, point),\n      ]);\n\n      // Galaxies sponsor themselves\n      const parsedCount = Number(residentCount);\n      const _residentCount = isGalaxy ? parsedCount - 1 : parsedCount;\n\n      addToResidentCache(point, {\n        residentCount: Just(_residentCount),\n        requestCount: Just(Number(requestCount)),\n        residents: Nothing(),\n        requests: Nothing(),\n      });\n    },\n    [addToResidentCache, _contracts, getResidents]\n  );\n\n  const syncResidents = useCallback(\n    async point => {\n      if (azimuth.getPointSize(point) === azimuth.PointSize.Planet) {\n        addToResidentCache(point, {\n          residentCount: Just(0),\n          requestCount: Just(0),\n          requests: Just([]),\n          residents: Just([]),\n        });\n\n        return;\n      }\n      const [residents, requests] = await Promise.all([\n        azimuth.getSponsoring(_contracts, point),\n        azimuth.getEscapeRequests(_contracts, point),\n      ]);\n\n      // Galaxies sponsor themselves\n      const _residents = residents.filter(r => r !== point);\n\n      addToResidentCache(point, {\n        residentCount: Just(_residents.length),\n        requestCount: Just(requests.length),\n        residents: Just(_residents),\n        requests: Just(requests),\n      });\n    },\n    [addToResidentCache, _contracts]\n  );\n\n  return { getResidents, syncResidentCount, syncResidents };\n}\n","import { useCallback } from 'react';\n\nimport useDetailsStore from './useDetailsStore';\nimport useBirthdaysStore from './useBirthdaysStore';\nimport useRekeyDateStore from './useRekeyDateStore';\nimport useInvitesStore from './useInvitesStore';\nimport useControlledPointsStore from './useControlledPointsStore';\nimport useEclipticOwnerStore from './useEclipticOwnerStore';\nimport useResidents from './useResidentsStore';\n\nexport default function usePointStore() {\n  const { syncDetails, ...details } = useDetailsStore();\n  const { syncBirthday, ...birthdays } = useBirthdaysStore();\n  const { syncRekeyDate, ...rekeyDates } = useRekeyDateStore();\n  const { syncInvites, ...invites } = useInvitesStore();\n  const {\n    syncControlledPoints,\n    ...controlledPoints\n  } = useControlledPointsStore();\n  const { syncResidents, syncResidentCount, ...residents } = useResidents();\n  const ecliptic = useEclipticOwnerStore();\n\n  const syncDates = useCallback(\n    async point => Promise.all([syncBirthday(point), syncRekeyDate(point)]),\n    [syncBirthday, syncRekeyDate]\n  );\n\n  const syncExtras = useCallback(\n    async point =>\n      Promise.all([\n        syncDetails(point),\n        //\n        syncDates(point),\n        syncResidentCount(point),\n        syncInvites(point),\n      ]),\n    [syncDates, syncDetails, syncInvites, syncResidentCount]\n  );\n\n  return {\n    ...details,\n    ...birthdays,\n    ...rekeyDates,\n    ...invites,\n    ...controlledPoints,\n    ...ecliptic,\n    ...residents,\n    syncDetails,\n    syncRekeyDate,\n    syncInvites,\n    syncControlledPoints,\n    syncDates,\n    syncResidents,\n    syncExtras,\n  };\n}\n","import { useState, useCallback } from 'react';\nimport { Just, Nothing } from 'folktale/maybe';\nimport * as azimuth from 'azimuth-js';\n\nimport { useNetwork } from '../network';\n\nexport default function useDetailsStore() {\n  const { contracts } = useNetwork();\n  const [detailsCache, _setDetailsCache] = useState({});\n\n  const addToDetails = useCallback(\n    entry =>\n      _setDetailsCache(cache => ({\n        ...cache,\n        ...entry,\n      })),\n    [_setDetailsCache]\n  );\n\n  // TODO: refactor detailsCache access to use accessor like bithday\n  // Maybe<{}>\n  const getDetails = useCallback(\n    point => (point in detailsCache ? Just(detailsCache[point]) : Nothing()),\n    [detailsCache]\n  );\n\n  const syncDetails = useCallback(\n    async point => {\n      const _contracts = contracts.getOrElse(null);\n      if (!_contracts) {\n        return;\n      }\n\n      // fetch point details\n      const details = await azimuth.azimuth.getPoint(_contracts, point);\n      addToDetails({\n        [point]: details,\n      });\n    },\n    [contracts, addToDetails]\n  );\n\n  return {\n    // TODO: refactor accessors to use getDetails instead of\n    // touching the cache directly\n    pointCache: detailsCache,\n    getDetails,\n    syncDetails,\n  };\n}\n","import { useCallback, useState } from 'react';\nimport { Just, Nothing } from 'folktale/maybe';\nimport * as azimuth from 'azimuth-js';\n\nimport { useNetwork } from '../network';\n\nexport default function useBirthdayStore() {\n  const { contracts, web3 } = useNetwork();\n  const [birthdayCache, _setBirthdayCache] = useState({});\n\n  const addToBirthdayCache = useCallback(\n    entry =>\n      _setBirthdayCache(cache => ({\n        ...cache,\n        ...entry,\n      })),\n    [_setBirthdayCache]\n  );\n\n  const getBirthday = useCallback(point => birthdayCache[point] || Nothing(), [\n    birthdayCache,\n  ]);\n\n  const syncBirthday = useCallback(\n    async point => {\n      const _contracts = contracts.getOrElse(null);\n      const _web3 = web3.getOrElse(null);\n      if (!_contracts || !_web3) {\n        return;\n      }\n\n      // birthday will not change after being set, so bail if we already know\n      if (Just.hasInstance(getBirthday(point))) {\n        return;\n      }\n\n      const birthBlock = await azimuth.azimuth.getActivationBlock(\n        _contracts,\n        point\n      );\n\n      if (birthBlock > 0) {\n        const block = await _web3.eth.getBlock(birthBlock);\n        addToBirthdayCache({\n          [point]: Just(new Date(block.timestamp * 1000)),\n        });\n      } else {\n        // TODO: better encoding for \"no birthday\" state using Result.Ok/Error\n        // if there's no birthday, just use today\n        addToBirthdayCache({\n          [point]: Just(new Date()),\n        });\n      }\n    },\n    [contracts, web3, addToBirthdayCache, getBirthday]\n  );\n\n  return { getBirthday, syncBirthday };\n}\n","import { useCallback, useState } from 'react';\nimport { Just, Nothing } from 'folktale/maybe';\nimport Result from 'folktale/result';\n\nimport { useNetwork } from '../network';\n\nexport default function useRekeyDateStore() {\n  const { web3, contracts } = useNetwork();\n  const [rekeyDateCache, _setRekeyDateCache] = useState({});\n\n  const addToRekeyDateCache = useCallback(\n    entry =>\n      _setRekeyDateCache(cache => ({\n        ...cache,\n        ...entry,\n      })),\n    [_setRekeyDateCache]\n  );\n\n  /**\n   * @param {number} point\n   * @return {Maybe<Result<Date, String>>}\n   */\n  const getRekeyDate = useCallback(\n    point => rekeyDateCache[point] || Nothing(),\n    [rekeyDateCache]\n  );\n\n  const syncRekeyDate = useCallback(\n    async point => {\n      const _web3 = web3.getOrElse(null);\n      const _contracts = contracts.getOrElse(null);\n      if (!_web3 || !_contracts) {\n        return;\n      }\n\n      //TODO tighter search?\n      //TODO maybe move into azimuth-js?\n      const logs = await _contracts.azimuth.getPastEvents('ChangedKeys', {\n        fromBlock: 0,\n        toBlock: 'latest',\n        filter: {\n          point: [point],\n        },\n      });\n\n      // NB(shrugs) using try-catch here to simplify our error handling\n      try {\n        if (logs.length === 0) {\n          throw new Error('No logs available.');\n        }\n\n        // last log is most recent\n        const blockNumber = logs[logs.length - 1].blockNumber;\n        if (blockNumber === null) {\n          // the \"latest\" parameter includes pending blocks,\n          // which won't have a blockNumber just yet\n          throw new Error('Latest rekey is still pending');\n        }\n\n        const block = await _web3.eth.getBlock(blockNumber);\n        addToRekeyDateCache({\n          [point]: Just(Result.Ok(new Date(block.timestamp * 1000))),\n        });\n      } catch {\n        //TODO: better encoding for \"no rekeyDate\" state?\n        addToRekeyDateCache({\n          [point]: Just(Result.Error('No rekey date available.')),\n        });\n      }\n    },\n    [web3, contracts, addToRekeyDateCache]\n  );\n\n  return {\n    getRekeyDate,\n    syncRekeyDate,\n  };\n}\n","import { useState, useEffect, useCallback } from 'react';\nimport { Just, Nothing } from 'folktale/maybe';\nimport Result from 'folktale/result';\nimport * as azimuth from 'azimuth-js';\n\nimport { useNetwork } from '../network';\nimport { useWallet } from 'store/wallet';\n\nexport default function useControlledPointsStore() {\n  const { contracts } = useNetwork();\n  const { wallet } = useWallet();\n  const [controlledPoints, _setControlledPoints] = useState(Nothing());\n\n  const syncControlledPoints = useCallback(async () => {\n    const _contracts = contracts.getOrElse(null);\n    const _wallet = wallet.getOrElse(null);\n    if (!_contracts || !_wallet) {\n      return;\n    }\n\n    _setControlledPoints(Nothing());\n\n    const address = _wallet.address;\n\n    try {\n      const [\n        ownedPoints,\n        incomingPoints,\n        managingPoints,\n        votingPoints,\n        spawningPoints,\n      ] = await Promise.all([\n        azimuth.azimuth.getOwnedPoints(_contracts, address),\n        azimuth.azimuth.getTransferringFor(_contracts, address),\n        azimuth.azimuth.getManagerFor(_contracts, address),\n        azimuth.azimuth.getVotingFor(_contracts, address),\n        azimuth.azimuth.getSpawningFor(_contracts, address),\n      ]);\n\n      if (\n        ownedPoints === null &&\n        incomingPoints === null &&\n        managingPoints === null &&\n        votingPoints === null &&\n        spawningPoints === null\n      ) {\n        _setControlledPoints(\n          Just(Result.Error('Failed to read the blockchain.'))\n        );\n      } else {\n        _setControlledPoints(\n          Just(\n            Result.Ok({\n              ownedPoints,\n              incomingPoints,\n              managingPoints,\n              votingPoints,\n              spawningPoints,\n            })\n          )\n        );\n      }\n    } catch (error) {\n      console.error('failed to fetch controlled points', error);\n      _setControlledPoints(Just(Result.Error(error)));\n    }\n  }, [contracts, wallet]);\n\n  // sync controlled points whenever wallet or contracts changes\n  useEffect(() => {\n    syncControlledPoints();\n  }, [syncControlledPoints]);\n\n  return {\n    controlledPoints,\n    syncControlledPoints,\n  };\n}\n","import { useCallback, useState } from 'react';\nimport * as azimuth from 'azimuth-js';\n\nimport { useNetwork } from 'store/network';\n\nexport default function useEclipticOwnerStore() {\n  const { contracts } = useNetwork();\n  const [eclipticOwner, _setEclipticOwner] = useState(null);\n\n  const syncEclipticOwner = useCallback(async () => {\n    // owner is generally immutable\n    if (eclipticOwner) {\n      return;\n    }\n\n    const _contracts = contracts.getOrElse(null);\n    if (!_contracts) {\n      return;\n    }\n\n    const owner = await azimuth.ecliptic.owner(_contracts);\n    _setEclipticOwner(owner);\n  }, [contracts, eclipticOwner]);\n\n  return { eclipticOwner, syncEclipticOwner };\n}\n","import React, { createContext, forwardRef, useContext } from 'react';\n\nimport usePointStore from './lib/usePointStore';\n\nexport const PointCacheContext = createContext(null);\n\nexport function PointCacheProvider({ children }) {\n  const cache = usePointStore();\n\n  return (\n    <PointCacheContext.Provider value={cache}>\n      {children}\n    </PointCacheContext.Provider>\n  );\n}\n\n// Hook version\nexport function usePointCache() {\n  return useContext(PointCacheContext);\n}\n\n// HOC version\nexport const withPointCache = Component =>\n  forwardRef((props, ref) => (\n    <PointCacheContext.Consumer>\n      {cache => <Component ref={ref} {...cache} {...props} />}\n    </PointCacheContext.Consumer>\n  ));\n","import React, { createContext, forwardRef, useContext, useState } from 'react';\n\nexport const TxnCursorContext = createContext(null);\n\nfunction _useTxnCursor() {\n  const [txnCursor, setTxnCursor] = useState({});\n\n  return {\n    txnCursor,\n    setTxnCursor,\n  };\n}\n\nexport function TxnCursorProvider({ children }) {\n  const txnCursor = _useTxnCursor();\n\n  return (\n    <TxnCursorContext.Provider value={txnCursor}>\n      {children}\n    </TxnCursorContext.Provider>\n  );\n}\n\n// Hook version\nexport function useTxnCursor() {\n  return useContext(TxnCursorContext);\n}\n\n// HOC version\nexport const withTxnCursor = Component =>\n  forwardRef((props, ref) => (\n    <TxnCursorContext.Consumer>\n      {txnCursor => <Component ref={ref} {...txnCursor} {...props} />}\n    </TxnCursorContext.Consumer>\n  ));\n","import { nest } from 'lib/nest';\n\nimport { HistoryProvider } from './history';\nimport { OnlineProvider } from './online';\nimport { NetworkProvider } from './network';\nimport { WalletProvider } from './wallet';\nimport { PointCursorProvider } from './pointCursor';\nimport { StarReleaseCacheProvider } from './starRelease';\nimport { PointCacheProvider } from './pointCache';\nimport { TxnCursorProvider } from './txnCursor';\nimport { MediaQueryProvider } from 'lib/MediaQuery';\n\n// nest all of the providers within each other to avoid hella depth\nexport default nest([\n  HistoryProvider,\n  OnlineProvider,\n  NetworkProvider,\n  WalletProvider,\n  PointCursorProvider,\n  PointCacheProvider,\n  TxnCursorProvider,\n  MediaQueryProvider,\n  StarReleaseCacheProvider,\n]);\n","import { createFactory } from 'react';\n\n// inspired by recompose/nest\nexport const nest = (components = []) => ({ children, ...props }) =>\n  components\n    .map(createFactory)\n    .reduceRight((child, factory) => factory(props, child), children);\n","import { useState, useCallback } from 'react';\nimport { Nothing, Just } from 'folktale/maybe';\n\nimport { useNetwork } from 'store/network';\nimport { useWallet } from 'store/wallet';\nimport {\n  generateWithdrawTxs,\n  getLinear,\n  getConditional,\n  getLockupKind,\n} from 'lib/starRelease';\n\nexport default function useStarRelease() {\n  const { contracts } = useNetwork();\n  const { wallet } = useWallet();\n\n  const [starReleaseDetails, _setDetails] = useState(Nothing());\n\n  const [batchLimits, setBatchLimits] = useState([]);\n\n  const syncStarReleaseDetails = useCallback(async () => {\n    const _wallet = wallet.getOrElse(null);\n    const _contracts = contracts.getOrElse(null);\n    if (!(_contracts && _wallet)) {\n      return;\n    }\n    _setDetails(Nothing());\n\n    const address = _wallet.address;\n\n    try {\n      const [linear, conditional, kind] = await Promise.all([\n        getLinear(_contracts, address),\n        getConditional(_contracts, address),\n        getLockupKind(_contracts, address),\n      ]);\n\n      const keys = Object.keys(linear);\n      const result = keys.reduce(\n        (acc, key) => ({ ...acc, [key]: linear[key] + conditional[key] }),\n        {}\n      );\n      result.kind = kind;\n      result.linear = { approvedTransferTo: linear.approvedTransferTo };\n      result.conditional = {\n        approvedTransferTo: conditional.approvedTransferTo,\n      };\n      setBatchLimits(conditional.batchLimits);\n\n      _setDetails(Just(result));\n    } catch (e) {\n      _setDetails(Just(null));\n      console.error('error fetching star release details', e);\n    }\n  }, [contracts, wallet]);\n\n  const withdraw = useCallback(\n    (amount, to) => {\n      const _wallet = wallet.getOrElse(null);\n      const _contracts = contracts.getOrElse(null);\n      if (!(_contracts && _wallet)) {\n        return [];\n      }\n      return generateWithdrawTxs(_contracts, batchLimits, amount, to);\n    },\n    [batchLimits, contracts, wallet]\n  );\n\n  return { starReleaseDetails, syncStarReleaseDetails, withdraw };\n}\n","export const ROUTE_NAMES = {\n  DEFAULT: Symbol('DEFAULT'),\n  DISCLAIMER: Symbol('DISCLAIMER'),\n  //\n  ACTIVATE: Symbol('ACTIVATE'),\n  INVITE_TRANSACTIONS: Symbol('INVITE_TRANSACTIONS'),\n  INVITES_MANAGE: Symbol('INVITES_MANAGE'),\n  //\n  LOGIN: Symbol('LOGIN'),\n  LOGIN_OTHER: Symbol('OTHER'),\n  REDOWNLOAD: Symbol('REDOWNLOAD'),\n  RETICKET: Symbol('RETICKET'),\n  PERMISSIONS: Symbol('PERMISSIONS'),\n  //\n  ACCEPT_TRANSFER: Symbol('ACCEPT_TRANSFER'),\n  CANCEL_TRANSFER: Symbol('CANCEL_TRANSFER'),\n  POINTS: Symbol('POINTS'),\n  POINT: Symbol('POINT'),\n  SIGIL_GENERATOR: Symbol('SIGIL_GENERATOR'),\n  CREATE_GALAXY: Symbol('CREATE_GALAXY'),\n  SENATE: Symbol('SENATE'),\n  DOCUMENTS: Symbol('DOCUMENTS'),\n  UPGRADES: Symbol('UPGRADES'),\n  ISSUE_CHILD: Symbol('ISSUE_CHILD'),\n  PARTY_SET_POOL_SIZE: Symbol('PARTY_SET_POOL_SIZE'),\n  INVITE_COHORT: Symbol('INVITE_COHORT'),\n  STAR_RELEASE: Symbol('STAR_RELEASE'),\n  ACCEPT_LOCKUP: Symbol('ACCEPT_LOCKUP'),\n  URBIT_OS: Symbol('URBIT_OS'),\n  URBIT_ID: Symbol('URBIT_ID'),\n  RESIDENTS: Symbol('RESIDENTS'),\n  ADOPT: Symbol('ADOPT'),\n  BITCOIN: Symbol('BITCOIN'),\n  BITCOIN_XPUB: Symbol('BITCOIN_XPUB'),\n  BITCOIN_SIGN_TRANSACTION: Symbol('BITCOIN_SIGN_TRANSACTION'),\n};\n","import { useCallback, useState } from 'react';\n\n/**\n * useLocalStorageState is useState but it persists to localStorage\n *\n * inspired by:\n * https://github.com/streamich/react-use/blob/master/src/useLocalStorage.ts\n * https://usehooks.com/useLocalStorage/\n */\nexport default function useLocalStorageState(key, initialValue) {\n  const [state, _setState] = useState(() => {\n    try {\n      const value = localStorage.getItem(key);\n      if (value === null) {\n        localStorage.setItem(key, JSON.stringify(initialValue));\n        return initialValue;\n      } else {\n        return JSON.parse(value);\n      }\n    } catch {\n      // if user is in private mode or has storage restriction\n      // localStorage can throw. JSON.parse and JSON.stringify\n      // can throw, too.\n      return initialValue;\n    }\n  });\n\n  const setState = useCallback(\n    value => {\n      try {\n        localStorage.setItem(key, JSON.stringify(value));\n      } catch {\n        // if user is in private mode or has storage restriction\n        // localStorage can throw. Also JSON.stringify can throw.\n      }\n\n      _setState(value);\n    },\n    [key]\n  );\n\n  return [state, setState];\n}\n","import useLocalStorageState from './useLocalStorageState';\n\nconst HAS_DISCLAIMED_KEY = 'bridge:has-disclaimed';\n\nexport default function useHasDisclaimed() {\n  return useLocalStorageState(HAS_DISCLAIMED_KEY, false);\n}\n","import React from 'react';\nimport cn from 'classnames';\nimport { Flex, Text } from 'indigo-react';\n\nexport default function WarningBox({ className, children }) {\n  return (\n    <Flex className={cn('bg-red1 pv3 ph4', className)} align=\"center\">\n      <Text className=\"f6 fw-bold red3\">{children}</Text>\n    </Flex>\n  );\n}\n","import React, { useCallback, useMemo } from 'react';\nimport cn from 'classnames';\nimport { Grid, H3, B, Text, CheckboxInput } from 'indigo-react';\n\nimport useHasDisclaimed from 'lib/useHasDisclaimed';\nimport { useLocalRouter } from 'lib/LocalRouter';\n\nimport View from 'components/View';\nimport WarningBox from 'components/WarningBox';\nimport BridgeForm from 'form/BridgeForm';\nimport SubmitButton from 'form/SubmitButton';\nimport { composeValidator, buildCheckboxValidator } from 'form/validators';\n\nconst TEXT_STYLE = 'f5';\n\nexport default function ActivateDisclaimer() {\n  const { pop, popAndPush, data } = useLocalRouter();\n  const [, setHasDisclaimed] = useHasDisclaimed();\n\n  const validate = useMemo(\n    () => composeValidator({ checkbox: buildCheckboxValidator(true) }),\n    []\n  );\n\n  const initialValues = useMemo(() => ({ checkbox: false }), []);\n\n  const goNext = useCallback(async () => {\n    setHasDisclaimed(true);\n    if (data.next) {\n      popAndPush(data.next);\n    } else {\n      pop();\n    }\n  }, [data, pop, popAndPush, setHasDisclaimed]);\n\n  return (\n    <View>\n      <Grid gap={2} className=\"mt8 mb10\">\n        <Grid.Item as={H3} full>\n          Disclaimer\n        </Grid.Item>\n        <Grid.Item full>\n          <Text className={cn(TEXT_STYLE, 'block mb4')}>\n            Welcome to Bridge. Please read this information. Your assets could\n            be stolen if you do not pay attention to these warnings.\n          </Text>\n\n          <Text className={cn(TEXT_STYLE, 'block mb4')}>\n            <B>You own and control your assets. We do not.</B> If you send your\n            assets to another address, we can’t get them back for you.\n          </Text>\n\n          <B className={TEXT_STYLE}>Please understand that nobody can:</B>\n          <Text className={cn(TEXT_STYLE, 'block mb4')}>\n            1. Access your assets for you <br />\n            2. Recover, reset, or modify ANY of your information <br />\n            3. Reverse, cancel, or refund transactions <br />\n            4. Hold, back-up, or access your keys\n          </Text>\n\n          <B className={TEXT_STYLE}>\n            You’re responsible for keeping your information safe. This includes:\n          </B>\n          <Text className={cn(TEXT_STYLE, 'block mb4')}>\n            1. Private Keys/Mnemonic Phrases and passwords <br />\n            2. JSON files <br />\n            3. Hardware wallet PINs; <br />\n            4. Downloading this software from a reliable site, and ensuring it\n            has not been tampered with.\n          </Text>\n\n          <B className={TEXT_STYLE}>To be clear</B>\n          <Text className={cn(TEXT_STYLE, 'block')}>\n            This software is provided “as is” without warranties of any kind and\n            our liability to you in connection with the same is limited;\n          </Text>\n          <Text className={cn(TEXT_STYLE, 'block')}>\n            We have no liability for any security problems or incidents that you\n            may experience, including any loss or theft of your keys or any\n            problems that may arise in connection with your wallet.\n          </Text>\n        </Grid.Item>\n        <Grid.Item full as={WarningBox}>\n          Warning: Nobody but you can restore or reset your Master Ticket\n        </Grid.Item>\n        <BridgeForm\n          validate={validate}\n          afterSubmit={goNext}\n          initialValues={initialValues}>\n          {({ handleSubmit }) => (\n            <>\n              <Grid.Item\n                full\n                as={CheckboxInput}\n                name=\"checkbox\"\n                label=\"I acknowledge and understand these rights\"\n              />\n\n              <Grid.Item full as={SubmitButton} handleSubmit={handleSubmit}>\n                Continue\n              </Grid.Item>\n            </>\n          )}\n        </BridgeForm>\n      </Grid>\n    </View>\n  );\n}\n","import { useMemo } from 'react';\nimport { isValidAddress } from './utils/address';\n\n// looks into the GET parameters and attempts to construct a \"flow\" object,\n// which would indicate bridge is to be used for one specific flow.\n// expects to find any of the following sets of parameters, varying by kind.\n//\n// ? kind = takeLockup\n// & lock = linear | conditional  // which lockup contract, defaults to linear\n// & from = 0x1234abcd            // ethereum address to accept transfer from\n//\n// ? kind = btc\n// & utx  = somebase64string\n//\n// ? kind = xpub\n//\n\nconst COMMANDS = {\n  TAKE_LOCKUP: 'takeLockup',\n  BITCOIN: 'btc',\n  XPUB: 'xpub',\n};\n\nconst useFlowCommand = () => {\n  const flow = useMemo(() => {\n    let flow = {};\n\n    window.location.search\n      .substr(1)\n      .split('&')\n      .forEach(arg => {\n        if ('' === arg) return;\n        const pam = arg.split('=');\n        flow[pam[0]] = pam.length <= 1 ? true : decodeURIComponent(pam[1]);\n      });\n\n    if (typeof flow === 'object') {\n      switch (flow.kind) {\n        case COMMANDS.TAKE_LOCKUP:\n          flow.lock = flow.lock || 'linear';\n          if (\n            (flow.lock !== 'linear' && flow.lock !== 'conditional') ||\n            !isValidAddress(flow.from)\n          ) {\n            flow = null;\n          }\n          break;\n        //\n        case COMMANDS.BITCOIN:\n          try {\n            atob(flow.utx);\n          } catch (e) {\n            flow = null;\n          }\n          break;\n        //\n        case COMMANDS.XPUB:\n          break;\n        //\n        default:\n          console.log('unrecognized kind of flow:', flow.kind);\n        // eslint-disable-next-line no-fallthrough\n        case undefined:\n          flow = null;\n          break;\n      }\n    } else {\n      flow = null;\n    }\n\n    return flow;\n  }, []);\n\n  return flow;\n};\n\nexport { COMMANDS, useFlowCommand };\n","var _rect, _path;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgSecretShow(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 16,\n    height: 16,\n    viewBox: \"0 0 16 16\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _rect || (_rect = /*#__PURE__*/React.createElement(\"rect\", {\n    width: 16,\n    height: 16,\n    fill: \"white\"\n  })), _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    clipRule: \"evenodd\",\n    d: \"M8 13C13.0495 13 16 8 16 8C16 8 13.0495 3 8 3C2.95054 3 0 8 0 8C0 8 2.95054 13 8 13ZM8 10C9.10457 10 10 9.10457 10 8C10 6.89543 9.10457 6 8 6C6.89543 6 6 6.89543 6 8C6 9.10457 6.89543 10 8 10Z\",\n    fill: \"#B1B2B3\"\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgSecretShow);\nexport default __webpack_public_path__ + \"static/media/secret-show.339cc6f2.svg\";\nexport { ForwardRef as ReactComponent };","export const timeout = ms => new Promise(resolve => setTimeout(resolve, ms));\n","var _rect, _path, _g, _defs;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgSecretHidden(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 16,\n    height: 16,\n    viewBox: \"0 0 16 16\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _rect || (_rect = /*#__PURE__*/React.createElement(\"rect\", {\n    width: 16,\n    height: 16,\n    fill: \"white\"\n  })), _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    clipRule: \"evenodd\",\n    d: \"M8 13C13.0495 13 16 8 16 8C16 8 13.0495 3 8 3C2.95054 3 0 8 0 8C0 8 2.95054 13 8 13ZM8 10C9.10457 10 10 9.10457 10 8C10 6.89543 9.10457 6 8 6C6.89543 6 6 6.89543 6 8C6 9.10457 6.89543 10 8 10Z\",\n    fill: \"black\"\n  })), _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    filter: \"url(#filter0_d)\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M2 2.70588L2.70588 2L14 13.2941L13.2941 14L2 2.70588Z\",\n    fill: \"black\"\n  }))), _defs || (_defs = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"filter\", {\n    id: \"filter0_d\",\n    x: 1,\n    y: 2,\n    width: 13,\n    height: 12,\n    filterUnits: \"userSpaceOnUse\",\n    colorInterpolationFilters: \"sRGB\"\n  }, /*#__PURE__*/React.createElement(\"feFlood\", {\n    floodOpacity: 0,\n    result: \"BackgroundImageFix\"\n  }), /*#__PURE__*/React.createElement(\"feColorMatrix\", {\n    in: \"SourceAlpha\",\n    type: \"matrix\",\n    values: \"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0\"\n  }), /*#__PURE__*/React.createElement(\"feOffset\", {\n    dx: -1\n  }), /*#__PURE__*/React.createElement(\"feColorMatrix\", {\n    type: \"matrix\",\n    values: \"0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 1 0\"\n  }), /*#__PURE__*/React.createElement(\"feBlend\", {\n    mode: \"normal\",\n    in2: \"BackgroundImageFix\",\n    result: \"effect1_dropShadow\"\n  }), /*#__PURE__*/React.createElement(\"feBlend\", {\n    mode: \"normal\",\n    in: \"SourceGraphic\",\n    in2: \"effect1_dropShadow\",\n    result: \"shape\"\n  })))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgSecretHidden);\nexport default __webpack_public_path__ + \"static/media/secret-hidden.e5ef1af3.svg\";\nexport { ForwardRef as ReactComponent };","import React, { useCallback, useMemo, useRef } from 'react';\nimport { Just } from 'folktale/maybe';\nimport * as azimuth from 'azimuth-js';\nimport * as kg from 'urbit-key-generation';\nimport {\n  Grid,\n  CheckboxInput,\n  Flex,\n  ToggleInput,\n  AccessoryIcon,\n} from 'indigo-react';\nimport { FORM_ERROR } from 'final-form';\n\nimport { useNetwork } from 'store/network';\nimport { useWallet } from 'store/wallet';\nimport { usePointCursor } from 'store/pointCursor';\n\nimport * as need from 'lib/need';\nimport { urbitWalletFromTicket } from 'lib/wallet';\nimport { WALLET_TYPES } from 'lib/constants';\nimport useImpliedPoint from 'lib/useImpliedPoint';\nimport useLoginView from 'lib/useLoginView';\nimport { patp2dec } from 'lib/patp2dec';\nimport { timeout } from 'lib/timeout';\n\nimport BridgeForm from 'form/BridgeForm';\nimport Condition from 'form/Condition';\nimport { TicketInput, PassphraseInput, PointInput } from 'form/Inputs';\nimport {\n  composeValidator,\n  buildCheckboxValidator,\n  buildPatqValidator,\n  buildShardValidator,\n  buildPassphraseValidator,\n  buildPointValidator,\n} from 'form/validators';\nimport FormError from 'form/FormError';\nimport SubmitButton from 'form/SubmitButton';\nimport { WARNING } from 'form/helpers';\n\nimport { ReactComponent as SecretShowIcon } from 'assets/secret-show.svg';\nimport { ReactComponent as SecretHideIcon } from 'assets/secret-hidden.svg';\n\nfunction AdvancedOptions() {\n  return (\n    <Flex.Item as={Flex}>\n      <Condition when=\"useAdvanced\" is={true}>\n        <Flex.Item\n          as={CheckboxInput}\n          inline\n          white\n          className=\"mr4\"\n          name=\"usePassphrase\"\n          label=\"Passphrase\"\n          style={{ boxSizing: 'border-box' }}\n        />\n        <Flex.Item\n          as={CheckboxInput}\n          inline\n          white\n          className=\"mr4\"\n          name=\"useShards\"\n          label=\"Shards\"\n          style={{ boxSizing: 'border-box' }}\n        />\n      </Condition>\n      <Flex.Item\n        as={ToggleInput}\n        name=\"useAdvanced\"\n        label=\"Settings\"\n        small\n        inverseLabel=\"Close\"\n      />\n    </Flex.Item>\n  );\n}\n\nfunction TicketInputAccessory({ name }) {\n  return (\n    <AccessoryIcon>\n      <ToggleInput\n        name={name}\n        className=\"mt1\"\n        inverseLabel={<SecretShowIcon />}\n        label={<SecretHideIcon />}\n      />\n    </AccessoryIcon>\n  );\n}\n\nexport default function Ticket({ className, goHome }) {\n  useLoginView(WALLET_TYPES.TICKET);\n\n  const { contracts } = useNetwork();\n  const { setUrbitWallet } = useWallet();\n  const { setPointCursor } = usePointCursor();\n  const impliedPoint = useImpliedPoint();\n  const didWarn = useRef(false);\n\n  const validateForm = useCallback((values, errors) => {\n    didWarn.current = false;\n\n    if (errors.point) {\n      return errors;\n    }\n\n    if (values.useShards) {\n      if (errors.shard1 || errors.shard2 || errors.shard3) {\n        return errors;\n      }\n      const empty = ['shard1', 'shard2', 'shard3'].filter(s => !values[s]);\n      if (empty.length > 1) {\n        let errors = {};\n        empty.forEach(s => {\n          errors[s] = 'Please provide at least two out of three shards.';\n        });\n        return errors;\n      }\n    } else {\n      if (errors.ticket) {\n        return errors;\n      }\n    }\n  }, []);\n\n  const onSubmit = useCallback(\n    async values => {\n      const ticket = values.useShards\n        ? kg.combine(\n            [values.shard1, values.shard2, values.shard3].map(v =>\n              v === '' ? undefined : v\n            )\n          )\n        : values.ticket;\n\n      try {\n        const _contracts = need.contracts(contracts);\n        const point = patp2dec(values.point);\n\n        await timeout(16); // allow ui events to flush\n        const urbitWallet = await urbitWalletFromTicket(\n          ticket,\n          point,\n          values.passphrase\n        );\n\n        const [isOwner, isTransferProxy] = await Promise.all([\n          azimuth.azimuth.isOwner(\n            _contracts,\n            point,\n            urbitWallet.ownership.keys.address\n          ),\n          azimuth.azimuth.isTransferProxy(\n            _contracts,\n            point,\n            urbitWallet.ownership.keys.address\n          ),\n        ]);\n\n        const noPermissions = !isOwner && !isTransferProxy;\n        // warn the user\n        if (noPermissions && !didWarn.current) {\n          didWarn.current = true;\n          return {\n            [WARNING]:\n              'This wallet is not the owner or transfer proxy for this point.',\n          };\n        }\n\n        setUrbitWallet(Just(urbitWallet));\n        setPointCursor(Just(patp2dec(values.point)));\n      } catch (error) {\n        console.error(error);\n        return {\n          [FORM_ERROR]: `Unable to derive wallet from ${\n            values.useShards ? 'shards' : 'ticket'\n          }.`,\n        };\n      }\n    },\n    [contracts, setPointCursor, setUrbitWallet]\n  );\n\n  const validate = useMemo(\n    () =>\n      composeValidator(\n        {\n          useAdvanced: buildCheckboxValidator(),\n          usePassphrase: buildCheckboxValidator(),\n          useShards: buildCheckboxValidator(),\n          point: buildPointValidator(4),\n          ticket: buildPatqValidator(),\n          shard1: buildShardValidator(),\n          shard2: buildShardValidator(),\n          shard3: buildShardValidator(),\n          ticketHidden: buildCheckboxValidator(),\n          passphrase: buildPassphraseValidator(),\n        },\n        validateForm\n      ),\n    [validateForm]\n  );\n\n  const initialValues = useMemo(\n    () => ({\n      point: impliedPoint || '',\n      usePasshrase: false,\n      useShards: false,\n      ticketHidden: true,\n      useAdvanced: false,\n    }),\n    [impliedPoint]\n  );\n\n  return (\n    <Grid className={className}>\n      <BridgeForm\n        validate={validate}\n        onSubmit={onSubmit}\n        afterSubmit={goHome}\n        initialValues={initialValues}>\n        {({ handleSubmit, values, submitting }) => (\n          <>\n            <Grid.Item full as={PointInput} name=\"point\" />\n\n            <Condition when=\"useShards\" is={false}>\n              <Grid.Item\n                full\n                as={TicketInput}\n                hidden={values.ticketHidden}\n                labelAccessory={<AdvancedOptions />}\n                accessory={<TicketInputAccessory name=\"ticketHidden\" />}\n                className=\"mt3\"\n                name=\"ticket\"\n                label=\"Master Ticket\"\n              />\n            </Condition>\n\n            <Condition when=\"useShards\" is={true}>\n              <Grid.Item\n                full\n                as={TicketInput}\n                accessory={<TicketInputAccessory name=\"ticketHidden\" />}\n                hidden={values.ticketHidden}\n                labelAccessory={<AdvancedOptions />}\n                className=\"mt3\"\n                name=\"shard1\"\n                label=\"Shard 1\"\n              />\n              <Grid.Item\n                full\n                as={TicketInput}\n                accessory={<TicketInputAccessory name=\"ticketHidden\" />}\n                hidden={values.ticketHidden}\n                className=\"mt3\"\n                name=\"shard2\"\n                label=\"Shard 2\"\n              />\n              <Grid.Item\n                full\n                as={TicketInput}\n                className=\"mt3\"\n                accessory={<TicketInputAccessory name=\"ticketHidden\" />}\n                hidden={values.ticketHidden}\n                name=\"shard3\"\n                label=\"Shard 3\"\n              />\n            </Condition>\n\n            <Condition when=\"usePassphrase\" is={true}>\n              <Grid.Item\n                full\n                as={PassphraseInput}\n                className=\"mt3\"\n                name=\"passphrase\"\n                label=\"Wallet Passphrase\"\n              />\n            </Condition>\n\n            <Grid.Item full as={FormError} />\n\n            <Grid.Item\n              full\n              as={SubmitButton}\n              center\n              handleSubmit={handleSubmit}>\n              {isWarning =>\n                submitting\n                  ? 'Logging in...'\n                  : isWarning\n                  ? 'Login Anyway'\n                  : 'Login'\n              }\n            </Grid.Item>\n          </>\n        )}\n      </BridgeForm>\n    </Grid>\n  );\n}\n","import ob from 'urbit-ob';\n\nimport { ensurePatFormat } from 'form/formatters';\n\n/**\n * pull the suggested point from the subdomain\n */\nexport default function useImpliedPoint() {\n  const subdomain = window.location.host.split('.')[0];\n  const patp = ensurePatFormat(subdomain);\n  const isValid = ob.isValidPatp(patp);\n\n  return isValid ? patp : null;\n}\n","import React from 'react';\nimport cn from 'classnames';\nimport { Grid, AccessoryIcon } from 'indigo-react';\n\nexport default function Accordion({\n  className,\n  views,\n  options,\n  currentTab,\n  onTabChange,\n\n  // Tab props\n  ...rest\n}) {\n  const Tab = views[currentTab];\n\n  return (\n    <Grid className={className}>\n      {options.map((option, i) => {\n        const isActive = option.value === currentTab;\n\n        return (\n          <React.Fragment key={option.value}>\n            <Grid.Item\n              full\n              className={cn('f5 pv3 rel', {\n                pointer: !option.disabled,\n                gray3: option.disabled,\n              })}\n              onClick={\n                option.disabled\n                  ? null\n                  : () => onTabChange(isActive ? undefined : option.value)\n              }>\n              {option.text}\n              {option.disabled && (\n                <sup className=\"f6 lowercase\">{option.disabled}</sup>\n              )}\n              <div\n                className=\"abs\"\n                style={{\n                  top: 0,\n                  right: 0,\n                  height: '100%',\n                  width: '44px',\n                  overflow: 'hidden',\n                }}>\n                <AccessoryIcon\n                  className={cn({\n                    black: !option.disabled,\n                  })}>\n                  {isActive ? '▲' : '▼'}\n                </AccessoryIcon>\n              </div>\n            </Grid.Item>\n            {isActive && <Grid.Item full as={Tab} {...rest} />}\n            <Grid.Divider />\n          </React.Fragment>\n        );\n      })}\n    </Grid>\n  );\n}\n","import React, { useRef } from 'react';\nimport { Button } from 'indigo-react';\n\nexport default function UploadButton({ children, onChange, ...rest }) {\n  const button = useRef();\n\n  return (\n    <label htmlFor=\"file\" {...rest}>\n      <Button accessory=\"↑\" solid>\n        {children}\n      </Button>\n      <input\n        id=\"file\"\n        ref={button}\n        className=\"super-hidden\"\n        type=\"file\"\n        onChange={() => onChange(button.current)}\n      />\n    </label>\n  );\n}\n","import React, { useCallback } from 'react';\nimport { useField } from 'react-final-form';\nimport UploadButton from 'components/UploadButton';\nimport { AccessoryIcon } from 'indigo-react';\n\nexport default function UploadInput({ name, label, ...rest }) {\n  const {\n    input,\n    meta: { validating, submitting, touched, active, error },\n  } = useField(name, { type: 'text' });\n\n  const handleUpload = useCallback(\n    element => {\n      input.onFocus();\n\n      const file = element.files.item(0);\n      const reader = new FileReader();\n\n      reader.onload = e => {\n        input.onChange({ target: { value: e.target.result } });\n      };\n\n      const failure = _ => {\n        input.onBlur();\n      };\n\n      reader.onerror = failure;\n      reader.onabort = failure;\n\n      reader.readAsText(file);\n    },\n    [input]\n  );\n\n  return (\n    <UploadButton\n      onChange={handleUpload}\n      accessory={\n        touched && !active && error ? (\n          <AccessoryIcon.Failure />\n        ) : validating || submitting ? (\n          <AccessoryIcon.Pending />\n        ) : (\n          undefined\n        )\n      }\n      {...rest}>\n      {label}\n    </UploadButton>\n  );\n}\n","import React, { useCallback } from 'react';\nimport { Grid, Text, LinkButton, H5 } from 'indigo-react';\nimport { Just } from 'folktale/maybe';\nimport { FORM_ERROR } from 'final-form';\n\nimport { useWallet } from 'store/wallet';\nimport { useNetwork } from 'store/network';\n\nimport { abbreviateAddress } from 'lib/utils/address';\nimport { WALLET_TYPES } from 'lib/constants';\nimport { MetamaskWallet } from 'lib/metamask';\nimport { getAuthToken } from 'lib/authToken';\nimport useLoginView from 'lib/useLoginView';\nimport * as need from 'lib/need';\n\nimport SubmitButton from 'form/SubmitButton';\nimport BridgeForm from 'form/BridgeForm';\n\nexport default function Metamask({ className, goHome }) {\n  useLoginView(WALLET_TYPES.METAMASK);\n  const { setWallet, setWalletType, setAuthToken } = useWallet();\n\n  const { web3 } = useNetwork();\n  const _web3 = need.web3(web3);\n\n  const onSubmit = useCallback(async () => {\n    try {\n      const accounts = await window.ethereum.send('eth_requestAccounts');\n      const wallet = new MetamaskWallet(accounts.result[0]);\n\n      const authToken = await getAuthToken({\n        address: wallet.address,\n        walletType: WALLET_TYPES.METAMASK,\n        web3: _web3,\n      });\n\n      setAuthToken(Just(authToken));\n      setWallet(Just(wallet));\n      setWalletType(WALLET_TYPES.METAMASK);\n    } catch (e) {\n      console.error(e);\n      return { [FORM_ERROR]: e.message };\n    }\n  }, [_web3, setAuthToken, setWallet, setWalletType]);\n\n  return (\n    <Grid className={className}>\n      {(window.ethereum && Login({ onSubmit, goHome })) || Unsupported()}\n    </Grid>\n  );\n}\n\nfunction Unsupported() {\n  return (\n    <>\n      <Grid.Item full as={H5}>\n        Unsupported\n      </Grid.Item>\n      <Grid.Item full as={Text} className=\"f6 mb3\">\n        Metamask is not installed on this browser. <br />\n        <LinkButton href=\"https://metamask.io\" as={LinkButton}>\n          Get Metamask\n        </LinkButton>\n      </Grid.Item>\n    </>\n  );\n}\nfunction Login({ onSubmit, goHome }) {\n  return (\n    <>\n      <Grid.Item full as={Text} className=\"f6 gray4 mb3\">\n        If you wish to login with a different wallet, please change it in the\n        Metamask extension\n      </Grid.Item>\n      <BridgeForm onSubmit={onSubmit} afterSubmit={goHome}>\n        {({ handleSubmit }) => (\n          <Grid.Item full as={SubmitButton} handleSubmit={handleSubmit}>\n            Login\n            {window.ethereum.selectedAddress &&\n              ' as ' + abbreviateAddress(window.ethereum.selectedAddress)}\n          </Grid.Item>\n        )}\n      </BridgeForm>\n    </>\n  );\n}\n","import WalletConnect from '@walletconnect/client';\nimport QRCodeModal from '@walletconnect/qrcode-modal';\nimport { ITxData } from '@walletconnect/types';\n\nimport { useEffect, useMemo, useState } from 'react';\nimport { Just, Nothing } from 'folktale/maybe';\n\nimport { useWallet } from 'store/wallet';\nimport { getAuthToken } from './authToken';\nimport { WALLET_TYPES } from './constants';\nimport WalletConnectWallet from './types/WalletConnectWallet';\n\ntype PeerMeta = {\n  description: string;\n  icons?: string[];\n  name: string;\n  url: string;\n};\n\ntype ConnectEvent = {\n  event: 'connect';\n  params: [\n    {\n      accounts: string[];\n      chainId: number;\n      peerId: string;\n      peerMeta: PeerMeta;\n    }\n  ];\n};\n\nexport const useWalletConnect = () => {\n  const { setWallet, setAuthToken, resetWallet } = useWallet();\n  const [connector, setConnector] = useState<WalletConnect | null>(null);\n  const [address, setAddress] = useState<string | null>(null);\n  const [peerMeta, setPeerMeta] = useState<PeerMeta | null>(null);\n\n  const resetConnector = () => {\n    const newConnector = new WalletConnect({\n      bridge: 'https://bridge.walletconnect.org',\n      qrcodeModal: QRCodeModal,\n    });\n\n    setConnector(newConnector);\n\n    // restore state from cached connection\n    if (newConnector.accounts.length > 0) {\n      setAddress(newConnector.accounts[0]);\n    }\n\n    if (newConnector.peerMeta) {\n      setPeerMeta(newConnector.peerMeta);\n    }\n  };\n\n  // Init connector\n  useEffect(() => {\n    resetConnector();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // Behavior\n  const connect = async () => {\n    if (!connector || connector.connected) {\n      return;\n    }\n\n    await connector.createSession();\n  };\n\n  const disconnect = async () => {\n    if (!connector) {\n      return;\n    }\n\n    await connector.killSession();\n  };\n\n  const authenticate = async () => {\n    if (!(address && connector)) {\n      return;\n    }\n\n    let authToken = Nothing();\n    try {\n      const token = await getAuthToken({\n        address,\n        connector,\n        walletType: WALLET_TYPES.WALLET_CONNECT,\n      });\n      authToken = Just(token);\n    } catch (e) {\n      if (e.message === 'METHOD_NOT_SUPPORTED') {\n        console.warn(\n          'wallet does not support message signing. proceeding without auth token.'\n        );\n      } else {\n        throw e;\n        //TODO  should errors with this *really* prevent login?\n      }\n    }\n\n    const wallet: WalletConnectWallet = {\n      address,\n    };\n\n    setAuthToken(authToken);\n    setWallet(Just(wallet));\n  };\n\n  const isConnected = () => {\n    if (!connector) {\n      return false;\n    }\n\n    return connector.connected;\n  };\n\n  const peerIcon = useMemo(() => {\n    if (!peerMeta?.icons) {\n      return null;\n    }\n\n    // Some peers return a list of empty string(s) :)\n    const iconCandidates = peerMeta.icons.filter(pm => pm !== '');\n\n    return iconCandidates.length > 0 ? iconCandidates[0] : null;\n  }, [peerMeta]);\n\n  const signTransaction = async ({\n    from,\n    to,\n    gas,\n    gasPrice,\n    value,\n    data,\n    nonce,\n  }: ITxData): Promise<string> => {\n    return new Promise((resolve, reject) => {\n      if (!connector || !isConnected()) {\n        reject(new Error('No connected wallet available for signing'));\n        return;\n      }\n\n      return connector\n        .signTransaction({\n          from,\n          to,\n          gas,\n          gasPrice,\n          value,\n          data,\n          nonce,\n        })\n        .then((signature: string) => resolve(signature))\n        .catch((error: Error) => reject(error));\n    });\n  };\n\n  const sendTransaction = async ({\n    from,\n    to,\n    gas,\n    gasPrice,\n    value,\n    data,\n    nonce,\n  }: ITxData): Promise<string> => {\n    return new Promise((resolve, reject) => {\n      if (!connector || !isConnected()) {\n        reject(new Error('No connected wallet available for sending'));\n        return;\n      }\n\n      //REVIEW  .then path untested\n      return connector\n        .sendTransaction({\n          from,\n          to,\n          gas,\n          gasPrice,\n          value,\n          data,\n          nonce,\n        })\n        .then((txHash: string) => resolve(txHash))\n        .catch((error: Error) => reject(error));\n    });\n  };\n\n  // Event Handlers\n  const initConnectHandler = () => {\n    if (!connector) {\n      return;\n    }\n\n    connector.on('connect', async (error, payload: ConnectEvent) => {\n      if (error) {\n        throw error;\n      }\n\n      const address = payload.params[0].accounts[0];\n      setAddress(address);\n      setPeerMeta(payload.params[0].peerMeta);\n    });\n  };\n\n  const initDisconnectHandler = () => {\n    if (!connector) {\n      return;\n    }\n\n    connector.on('disconnect', (error, _payload) => {\n      if (error) {\n        throw error;\n      }\n\n      setAddress(null);\n      setPeerMeta(null);\n      resetWallet();\n    });\n  };\n\n  const initSessionUpdateHandler = () => {\n    if (!connector) {\n      return;\n    }\n\n    connector.on('session_update', (error, payload) => {\n      if (error) {\n        throw error;\n      }\n\n      disconnect();\n    });\n  };\n\n  const initModalClosedHandler = () => {\n    if (!connector) {\n      return;\n    }\n\n    connector.on('modal_closed', () => {\n      resetWallet();\n      resetConnector();\n    });\n  };\n\n  // Init and clean up\n  useEffect(() => {\n    if (!connector) {\n      return;\n    }\n\n    initConnectHandler();\n    initDisconnectHandler();\n    initSessionUpdateHandler();\n    initModalClosedHandler();\n\n    return () => {\n      // Clean up listeners\n      connector.off('connect');\n      connector.off('disconnect');\n      connector.off('session_update');\n      connector.off('modal_closed');\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [connector]);\n\n  return {\n    address,\n    authenticate,\n    connect,\n    connector,\n    disconnect,\n    isConnected,\n    peerIcon,\n    peerMeta,\n    resetConnector,\n    signTransaction,\n    sendTransaction,\n  };\n};\n","import { Image } from '@tlon/indigo-react';\nimport BridgeForm from 'form/BridgeForm';\nimport FormError from 'form/FormError';\nimport SubmitButton from 'form/SubmitButton';\nimport { Grid, Text as LegacyText } from 'indigo-react';\nimport { WALLET_TYPES } from 'lib/constants';\nimport useLoginView from 'lib/useLoginView';\nimport { useWalletConnect } from 'lib/useWalletConnect';\nimport { abbreviateAddress } from 'lib/utils/address';\nimport { ForwardButton, RestartButton } from 'components/Buttons';\n\nconst WalletConnectLogin = ({ className, goHome }) => {\n  useLoginView(WALLET_TYPES.WALLET_CONNECT);\n\n  const {\n    address,\n    authenticate,\n    connect,\n    connector,\n    disconnect,\n    isConnected,\n    peerIcon,\n    peerMeta,\n  } = useWalletConnect();\n\n  const onSubmit = async () => {\n    await authenticate();\n    return;\n  };\n\n  return (\n    connector && (\n      <>\n        <Grid className={className}>\n          {!isConnected() && (\n            <Grid.Item full as={LegacyText} className=\"f6 gray4 mb3\">\n              Note that WalletConnect is a young protocol, not all wallets may\n              work fully\n            </Grid.Item>\n          )}\n\n          {isConnected() && peerMeta && (\n            <Grid.Item full className=\"f6 gray5 mt3 mb3\">\n              <Grid>\n                <Grid.Item style={{ gridArea: 'auto / 3 / auto / 5' }}>\n                  {peerIcon ? (\n                    <Image src={peerIcon} />\n                  ) : (\n                    <LegacyText>Icon Unavailable</LegacyText>\n                  )}\n                </Grid.Item>\n                <Grid.Item\n                  className={'flex-col align-center justify-center'}\n                  style={{ gridArea: 'auto / 6 / auto / 11' }}>\n                  <LegacyText as=\"div\">{peerMeta.name}</LegacyText>\n                  <LegacyText as=\"div\">\n                    {address ? abbreviateAddress(address) : null}\n                  </LegacyText>\n                  <RestartButton\n                    as=\"a\"\n                    className={'gray3'}\n                    onClick={disconnect}>\n                    disconnect\n                  </RestartButton>\n                </Grid.Item>\n              </Grid>\n            </Grid.Item>\n          )}\n\n          <BridgeForm onSubmit={onSubmit} afterSubmit={goHome}>\n            {({ handleSubmit, submitting }) => (\n              <>\n                {isConnected() ? (\n                  <>\n                    <Grid.Item full as={FormError} />\n\n                    <Grid.Item\n                      full\n                      as={SubmitButton}\n                      handleSubmit={handleSubmit}>\n                      {submitting\n                        ? 'Please check your WalletConnect wallet'\n                        : 'Authenticate'}\n                    </Grid.Item>\n                  </>\n                ) : (\n                  <>\n                    <Grid.Item full as={ForwardButton} solid onClick={connect}>\n                      {'Connect'}\n                    </Grid.Item>\n                  </>\n                )}\n              </>\n            )}\n          </BridgeForm>\n        </Grid>\n      </>\n    )\n  );\n};\n\nexport default WalletConnectLogin;\n","import React, { useState, useMemo } from 'react';\nimport { Grid } from 'indigo-react';\n\nimport useBreakpoints from 'lib/useBreakpoints';\n\nimport Accordion from 'components/Accordion';\n\nimport PrivateKey from './PrivateKey';\nimport Keystore from './Keystore';\nimport Ledger from './Ledger';\nimport Metamask from './Metamask';\nimport Trezor from './Trezor';\nimport Mnemonic from './Mnemonic';\nimport WalletConnect from './WalletConnect';\n\nconst NAMES = {\n  PRIVATE_KEY: 'PRIVATE_KEY',\n  KEYSTORE: 'KEYSTORE',\n  LEDGER: 'LEDGER',\n  TREZOR: 'TREZOR',\n  METAMASK: 'METAMASK',\n  MNEMONIC: 'MNEMONIC',\n  WALLET_CONNECT: 'WALLET_CONNECT',\n};\n\nconst VIEWS = {\n  [NAMES.PRIVATE_KEY]: PrivateKey,\n  [NAMES.KEYSTORE]: Keystore,\n  [NAMES.LEDGER]: Ledger,\n  [NAMES.TREZOR]: Trezor,\n  [NAMES.METAMASK]: Metamask,\n  [NAMES.MNEMONIC]: Mnemonic,\n  [NAMES.WALLET_CONNECT]: WalletConnect,\n};\n\nconst OPTIONS = [\n  { text: 'Metamask', value: NAMES.METAMASK },\n  { text: 'Mnemonic (BIP 39)', value: NAMES.MNEMONIC },\n  { text: 'Ledger', value: NAMES.LEDGER },\n  { text: 'Trezor', value: NAMES.TREZOR },\n  { text: 'Ethereum Private Key', value: NAMES.PRIVATE_KEY },\n  { text: 'Ethereum Keystore', value: NAMES.KEYSTORE },\n  { text: 'WalletConnect', value: NAMES.WALLET_CONNECT },\n];\n\nconst isHardware = name => !![NAMES.TREZOR, NAMES.LEDGER].find(n => n === name);\n\nexport default function Other({ className, ...rest }) {\n  const [currentTab, setCurrentTab] = useState(undefined);\n\n  const hardwareAllowed = useBreakpoints([false, true, true]);\n  const options = useMemo(\n    () =>\n      OPTIONS.map(o =>\n        !isHardware(o.value)\n          ? o\n          : { ...o, disabled: !hardwareAllowed && ' not available on mobile' }\n      ),\n    [hardwareAllowed]\n  );\n  return (\n    <>\n      <Grid.Divider />\n      <Accordion\n        className={className}\n        views={VIEWS}\n        options={options}\n        currentTab={currentTab}\n        onTabChange={setCurrentTab}\n        //\n        {...rest}\n      />\n    </>\n  );\n}\n","import React, { useCallback, useMemo } from 'react';\nimport { Just } from 'folktale/maybe';\nimport { Text, Grid } from 'indigo-react';\nimport * as keythereum from 'keythereum';\n\nimport { useWallet } from 'store/wallet';\n\nimport { EthereumWallet } from 'lib/wallet';\nimport { WALLET_TYPES } from 'lib/constants';\nimport useLoginView from 'lib/useLoginView';\n\nimport { PassphraseInput } from 'form/Inputs';\nimport {\n  composeValidator,\n  buildPassphraseValidator,\n  buildUploadValidator,\n} from 'form/validators';\nimport UploadInput from 'form/UploadInput';\nimport SubmitButton from 'form/SubmitButton';\nimport BridgeForm from 'form/BridgeForm';\nimport { FORM_ERROR } from 'final-form';\nimport FormError from 'form/FormError';\n\nexport default function Keystore({ className, goHome }) {\n  useLoginView(WALLET_TYPES.KEYSTORE);\n\n  // globals\n  const { setWallet } = useWallet();\n\n  const validate = useMemo(\n    () =>\n      composeValidator({\n        passphrase: buildPassphraseValidator(),\n        keystore: buildUploadValidator(),\n      }),\n    []\n  );\n\n  const onSubmit = useCallback(\n    async values => {\n      try {\n        const json = JSON.parse(values.keystore);\n        const privateKey = keythereum.recover(values.passphrase, json);\n\n        const wallet = new EthereumWallet(privateKey);\n        setWallet(Just(wallet));\n      } catch (error) {\n        console.error(error);\n        return {\n          [FORM_ERROR]:\n            \"Couldn't decrypt wallet. You may have entered an incorrect password.\",\n        };\n      }\n    },\n    [setWallet]\n  );\n\n  return (\n    <Grid className={className}>\n      <Grid.Item full as={Text} className=\"f6 gray4 mb3\">\n        Please upload your Ethereum keystore file. If your keystore file is\n        encrypted with a password, you'll also need to enter that below.\n      </Grid.Item>\n\n      <BridgeForm validate={validate} onSubmit={onSubmit} afterSubmit={goHome}>\n        {({ handleSubmit }) => (\n          <>\n            <Grid.Item\n              full\n              as={UploadInput}\n              name=\"keystore\"\n              label=\"Upload Keystore file\"\n            />\n\n            <Grid.Item\n              full\n              as={PassphraseInput}\n              className=\"mt3\"\n              name=\"passphrase\"\n              label=\"Passphrase\"\n            />\n\n            <Grid.Item full as={FormError} />\n\n            <Grid.Item full as={SubmitButton} handleSubmit={handleSubmit}>\n              Decrypt\n            </Grid.Item>\n          </>\n        )}\n      </BridgeForm>\n    </Grid>\n  );\n}\n","import React, { useCallback, useState, useMemo } from 'react';\nimport cn from 'classnames';\nimport { Just, Nothing } from 'folktale/maybe';\nimport { Grid, CheckboxInput } from 'indigo-react';\n\nimport { useWallet } from 'store/wallet';\n\nimport { walletFromMnemonic } from 'lib/wallet';\nimport { DEFAULT_HD_PATH, WALLET_TYPES } from 'lib/constants';\nimport useLoginView from 'lib/useLoginView';\nimport { MnemonicInput, HdPathInput, PassphraseInput } from 'form/Inputs';\nimport {\n  composeValidator,\n  buildAnyMnemonicValidator,\n  buildMnemonicValidator,\n  buildCheckboxValidator,\n  buildPassphraseValidator,\n  buildHdPathValidator,\n} from 'form/validators';\nimport BridgeForm from 'form/BridgeForm';\nimport Condition from 'form/Condition';\nimport FormError from 'form/FormError';\nimport SubmitButton from 'form/SubmitButton';\n\nexport default function Mnemonic({ className, goHome }) {\n  useLoginView(WALLET_TYPES.MNEMONIC);\n\n  const { setWallet, setAuthMnemonic, setWalletHdPath } = useWallet();\n\n  const [anyMnemonic, setAnyMnemonic] = useState(false);\n\n  const validate = useMemo(() => {\n    const mnemonicValidator = anyMnemonic\n      ? buildAnyMnemonicValidator()\n      : buildMnemonicValidator();\n    return composeValidator({\n      useAdvanced: buildCheckboxValidator(),\n      mnemonic: mnemonicValidator,\n      passphrase: buildPassphraseValidator(),\n      hdpath: buildHdPathValidator(),\n    });\n  }, [anyMnemonic]);\n\n  // when the properties change, re-derive wallet and set global state\n  const onValues = useCallback(\n    ({ valid, values }) => {\n      setAnyMnemonic(values.anyMnemonic);\n      if (valid) {\n        setWalletHdPath(values.hdpath);\n        setAuthMnemonic(Just(values.mnemonic));\n        setWallet(\n          walletFromMnemonic(\n            values.mnemonic,\n            values.hdpath,\n            values.passphrase,\n            values.anyMnemonic\n          )\n        );\n      } else {\n        setAuthMnemonic(Nothing());\n        setWallet(Nothing());\n      }\n    },\n    [setAuthMnemonic, setWallet, setWalletHdPath]\n  );\n\n  const initialValues = {\n    hdpath: DEFAULT_HD_PATH,\n    useAdvanced: false,\n    anyMnemonic: false,\n  };\n\n  return (\n    <Grid className={cn('mt4', className)}>\n      <BridgeForm\n        validate={validate}\n        onValues={onValues}\n        afterSubmit={goHome}\n        initialValues={initialValues}>\n        {({ handleSubmit }) => (\n          <>\n            <Grid.Item\n              full\n              as={MnemonicInput}\n              name=\"mnemonic\"\n              label=\"BIP39 Mnemonic\"\n            />\n\n            <Grid.Item\n              full\n              as={CheckboxInput}\n              name=\"anyMnemonic\"\n              label=\"Skip mnemonic validation\"\n            />\n\n            <Condition when=\"useAdvanced\" is={true}>\n              <Grid.Item\n                full\n                as={PassphraseInput}\n                name=\"passphrase\"\n                label=\"Passphrase\"\n              />\n\n              <Grid.Item full as={HdPathInput} name=\"hdpath\" label=\"HD Path\" />\n            </Condition>\n\n            <Grid.Item\n              full\n              as={CheckboxInput}\n              name=\"useAdvanced\"\n              label=\"Passphrase & HD Path\"\n            />\n\n            <Grid.Item full as={FormError} />\n\n            <Grid.Item full as={SubmitButton} handleSubmit={handleSubmit}>\n              Login\n            </Grid.Item>\n          </>\n        )}\n      </BridgeForm>\n    </Grid>\n  );\n}\n","import React from 'react';\nimport cn from 'classnames';\nimport { H5 } from 'indigo-react';\n\nexport default function ViewHeader({ children, className }) {\n  return <H5 className={cn(className, 'mb4')}>{children}</H5>;\n}\n","// /lib/tank: functions for funding transactions\n\nimport retry from 'async-retry';\nimport { toBN } from 'web3-utils';\nimport { RETRY_OPTIONS, waitForTransactionConfirm } from './txn';\nimport { isRopsten } from './flags';\n\nconst TANK_ADDRESS = '0x40f0A6db85f8D7A54fF3eA915b040dE8Cd4A0Eb5';\n\n//NOTE if accessing this in a localhost configuration fails with \"CORS request\n//     did not succeed\", you might need to visit localhost:3001 or whatever\n//     explicitly and tell your browser that's safe to access.\n//     https://stackoverflow.com/a/53011185/1334324\nconst port = isRopsten ? '3011' : '3001';\nconst baseUrl = `https://gas-tank.urbit.org:${port}`;\n\nfunction sendRequest(where, what) {\n  return new Promise((resolve, reject) => {\n    fetch(baseUrl + where, {\n      method: 'POST',\n      cache: 'no-cache',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(what),\n    })\n      .then(response => {\n        if (response.ok) {\n          resolve(response.json());\n        } else {\n          reject(response);\n        }\n      })\n      .catch(reject);\n  });\n}\n\nconst remainingTransactions = point => {\n  if (typeof point === 'string') point = Number(point);\n  return sendRequest('/point', { point: point });\n};\n\nconst fundTransactions = signedTxs => {\n  return sendRequest('/request', { txs: signedTxs });\n};\n\n// resolves when address has at least cost balance\n// returns true if gas tank was used, false otherwise\n// askForFunding: callback that takes (address, requiredBalance, currentBalance)\n//                and tells the user to get that address the required balance\n// gotFunding: optional callback that stops telling the user to go get funding\nconst ensureFundsFor = async (\n  web3,\n  point,\n  address,\n  walletType,\n  cost,\n  signedTxs,\n  askForFunding,\n  gotFunding\n) => {\n  if (typeof signedTxs !== 'object' || signedTxs.length === 0) {\n    throw new Error('tank: no transactions provided!');\n  }\n\n  //TODO  this depends on FakeSignResult serialization in a somewhat ugly way\n  if (signedTxs.some(tx => tx === '0x???')) {\n    console.log('tank: disabling for unsigned sender wallet');\n    return false;\n  }\n\n  const balance = toBN(await web3.eth.getBalance(address));\n  cost = toBN(cost);\n\n  if (balance.gte(cost)) {\n    console.log(\n      `tank: already have sufficient funds: ${address} proposed ` +\n        `transaction(s) that will cost ${cost.toString()}wei but it ` +\n        `already has ${balance.toString()}wei`\n    );\n    return false;\n  }\n\n  try {\n    // TODO: if we can't always (easily) provide a point, and the\n    // fundTransactions call is gonna fail anyway, should we maybe\n    // just not bother doing this check in the first place?\n    if (point !== null) {\n      const fundsRemaining = await remainingTransactions(point);\n      if (fundsRemaining < signedTxs.length) {\n        throw new Error('tank: request invalid');\n      }\n    } else {\n      console.log('tank: no point provided. skipping remaining-funds check...');\n    }\n\n    const res = await fundTransactions(signedTxs);\n    if (!res.success) {\n      throw new Error(`tank: request rejected ${JSON.stringify(res)}`);\n    }\n\n    await waitForTransactionConfirm(web3, res.txHash);\n\n    const newBalance = toBN(await web3.eth.getBalance(address));\n\n    // sanity check\n    if (newBalance.lt(cost)) {\n      throw new Error(\n        `tank: transaction funded but the new balance of ` +\n          `${newBalance.toString()}wei is still less than ` +\n          `${cost.toString()}wei.`\n      );\n    }\n\n    console.log(\n      `tank: funds have confirmed: ${address} now has ` +\n        `${newBalance.toString()}wei, up from ${balance.toString()}wei`\n    );\n    return true;\n  } catch (error) {\n    console.error(error);\n    await waitForBalance(\n      web3,\n      address,\n      cost.toString(),\n      askForFunding,\n      gotFunding\n    );\n  }\n\n  return false;\n};\n\n// returns a promise that resolves when address has at least minBalance\nfunction waitForBalance(web3, address, minBalance, askForFunding, gotFunding) {\n  minBalance = toBN(minBalance);\n  return retry(async (bail, n) => {\n    const balance = toBN(await web3.eth.getBalance(address));\n    if (balance.gte(minBalance)) {\n      gotFunding && gotFunding();\n      return;\n    } else {\n      askForFunding(address, minBalance.toString(), balance);\n      throw new Error('retrying');\n    }\n  }, RETRY_OPTIONS);\n}\n\nexport {\n  TANK_ADDRESS,\n  remainingTransactions,\n  fundTransactions,\n  ensureFundsFor,\n};\n","import { useRef } from 'react';\n\nexport default function usePreviousValue(value) {\n  const prev = useRef(null);\n  const curr = useRef(null);\n\n  if (prev.current !== curr.current) {\n    prev.current = curr.current;\n  }\n\n  if (curr.current !== value) {\n    curr.current = value;\n  }\n\n  return prev.current;\n}\n","import { useRef } from 'react';\nimport { isEqual } from 'lodash';\n\nimport usePreviousValue from './usePreviousValue';\n\n// changes the referential identity of value on deep equality change\nexport default function useDeepEqualReference(value) {\n  const ref = useRef(value);\n\n  // track the old value of the config set\n  const prevValue = usePreviousValue(value);\n\n  // then compare equality\n  const areEqual = isEqual(value, prevValue);\n\n  // if equality changes, give value a new identity\n  if (!areEqual) {\n    ref.current = value;\n  }\n\n  return ref.current;\n}\n","import { NETWORK_TYPES } from './network';\nimport { DEFAULT_GAS_PRICE_GWEI, MAX_GAS_PRICE_GWEI } from './constants';\n\nexport default async function getSuggestedGasPrice(networkType) {\n  switch (networkType) {\n    case NETWORK_TYPES.ROPSTEN:\n      return 10;\n    case NETWORK_TYPES.OFFLINE:\n      return DEFAULT_GAS_PRICE_GWEI;\n    case NETWORK_TYPES.LOCAL:\n    default:\n      try {\n        const response = await fetch(\n          'https://api.etherscan.io/api' +\n            '?module=gastracker' +\n            '&action=gasoracle' +\n            '&apikey=CG52E4R96W56GIKUI4IJ8CH9EZIXPUW1W8',\n          {\n            method: 'GET',\n            cache: 'no-cache',\n          }\n        );\n\n        const json = await response.json();\n\n        if (json && json.status !== '1') {\n          console.warn('suggested gas price warning', json.message);\n        }\n\n        const suggestedGasPrice = parseInt(\n          json && json.result && json.result.ProposeGasPrice\n        );\n        if (isNaN(suggestedGasPrice)) {\n          throw new Error('strange gas price response', json);\n        }\n\n        // safeguard against obscene suggestions\n        return Math.min(suggestedGasPrice, MAX_GAS_PRICE_GWEI);\n      } catch (e) {\n        console.warn('error fetching gas price', e);\n        return DEFAULT_GAS_PRICE_GWEI;\n      }\n  }\n}\n","import { useCallback, useEffect, useState } from 'react';\n\nimport { useNetwork } from 'store/network';\n\nimport getSuggestedGasPrice from 'lib/getSuggestedGasPrice';\nimport { DEFAULT_GAS_PRICE_GWEI } from './constants';\n\n/**\n * handles all of the state of components that manage gas prices\n * + simple get/set\n * + lazy fetching optimal gas from oracle\n * + resetting to oracle (or sync) default\n * @param {Number} initialGasPrice the initial gas price available instantly\n */\nexport default function useGasPrice(initialGasPrice = DEFAULT_GAS_PRICE_GWEI) {\n  const { networkType } = useNetwork();\n  const [suggestedGasPrice, setSuggestedGasPrice] = useState(initialGasPrice); // gwei\n  const [gasPrice, setGasPrice] = useState(initialGasPrice); // gwei\n\n  useEffect(() => {\n    let mounted = true;\n\n    (async () => {\n      const suggestedGasPrice = await getSuggestedGasPrice(networkType);\n\n      if (!mounted) {\n        return;\n      }\n\n      // TODO: BN\n      setSuggestedGasPrice(suggestedGasPrice);\n      setGasPrice(suggestedGasPrice);\n    })();\n\n    return () => (mounted = true);\n  }, [networkType]);\n\n  const resetGasPrice = useCallback(() => setGasPrice(suggestedGasPrice), [\n    suggestedGasPrice,\n  ]);\n\n  return {\n    suggestedGasPrice,\n    gasPrice,\n    setGasPrice,\n    resetGasPrice,\n  };\n}\n","var _path;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgInfo(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 12,\n    height: 12,\n    viewBox: \"0 0 12 12\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M6 -5.24537e-07C2.68503 -8.1434e-07 8.1434e-07 2.68503 5.24537e-07 6C2.34733e-07 9.31497 2.68503 12 6 12C9.31497 12 12 9.31497 12 6C12 2.68503 9.31497 -2.34733e-07 6 -5.24537e-07ZM6 0.723491C8.91892 0.723491 11.2765 3.08732 11.2765 6C11.2765 8.91892 8.91892 11.2765 6 11.2765C3.08108 11.2765 0.723492 8.91892 0.723492 6C0.723492 3.08732 3.08108 0.723491 6 0.723491ZM5.57588 9.19335L6.42412 9.19335L6.42 5.22L5.58 5.22L5.57588 9.19335ZM6 2.75676C5.69127 2.75676 5.43867 3.00935 5.43867 3.31809C5.43867 3.62682 5.69127 3.87942 6 3.87942C6.30873 3.87942 6.56133 3.62682 6.56133 3.31809C6.56133 3.00936 6.30873 2.75676 6 2.75676Z\",\n    fill: \"#B1B2B3\"\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgInfo);\nexport default __webpack_public_path__ + \"static/media/info.ac96d476.svg\";\nexport { ForwardRef as ReactComponent };","import { useCallback, useEffect, useState } from 'react';\nimport { Just } from 'folktale/maybe';\nimport { toBN } from 'web3-utils';\n\nimport { useNetwork } from 'store/network';\nimport { useWallet } from 'store/wallet';\nimport { usePointCursor } from 'store/pointCursor';\n\nimport {\n  GAS_LIMITS,\n  DEFAULT_GAS_PRICE_GWEI,\n  PROGRESS_ANIMATION_DELAY_MS,\n  WALLET_TYPES,\n} from './constants';\nimport {\n  signTransaction,\n  sendSignedTransaction,\n  waitForTransactionConfirm,\n  hexify,\n} from './txn';\nimport * as need from 'lib/need';\nimport { ensureFundsFor } from 'lib/tank';\nimport useDeepEqualReference from 'lib/useDeepEqualReference';\nimport useGasPrice from 'lib/useGasPrice';\nimport { timeout } from 'lib/timeout';\nimport { safeToWei, safeFromWei } from 'lib/lib';\nimport { useWalletConnect } from './useWalletConnect';\nimport { Transaction } from '@ethereumjs/tx';\n\nconst STATE = {\n  NONE: 'NONE',\n  SIGNED: 'SIGNED',\n  FAKE_SIGNED: 'FAKE_SIGNED',\n  BROADCASTED: 'BROADCASTED',\n  CONFIRMED: 'CONFIRMED',\n  COMPLETED: 'COMPLETED',\n};\n\n/**\n * manage the state around sending and confirming an ethereum transaction\n * @param {Transaction Function()} transactionBuilder\n * @param {Promise<any> Function()} refetch async function called after completion\n * @param {number} initialGasLimit gas limit\n * @param {number} initialGasPrice gas price in gwei\n */\nexport default function useEthereumTransaction(\n  transactionBuilder,\n  refetch,\n  initialGasLimit = GAS_LIMITS.DEFAULT,\n  initialGasPrice = DEFAULT_GAS_PRICE_GWEI\n) {\n  const { wallet, walletType, walletHdPath } = useWallet();\n  const { web3, networkType } = useNetwork();\n  const { pointCursor } = usePointCursor();\n  const {\n    signTransaction: wcSign,\n    sendTransaction: wcSend,\n  } = useWalletConnect();\n\n  const _web3 = need.web3(web3);\n  const _wallet = need.wallet(wallet);\n\n  const [error, _setError] = useState();\n  const setError = useCallback(\n    error => {\n      _setError(error);\n      if (error) {\n        console.error(error);\n      }\n    },\n    [_setError]\n  );\n  const [state, setState] = useState(STATE.NONE);\n  const [chainId, setChainId] = useState();\n  const [nonce, setNonce] = useState();\n  const { gasPrice, setGasPrice, resetGasPrice } = useGasPrice(initialGasPrice);\n  const [gasLimit] = useState(initialGasLimit);\n  const [unsignedTransactions, setUnsignedTransactions] = useState();\n  const [signedTransactions, setSignedTransactions] = useState();\n  const [txHashes, setTxHashes] = useState();\n  const [needFunds, setNeedFunds] = useState();\n  const [confirmationProgress, setConfirmationProgress] = useState(0.0);\n\n  const [finalCost, setFinalCost] = useState();\n\n  const initializing = nonce === undefined || chainId === undefined;\n  const constructed = !!unsignedTransactions;\n  const isDefaultState = state === STATE.NONE;\n  const signed = state === STATE.SIGNED || state === STATE.FAKE_SIGNED;\n  const fakeSigned = state === STATE.FAKE_SIGNED;\n  const broadcasted = state === STATE.BROADCASTED;\n  const confirmed = state === STATE.CONFIRMED;\n  const completed = state === STATE.COMPLETED;\n\n  // lock inputs once we're out of the default state\n  const inputsLocked = !isDefaultState;\n\n  // we can sign when:\n  const canSign = !initializing && constructed && isDefaultState;\n\n  const construct = useCallback(\n    async (...args) =>\n      setUnsignedTransactions(await transactionBuilder(...args)),\n    [transactionBuilder]\n  );\n\n  const unconstruct = useCallback(() => setUnsignedTransactions(undefined), [\n    setUnsignedTransactions,\n  ]);\n\n  const generateAndSign = useCallback(async () => {\n    try {\n      setError(undefined);\n\n      const utxs = Array.isArray(unsignedTransactions)\n        ? unsignedTransactions\n        : [unsignedTransactions];\n\n      // Due to React's Rules of Hooks, optionally inject the\n      // WC transaction signing function\n      // https://reactjs.org/docs/hooks-rules.html\n      //TODO  this is duplicated across relevant callsites, should refactor\n      const txnSigner =\n        walletType === WALLET_TYPES.WALLET_CONNECT ? wcSign : undefined;\n      const txnSender =\n        walletType === WALLET_TYPES.WALLET_CONNECT ? wcSend : undefined;\n\n      const txns = await Promise.all(\n        utxs.map((utx, i) =>\n          signTransaction({\n            wallet: _wallet,\n            walletType,\n            walletHdPath,\n            networkType,\n            txn: utx,\n            nonce: nonce + i,\n            chainId,\n            gasPrice: gasPrice.toFixed(0),\n            gasLimit,\n            txnSigner,\n            txnSender,\n          })\n        )\n      );\n\n      setSignedTransactions(txns);\n\n      // Per return type of `signTransaction`, tx is either a Transaction or FakeSignedTx.\n      // We check the negation in this case, since TS cannot perform run-time check of type\n      // FakeSignedTx, but it can check for an instance of the ethereumjs/tx class.\n      if (txns.some(tx => !(tx instanceof Transaction))) {\n        setState(STATE.FAKE_SIGNED);\n      } else {\n        setState(STATE.SIGNED);\n      }\n    } catch (error) {\n      console.error('error signing txs', error);\n      setError(error);\n    }\n  }, [\n    _wallet,\n    chainId,\n    gasLimit,\n    gasPrice,\n    networkType,\n    nonce,\n    setError,\n    unsignedTransactions,\n    walletHdPath,\n    walletType,\n    wcSign,\n    wcSend,\n  ]);\n\n  const broadcast = useCallback(async () => {\n    try {\n      setConfirmationProgress(0.0);\n      setError(undefined);\n      setState(STATE.BROADCASTED);\n\n      const rawTxs = signedTransactions.map(stx => hexify(stx.serialize()));\n\n      const costGwei = toBN(gasLimit)\n        .mul(toBN(gasPrice))\n        .mul(toBN(rawTxs.length));\n      const cost = safeToWei(costGwei, 'gwei');\n      let usedTank = false;\n      // if this ethereum transaction is being executed by a specific point\n      // see if we can use the tank\n      if (Just.hasInstance(pointCursor)) {\n        usedTank = await ensureFundsFor(\n          _web3,\n          pointCursor.value,\n          _wallet.address,\n          walletType,\n          cost,\n          rawTxs,\n          (address, minBalance, balance) =>\n            setNeedFunds({ address, minBalance, balance }),\n          () => setNeedFunds(undefined)\n        );\n      }\n\n      const txHashes = await signedTransactions.reduce(\n        (acc, stx) =>\n          acc.then(hashes =>\n            sendSignedTransaction(\n              _web3,\n              stx,\n              /* doubtNonceError */ usedTank\n            ).then(hash => [...hashes, hash])\n          ),\n        Promise.resolve([])\n      );\n\n      setTxHashes(txHashes);\n\n      await timeout(PROGRESS_ANIMATION_DELAY_MS);\n\n      setConfirmationProgress(0.2);\n\n      const receipts = await Promise.all(\n        txHashes.map(txHash => waitForTransactionConfirm(_web3, txHash))\n      );\n\n      setFinalCost(\n        safeFromWei(\n          safeToWei(\n            receipts.reduce(\n              (acc, receipt) =>\n                toBN(receipt.gasUsed)\n                  .mul(toBN(gasPrice))\n                  .add(acc),\n              toBN(0)\n            ),\n            'gwei'\n          ),\n          'ether'\n        )\n      );\n\n      setConfirmationProgress(0.9);\n\n      setState(STATE.CONFIRMED);\n    } catch (error) {\n      setError(error);\n    }\n  }, [\n    _wallet.address,\n    _web3,\n    gasLimit,\n    gasPrice,\n    pointCursor,\n    setError,\n    signedTransactions,\n    walletType,\n  ]);\n\n  const reset = useCallback(() => {\n    setTxHashes(undefined);\n    setSignedTransactions(undefined);\n    setNonce(undefined);\n    setChainId(undefined);\n    resetGasPrice();\n    setState(STATE.NONE);\n    setError(undefined);\n    setNeedFunds(undefined);\n    setConfirmationProgress(0.0);\n    setFinalCost(undefined);\n  }, [resetGasPrice, setError]);\n\n  useEffect(() => {\n    let mounted = true;\n    // if nonce or chainId is undefined, re-fetch on-chain info\n    if (!(nonce === undefined || chainId === undefined)) {\n      return;\n    }\n\n    (async () => {\n      try {\n        setError(undefined);\n        const [nonce, chainId] = await Promise.all([\n          _web3.eth.getTransactionCount(_wallet.address),\n          _web3.eth.net.getId(),\n        ]);\n\n        if (!mounted) {\n          return;\n        }\n\n        setNonce(nonce);\n        setChainId(chainId);\n      } catch (error) {\n        setError(error);\n      }\n    })();\n\n    return () => (mounted = false);\n  }, [_wallet, _web3, setError, nonce, chainId, networkType, initialGasPrice]);\n\n  useEffect(() => {\n    let mounted = true;\n\n    if (confirmed) {\n      (async () => {\n        if (refetch) {\n          try {\n            await refetch();\n          } catch (error) {\n            // log the original\n            console.error(error);\n            // track a user-friendly error\n            setError(\n              new Error(\n                'The transaction succeeded but we were unable to refresh chain state. Refresh to continue.'\n              )\n            );\n          }\n        }\n\n        if (!mounted) {\n          return;\n        }\n\n        setConfirmationProgress(1.0);\n\n        await timeout(PROGRESS_ANIMATION_DELAY_MS);\n\n        if (!mounted) {\n          return;\n        }\n\n        setState(STATE.COMPLETED);\n      })();\n    }\n\n    return () => (mounted = false);\n  }, [confirmed, refetch, completed, setError]);\n\n  const values = useDeepEqualReference({\n    isDefaultState,\n    initializing,\n    construct,\n    unconstruct,\n    constructed,\n    canSign,\n    generateAndSign,\n    signed,\n    fakeSigned,\n    broadcast,\n    broadcasted,\n    confirmed,\n    completed,\n    reset,\n    error,\n    inputsLocked,\n    confirmationProgress,\n    txHashes,\n    signedTransactions,\n    gasPrice,\n    setGasPrice,\n    resetGasPrice,\n    nonce,\n    chainId,\n    needFunds,\n    gasLimit,\n    unsignedTransactions,\n    finalCost,\n  });\n\n  return { ...values, bind: values };\n}\n","import { useNetwork } from 'store/network';\nimport { NETWORK_TYPES } from './network';\n\nfunction useEtherscanDomain() {\n  const { networkType } = useNetwork();\n\n  switch (networkType) {\n    case NETWORK_TYPES.ROPSTEN:\n      return 'https://ropsten.etherscan.io';\n    case NETWORK_TYPES.OFFLINE:\n    case NETWORK_TYPES.MAINNET:\n    case NETWORK_TYPES.LOCAL:\n    default:\n      return 'https://etherscan.io';\n  }\n}\n\nexport function useExploreTxUrl(txHash) {\n  const domain = useEtherscanDomain();\n\n  return `${domain}/tx/${txHash}`;\n}\nexport function useExploreTxUrls(txHashes = []) {\n  const domain = useEtherscanDomain();\n\n  return txHashes.map(txHash => `${domain}/tx/${txHash}`);\n}\n\nexport function useExploreAddressUrl(address) {\n  const domain = useEtherscanDomain();\n\n  return `${domain}/address/${address}`;\n}\n","import { useState, useEffect, useRef, useCallback } from 'react';\nimport copy from 'copy-to-clipboard';\n\nconst COPY_DELAY = 2 * 1000; // ms\n\nexport default function useCopiable(text) {\n  const [didCopy, setDidCopy] = useState(false);\n\n  // what we really want here is a useDebouncedCallback from use-debounced\n  // but that's a relatively large dep for a single simple usage so ¯\\_(ツ)_/¯\n  const listener = useRef(); // <NodeJS.Listener>\n  useEffect(() => () => clearTimeout(listener.current), []);\n\n  const doCopy = useCallback(() => {\n    copy(text);\n    setDidCopy(true);\n\n    clearTimeout(listener.current);\n    listener.current = setTimeout(() => setDidCopy(false), COPY_DELAY);\n  }, [text]);\n\n  return [doCopy, didCopy];\n}\n","import React from 'react';\nimport cn from 'classnames';\nimport { LinkButton } from 'indigo-react';\n\nimport useCopiable from 'lib/useCopiable';\n\nconst renderDefaultCopyText = didCopy => (didCopy ? 'Copied!' : 'Copy');\n\nexport default function CopyButton({\n  as: As = LinkButton,\n  text,\n  children = renderDefaultCopyText,\n  className,\n  ...rest\n}) {\n  const [doCopy, didCopy] = useCopiable(text);\n\n  return (\n    <As\n      onClick={doCopy}\n      className={cn(className, {\n        black: !didCopy,\n        green3: didCopy,\n      })}\n      {...rest}>\n      {children(didCopy)}\n    </As>\n  );\n}\n","import React from 'react';\nimport cn from 'classnames';\nimport { Button } from 'indigo-react';\nimport { blinkIf } from './Blinky';\n\nexport default function ProgressButton({\n  as: As = Button,\n  progress = 0.0,\n  color = 'green4',\n  ...rest\n}) {\n  return (\n    <As\n      {...rest}\n      solid\n      accessory={blinkIf(progress < 1.0, '->')}\n      background={\n        <span\n          className={cn('abs z1 animated-width', `bg-${color}`)}\n          style={{\n            left: 0,\n            top: 0,\n            right: 0,\n            bottom: 0,\n            width: `${progress * 100.0}%`,\n          }}></span>\n      }\n    />\n  );\n}\n","var _path;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgCopy(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 16,\n    height: 16,\n    viewBox: \"0 0 16 16\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    clipRule: \"evenodd\",\n    d: \"M9 3H4V10H6V6V5H7H9V3ZM10 5H12H13V6V13V14H12H7H6V13V11H4H3V10V3V2H4H9H10V3V5ZM7 6H12V13H7V6Z\",\n    fill: \"black\"\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgCopy);\nexport default __webpack_public_path__ + \"static/media/copy.bae07828.svg\";\nexport { ForwardRef as ReactComponent };","import React from 'react';\nimport cn from 'classnames';\n\nexport default function Highlighted({\n  as: As = 'span',\n  className,\n  warning = false,\n  ...rest\n}) {\n  return (\n    <As\n      className={cn(\n        {\n          red3: warning,\n          green3: !warning,\n        },\n        className\n      )}\n      {...rest}\n    />\n  );\n}\n","import React, { useState, useCallback } from 'react';\nimport { useMemo } from 'react';\n\nexport enum TooltipPosition {\n  Top,\n  TopRight,\n  // Add more as necessary here and in #positionStyle\n}\n\ntype WithTooltipArgs = {\n  content: string;\n  children: React.ReactNode;\n  className?: string | undefined;\n  position?: TooltipPosition;\n};\n\nexport default function WithTooltip({\n  content,\n  children,\n  className,\n  position = TooltipPosition.Top,\n}: WithTooltipArgs) {\n  const [isHovered, setHovered] = useState(false);\n  const onMouseEnter = useCallback(() => setHovered(true), []);\n  const onMouseLeave = useCallback(() => setHovered(false), []);\n\n  const positionStyle = useMemo(() => {\n    switch (position) {\n      case TooltipPosition.Top:\n        return { bottom: '100%' };\n      case TooltipPosition.TopRight:\n        return { bottom: '90%', left: '90%' };\n      default:\n        return { bottom: '100%' };\n    }\n  }, [position]);\n\n  return (\n    <div\n      className={className || 'rel nowrap inline-block'}\n      onMouseEnter={onMouseEnter}\n      onMouseLeave={onMouseLeave}>\n      {children}\n      {isHovered && (\n        <div\n          className=\"abs mb1 bg-black white ph4 pv2 r4 open-tooltip\"\n          style={positionStyle}>\n          {content}\n        </div>\n      )}\n    </div>\n  );\n}\n","import React from 'react';\nimport { ReactComponent as Copy } from 'assets/copy.svg';\n\nimport useCopiable from 'lib/useCopiable';\nimport WithTooltip from 'components/WithTooltip';\n\nexport default function CopiableWithTooltip({\n  as: As = 'span',\n  text,\n  children,\n  className,\n  ...rest\n}) {\n  const [doCopy, didCopy] = useCopiable(text || children);\n\n  return (\n    <As className={className} {...rest}>\n      {children}\n      <WithTooltip content={didCopy ? 'Copied!' : 'Copy'}>\n        <Copy\n          style={{ height: '1em', width: '1em' }}\n          className=\"ml1 pointer\"\n          onClick={doCopy}\n        />\n      </WithTooltip>\n    </As>\n  );\n}\n","import React from 'react';\nimport cn from 'classnames';\n\nimport CopiableWithTooltip from './CopiableWithTooltip';\n\nexport default function CopiableAddress({ className, ...rest }) {\n  return (\n    <CopiableWithTooltip\n      className={cn(className, 'mono', 'nowrap')}\n      {...rest}\n    />\n  );\n}\n","import React from 'react';\nimport { safeFromWei } from '../lib/lib';\n\nimport Highlighted from './Highlighted';\nimport CopiableAddress from './CopiableAddress';\nimport WarningBox from './WarningBox';\nimport Blinky from './Blinky';\n\nexport default function NeedFundsNotice({\n  address,\n  minBalance,\n  balance,\n  ...rest\n}) {\n  return (\n    <WarningBox {...rest}>\n      <Highlighted warning>\n        Your ownership address <CopiableAddress>{address}</CopiableAddress>{' '}\n        needs at least {safeFromWei(minBalance)} ETH and currently has{' '}\n        {safeFromWei(balance)} ETH. Transaction costs may be high due to{' '}\n        Ethereum network activity. You can come back later to try again, or{' '}\n        transfer the required ETH now. The transaction will automatically resume{' '}\n        once enough ETH is available. Waiting... <Blinky />\n      </Highlighted>\n    </WarningBox>\n  );\n}\n","import React from 'react';\nimport cn from 'classnames';\nimport { Flex, Text } from 'indigo-react';\n\nexport default function NoticeBox({ className, children }) {\n  return (\n    <Flex className={cn('bg-gray2 pv3 ph4', className)} align=\"center\">\n      <Text className=\"f6 fw-bold gray4\">{children}</Text>\n    </Flex>\n  );\n}\n","import React, { useMemo, useCallback, useState } from 'react';\nimport cn from 'classnames';\nimport {\n  Grid,\n  ToggleInput,\n  ErrorText,\n  Flex,\n  LinkButton,\n  H5,\n  Text,\n} from 'indigo-react';\nimport { toBN } from 'web3-utils';\n\nimport { ReactComponent as InfoIcon } from 'assets/info.svg';\n\nimport { useExploreTxUrls } from 'lib/explorer';\nimport { hexify } from 'lib/txn';\nimport { safeFromWei, safeToWei } from 'lib/lib';\n\nimport { composeValidator, buildCheckboxValidator } from 'form/validators';\nimport BridgeForm from 'form/BridgeForm';\nimport Condition from 'form/Condition';\n\nimport { GenerateButton, ForwardButton, RestartButton } from './Buttons';\nimport CopyButton from './CopyButton';\nimport ProgressButton from './ProgressButton';\nimport { convertToInt } from 'lib/convertToInt';\nimport NeedFundsNotice from './NeedFundsNotice';\nimport NoticeBox from './NoticeBox';\n\nexport default function InlineEthereumTransaction({\n  // from useEthereumTransaction.bind\n  initializing,\n  canSign,\n  generateAndSign,\n  signed,\n  fakeSigned,\n  broadcast,\n  broadcasted,\n  confirmed,\n  completed,\n  reset,\n  error,\n  gasPrice,\n  setGasPrice,\n  resetGasPrice,\n  txHashes,\n  nonce,\n  chainId,\n  needFunds,\n  signedTransactions,\n  confirmationProgress,\n  gasLimit,\n  unsignedTransactions,\n  finalCost,\n\n  // additional from parent\n  label = 'Generate & Sign Transaction',\n  className,\n  onReturn,\n}) {\n  // show receipt after successful broadcast\n  const [showReceipt, setShowReceipt] = useState(false);\n  const toggleShowReceipt = useCallback(() => setShowReceipt(!showReceipt), [\n    setShowReceipt,\n    showReceipt,\n  ]);\n  // show configure controls pre-broadcast\n  const showConfigureInput = !(signed || broadcasted || confirmed || completed);\n  // show the send/loading button while signed, broadcasting, or confirme\n  const showBroadcastButton = signed;\n  const showLoadingButton = broadcasted || confirmed;\n  const canBroadcast = signed && !needFunds;\n  // show signed tx only when signing (for offline usage)\n  const showSignedTx = signed;\n\n  const [showGasDetails, _setShowGasDetails] = useState(false);\n  const toggleGasDetails = useCallback(\n    () => _setShowGasDetails(!showGasDetails),\n    [_setShowGasDetails, showGasDetails]\n  );\n\n  const validate = useMemo(\n    () =>\n      composeValidator({\n        useAdvanced: buildCheckboxValidator(),\n        viewSigned: buildCheckboxValidator(),\n      }),\n    []\n  );\n\n  const onValues = useCallback(\n    ({ valid, values, form }) => {\n      if (!values.useAdvanced) {\n        resetGasPrice();\n      }\n    },\n    [resetGasPrice]\n  );\n\n  const renderPrimarySection = () => {\n    if (error) {\n      return (\n        <Grid.Item full as={RestartButton} solid onClick={() => reset()}>\n          Reset Transaction\n        </Grid.Item>\n      );\n    } else if (completed) {\n      return (\n        <>\n          <Grid.Divider />\n          <Grid.Item full as={RestartButton} onClick={onReturn}>\n            Return\n          </Grid.Item>\n          <Grid.Divider />\n          {showReceipt && (\n            <TransactionReceipt\n              txHashes={txHashes}\n              finalCost={finalCost}\n              onClose={toggleShowReceipt}\n            />\n          )}\n\n          {!showReceipt && (\n            <Grid.Item\n              className=\"underline mv2 pointer\"\n              full\n              onClick={toggleShowReceipt}>\n              View Receipt\n            </Grid.Item>\n          )}\n        </>\n      );\n    } else if (showBroadcastButton) {\n      return (\n        <Grid.Item\n          full\n          as={ForwardButton}\n          solid\n          success\n          disabled={!canBroadcast}\n          onClick={() => broadcast()}>\n          Send Transaction\n        </Grid.Item>\n      );\n    } else if (showLoadingButton) {\n      return (\n        <Grid.Item\n          full\n          as={ProgressButton}\n          success\n          disabled\n          progress={confirmationProgress}>\n          Sending Transaction\n        </Grid.Item>\n      );\n    } else {\n      return (\n        <Grid.Item\n          full\n          as={GenerateButton}\n          onClick={generateAndSign}\n          disabled={!canSign}\n          loading={!canSign && initializing}>\n          {label}\n        </Grid.Item>\n      );\n    }\n  };\n\n  const serializedTxsHex = useMemo(\n    () =>\n      signedTransactions &&\n      signedTransactions.map(stx => hexify(stx.serialize())),\n    [signedTransactions]\n  );\n\n  const numTxs = useMemo(() => (unsignedTransactions || []).length || 1, [\n    unsignedTransactions,\n  ]);\n  const maxCost = useMemo(\n    () =>\n      safeFromWei(\n        safeToWei(\n          toBN(gasLimit)\n            .mul(toBN(gasPrice))\n            .mul(toBN(numTxs)),\n          'gwei'\n        ),\n        'ether'\n      ),\n    [gasLimit, gasPrice, numTxs]\n  );\n\n  const gasInfo = useMemo(() => {\n    const extra = numTxs === 1 ? '' : `*  ${numTxs} txs`;\n    return showGasDetails\n      ? `${gasPrice} Gwei * ${gasLimit} ${extra} = ${maxCost} ETH`\n      : `${maxCost} ETH`;\n  }, [showGasDetails, maxCost, gasPrice, gasLimit, numTxs]);\n\n  return (\n    <Grid className={cn(className, 'mt1')}>\n      <BridgeForm validate={validate} onValues={onValues}>\n        {() => (\n          <>\n            {renderPrimarySection()}\n\n            {error && (\n              <Grid.Item full as={ErrorText} className=\"mv1\">\n                {error.message}\n              </Grid.Item>\n            )}\n\n            {needFunds && (\n              <Grid.Item\n                full\n                as={NeedFundsNotice}\n                className=\"mt3\"\n                {...needFunds}\n              />\n            )}\n\n            {showConfigureInput && (\n              <>\n                <Grid.Item\n                  full\n                  as={ToggleInput}\n                  name=\"useAdvanced\"\n                  label=\"Advanced\"\n                  inverseLabel=\"Back to Defaults\"\n                  inverseColor=\"red3\"\n                  disabled={!showConfigureInput || initializing}\n                />\n\n                <Condition when=\"useAdvanced\" is={true}>\n                  <Grid.Item full className=\"mb2\"></Grid.Item>\n                  <Grid.Divider />\n                  <Grid.Item\n                    full\n                    as={Flex}\n                    row\n                    justify=\"between\"\n                    className=\"mt2\">\n                    <Flex.Item as={H5}>Transaction Fee</Flex.Item>\n\n                    <Flex.Item as={H5}>\n                      {gasInfo}{' '}\n                      <InfoIcon\n                        className=\"pointer\"\n                        onClick={toggleGasDetails}\n                      />\n                    </Flex.Item>\n                  </Grid.Item>\n\n                  {/* TODO(shrugs): move to indigo/RangeInput */}\n                  <Grid.Item\n                    full\n                    as=\"input\"\n                    type=\"range\"\n                    min=\"1\"\n                    max=\"400\"\n                    value={gasPrice}\n                    onChange={e =>\n                      setGasPrice(convertToInt(e.target.value, 10))\n                    }\n                  />\n                  <Grid.Item\n                    full\n                    as={Flex}\n                    row\n                    justify=\"between\"\n                    className=\"f6 mt1\">\n                    <Flex.Item as={Text}>Cheap</Flex.Item>\n                    <Flex.Item as={Text}>Fast</Flex.Item>\n                  </Grid.Item>\n                  <Grid.Divider className=\"mt4\" />\n                </Condition>\n              </>\n            )}\n\n            {showSignedTx && fakeSigned && (\n              <>\n                <Grid.Item full as={NoticeBox} className=\"mt2\">\n                  Your wallet will sign the transaction upon sending it.\n                </Grid.Item>\n              </>\n            )}\n\n            {showSignedTx && !fakeSigned && (\n              <>\n                <Grid.Item\n                  full\n                  as={ToggleInput}\n                  name=\"viewSigned\"\n                  label=\"Signed Transaction\"\n                  inverseLabel=\"Hide\"\n                  disabled={!showSignedTx}\n                />\n                <Condition when=\"viewSigned\" is={true}>\n                  <SignedTransactionList\n                    serializedTxsHex={serializedTxsHex}\n                    maxCost={maxCost}\n                    nonce={nonce}\n                  />\n                </Condition>\n              </>\n            )}\n          </>\n        )}\n      </BridgeForm>\n    </Grid>\n  );\n}\n\nfunction SignedTransactionList({ serializedTxsHex, nonce, maxCost }) {\n  return serializedTxsHex.map((serializedTxHex, i) => (\n    <React.Fragment key={i}>\n      <Grid.Divider />\n      <Grid.Item full as={Flex} justify=\"between\" className=\"pv4 black f5\">\n        <Flex.Item>Nonce</Flex.Item>\n        <Flex.Item>{nonce + i}</Flex.Item>\n      </Grid.Item>\n      <Grid.Divider />\n      <Grid.Item full as={Flex} justify=\"between\" className=\"pv4 black f5\">\n        <Flex.Item>Transaction Cost</Flex.Item>\n        <Flex.Item>{maxCost} ETH</Flex.Item>\n      </Grid.Item>\n      <Grid.Divider />\n      <Grid.Item full as={Flex} justify=\"between\" className=\"mt3 mb2\">\n        <Flex.Item as={H5}>Signed Transaction Hex</Flex.Item>\n        <Flex.Item as={CopyButton} text={serializedTxHex} />\n      </Grid.Item>\n      <Grid.Item full as=\"code\" className=\"mb4 f6 mono gray4 wrap\">\n        {serializedTxHex}\n      </Grid.Item>\n      <Grid.Divider />\n    </React.Fragment>\n  ));\n}\n\nfunction TransactionReceipt({ txHashes, finalCost, onClose }) {\n  const txUrls = useExploreTxUrls(txHashes);\n  return (\n    <>\n      <Grid.Item full as={Flex} justify=\"between\" className=\"pv2 black f5\">\n        <Flex.Item>Receipt</Flex.Item>\n        <Flex.Item onClick={onClose} className=\"underline pointer\">\n          Close\n        </Flex.Item>\n      </Grid.Item>\n      <Grid.Item full as={Flex} justify=\"between\" className=\"pv2 black f5\">\n        <Flex.Item>Transaction Cost</Flex.Item>\n        <Flex.Item className=\"mono\">{finalCost} ETH</Flex.Item>\n      </Grid.Item>\n      <Grid.Divider />\n      <Grid.Item full as={Flex} col className=\"pv4\">\n        <Flex.Item as={H5}>Receipt</Flex.Item>\n\n        {txHashes &&\n          txHashes.map((txHash, i) => (\n            <Flex.Item as={Flex} className=\"mv3\">\n              <>\n                <Flex.Item\n                  key={i}\n                  flex\n                  as=\"code\"\n                  className=\"f6 mono gray4 wrap \">\n                  {txHash}\n                </Flex.Item>\n                <Flex.Item className=\"ml8\" as={LinkButton} href={txUrls[i]}>\n                  Etherscan↗\n                </Flex.Item>\n              </>\n            </Flex.Item>\n          ))}\n      </Grid.Item>\n    </>\n  );\n}\n","import React, { useCallback, useMemo, useEffect, useState } from 'react';\nimport { Grid, Text, P, LinkButton } from 'indigo-react';\nimport * as azimuth from 'azimuth-js';\n\nimport { useNetwork } from 'store/network';\nimport { usePointCursor } from 'store/pointCursor';\n\nimport * as need from 'lib/need';\nimport useEthereumTransaction from 'lib/useEthereumTransaction';\nimport { GAS_LIMITS } from 'lib/constants';\nimport { useLocalRouter } from 'lib/LocalRouter';\n\nimport ViewHeader from 'components/ViewHeader';\nimport InlineEthereumTransaction from 'components/InlineEthereumTransaction';\nimport View from 'components/View';\nimport BridgeForm from 'form/BridgeForm';\nimport { convertToInt } from 'lib/convertToInt';\n\nfunction useCastDocumentVote() {\n  const { contracts } = useNetwork();\n  const { pointCursor } = usePointCursor();\n\n  const _contracts = need.contracts(contracts);\n  const _point = need.point(pointCursor);\n\n  return useEthereumTransaction(\n    useCallback(\n      (hash, accept) => {\n        return azimuth.ecliptic.castDocumentVote(\n          _contracts,\n          _point,\n          hash,\n          accept\n        );\n      },\n      [_contracts, _point]\n    ),\n    useCallback(() => null, []), //TODO update polls[hash].hasVoted ?\n    GAS_LIMITS.DEFAULT //TODO update once we have a decent sample size\n  );\n}\n\nfunction renderDocumentHash(doc) {\n  return doc.slice(0, 34) + '\\n  ' + doc.slice(34);\n}\n\nexport default function Documents() {\n  const { pop } = useLocalRouter();\n  const { contracts } = useNetwork();\n  const { pointCursor } = usePointCursor();\n\n  const _contracts = need.contracts(contracts);\n  const _point = convertToInt(need.point(pointCursor), 10);\n\n  const { construct, reset, unconstruct, bind } = useCastDocumentVote();\n\n  // const [documentHash, setDocumentHash] = useState('0x...');\n  const [majorities, setMajorities] = useState([]);\n  const [proposals, setProposals] = useState([]);\n  const [polls, setPolls] = useState({});\n  const [loading, setLoading] = useState(true);\n  const [votingOn, setVotingOn] = useState({});\n\n  //TODO update every second?\n  const now = Math.round(new Date().getTime() / 1000);\n\n  useEffect(() => {\n    (async () => {\n      let proposals = await azimuth.polls.getDocumentProposals(_contracts);\n      let majorities = await azimuth.polls.getDocumentMajorities(_contracts);\n      let polls = {};\n      for (let doc of proposals) {\n        let poll = await azimuth.polls.getDocumentPoll(_contracts, doc);\n        poll.endTime = convertToInt(poll.start) + convertToInt(poll.duration);\n        poll.hasVoted = await azimuth.polls.hasVotedOnDocumentPoll(\n          _contracts,\n          _point,\n          doc\n        );\n        polls[doc] = poll;\n      }\n      setMajorities(majorities);\n      setProposals(proposals);\n      setPolls(polls);\n      setLoading(false);\n    })();\n  }, [_contracts, _point]);\n\n  // eslint-disable-next-line\n  const [open, closed] = useMemo(() => {\n    let open = [];\n    let closed = [];\n    if (loading) return [open, closed];\n    for (let doc of proposals) {\n      if (now > polls[doc].endTime) {\n        closed.push(doc);\n      } else {\n        open.push(doc);\n      }\n    }\n    return [open, closed];\n  }, [loading, proposals, polls, now]);\n\n  const doVote = useCallback(\n    (hash, accept) => {\n      construct(hash, accept);\n      setVotingOn({ hash, accept });\n    },\n    [construct]\n  );\n\n  const didVote = useCallback(() => {\n    reset();\n    unconstruct();\n    setPolls(polls => {\n      polls[votingOn.hash].hasVoted = true;\n      return polls;\n    });\n    setVotingOn({});\n  }, [votingOn, reset, unconstruct]);\n\n  const majorityList = useMemo(() => {\n    return majorities.map(doc => {\n      return (\n        <Grid.Item full className=\"mv2\" as={P}>\n          <a\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            href={`https://raw.githubusercontent.com/urbit/azimuth/master/proposals/${doc}.txt`}\n            class=\"mb4 mono wrap pre\">\n            {renderDocumentHash(doc)}↗\n          </a>\n        </Grid.Item>\n      );\n    });\n  }, [majorities]);\n\n  const openList = useMemo(() => {\n    return open.map(doc => {\n      const hasVoted = polls[doc].hasVoted;\n      return (\n        <>\n          <Grid.Item full className=\"mv2\" as={Text}>\n            <P className=\"m0 mono wrap pre\">{renderDocumentHash(doc)}</P>\n            <P className=\"mt0\">\n              {hasVoted ? (\n                'Your vote has been cast.'\n              ) : (\n                <>\n                  <LinkButton onClick={() => doVote(doc, true)}>\n                    {votingOn.hash === doc && votingOn.accept ? (\n                      <b>support</b>\n                    ) : (\n                      <>support</>\n                    )}\n                  </LinkButton>\n                  {' / '}\n                  <LinkButton onClick={() => doVote(doc, false)}>\n                    {votingOn.hash === doc && !votingOn.accept ? (\n                      <b>reject</b>\n                    ) : (\n                      <>reject</>\n                    )}\n                  </LinkButton>\n                </>\n              )}\n            </P>\n          </Grid.Item>\n          <Grid.Divider />\n        </>\n      );\n    });\n  }, [open, polls, votingOn, doVote]);\n\n  return (\n    <View pop={pop} inset>\n      <Grid>\n        <Grid.Item full as={ViewHeader}>\n          Senate: Document Proposals\n        </Grid.Item>\n\n        <Grid.Item full as={Grid}>\n          <Grid.Item full as={P}>\n            Accepted documents:\n          </Grid.Item>\n          {majorityList}\n        </Grid.Item>\n\n        {openList.length > 0 && (\n          <>\n            <Grid.Divider className=\"mv4\" />\n\n            <Grid.Item full as={Grid}>\n              <Grid.Item full as={P}>\n                Open document polls:\n              </Grid.Item>\n              {openList}\n            </Grid.Item>\n\n            <BridgeForm>\n              {({ onSubmit, values }) => (\n                <Grid.Item\n                  full\n                  as={InlineEthereumTransaction}\n                  {...bind}\n                  onReturn={didVote}\n                />\n              )}\n            </BridgeForm>\n          </>\n        )}\n      </Grid>\n    </View>\n  );\n}\n","const MIN_GALAXY = 0;\nconst MIN_STAR = Math.pow(2, 8);\nconst MIN_PLANET = Math.pow(2, 16);\nconst MAX_GALAXY = MIN_STAR - 1;\nconst MAX_STAR = MIN_PLANET - 1;\n\nconst randomStarName = galaxy =>\n  // (           random in range 0x1 .. 0xff ) * 0x100    + 0x??\n  (Math.floor(Math.random() * MAX_GALAXY) + 1) * MIN_STAR + galaxy;\n\nconst randomPlanetName = star =>\n  // (       random in range 0x1 .. 0xffff ) * 0x10000    + 0x????\n  (Math.floor(Math.random() * MAX_STAR) + 1) * MIN_PLANET + star;\n\nconst getSpawnCandidate = point =>\n  point >= MIN_GALAXY && point < MIN_STAR\n    ? randomStarName(point)\n    : randomPlanetName(point);\n\nexport { getSpawnCandidate };\n","import React from 'react';\nimport cn from 'classnames';\nimport { Grid, Flex } from 'indigo-react';\n\nexport default function Tabs({\n  views,\n  options,\n  currentTab,\n  onTabChange,\n  className,\n  center = false,\n  ...rest\n}) {\n  const Tab = views[currentTab];\n\n  return (\n    <Grid className={className}>\n      <Grid.Item full as={Flex} className=\"b-gray3 bb1 scroll-x hidden-y\">\n        <Flex.Item as={Flex} className=\"flex1\">\n          {options.map((option, i) => {\n            const isActive = option.value === currentTab;\n            const isFirst = i === 0;\n\n            return (\n              <Flex.Item\n                key={option.value}\n                onClick={() => onTabChange(option.value)}\n                className={cn(\n                  'f5 pv3 pointer nowrap',\n                  {\n                    'black b-black bb1': isActive,\n                    gray3: !isActive,\n                  },\n                  {\n                    't-center flex1': center,\n                  },\n                  {\n                    // all items have right margin/padding\n                    'mr2 pr2': !center,\n                    // the first one is flush to the left\n                    'ml2 pl2': !isFirst && !center,\n                  }\n                )}>\n                {option.text}\n              </Flex.Item>\n            );\n          })}\n        </Flex.Item>\n      </Grid.Item>\n      <Grid.Item full as={Tab} {...rest} />\n    </Grid>\n  );\n}\n","import { azimuth } from 'azimuth-js';\n\nimport { usePointCache } from 'store/pointCache';\nimport { useNetwork } from 'store/network';\n\nimport * as need from 'lib/need';\n\nimport { eqAddr, isZeroAddress } from './utils/address';\n\nconst NULL_PERMISSIONS = {\n  isActive: false,\n  //\n  isOwner: false,\n  isActiveOwner: false,\n  isManagementProxy: false,\n  isSpawnProxy: false,\n  isVotingProxy: false,\n  isTransferProxy: false,\n  //\n  isManagementProxySet: false,\n  isSpawnProxySet: false,\n  isVotingProxySet: false,\n  isTransferProxySet: false,\n  //\n  canManage: false,\n  canTransfer: false,\n  canSpawn: false,\n  canVote: false,\n  //\n  spawnIsDelegatedSending: false,\n};\n\n/**\n * @param {string} address\n * @param {number} point\n */\nexport default function usePermissionsForPoint(address, point) {\n  const { getDetails } = usePointCache();\n  const { contracts } = useNetwork();\n\n  const pointSize = azimuth.getPointSize(point);\n  const isPlanet = pointSize === azimuth.PointSize.Planet;\n  const isStar = pointSize === azimuth.PointSize.Star;\n  const isGalaxy = pointSize === azimuth.PointSize.Galaxy;\n  const isParent = isStar || isGalaxy;\n  const staticPermissions = { isPlanet, isStar, isGalaxy, isParent };\n\n  return {\n    ...staticPermissions,\n    ...getDetails(point).matchWith({\n      Nothing: () => NULL_PERMISSIONS,\n      Just: ({ value: details }) => {\n        const _contracts = need.contracts(contracts);\n\n        const isActive = details.active;\n\n        const isOwner = eqAddr(address, details.owner);\n        const isActiveOwner = isOwner && isActive;\n        const isManagementProxy = eqAddr(address, details.managementProxy);\n        const isSpawnProxy = eqAddr(address, details.spawnProxy);\n        const isVotingProxy = eqAddr(address, details.votingProxy);\n        const isTransferProxy = eqAddr(address, details.transferProxy);\n\n        const isManagementProxySet = !isZeroAddress(details.managementProxy);\n        const isSpawnProxySet = !isZeroAddress(details.spawnProxy);\n        const isVotingProxySet = !isZeroAddress(details.votingProxy);\n        const isTransferProxySet = !isZeroAddress(details.transferProxy);\n\n        const canManage = isOwner || isManagementProxy;\n        const canTransfer = isOwner || isTransferProxy;\n        const canSpawn =\n          isParent &&\n          (isOwner || isSpawnProxy) &&\n          details.keyRevisionNumber > 0;\n        const canVote = isGalaxy && isActive && (isOwner || isVotingProxy);\n\n        const spawnIsDelegatedSending = eqAddr(\n          _contracts.delegatedSending.address,\n          details.spawnProxy\n        );\n\n        return {\n          isActive,\n          //\n          isOwner,\n          isActiveOwner,\n          isManagementProxy,\n          isSpawnProxy,\n          isVotingProxy,\n          isTransferProxy,\n          //\n          isManagementProxySet,\n          isSpawnProxySet,\n          isVotingProxySet,\n          isTransferProxySet,\n          //\n          canManage,\n          canTransfer,\n          canSpawn,\n          canVote,\n          //\n          spawnIsDelegatedSending,\n        };\n      },\n    }),\n  };\n}\n","import { useEffect } from 'react';\nimport { difference } from 'lodash';\n\nimport { usePointCache } from 'store/pointCache';\nimport usePreviousValue from 'lib/usePreviousValue';\n\nconst buildSyncHook = getFn =>\n  function SyncPoint(points = []) {\n    const fn = getFn();\n    const prevPoints = usePreviousValue(points);\n\n    useEffect(() => {\n      // sync points that are new between renders\n      const newPoints = difference(points, prevPoints);\n      Promise.all(newPoints.map(fn));\n    }, [fn, prevPoints, points]);\n  };\n\nexport const useSyncDates = buildSyncHook(function() {\n  const { syncDates } = usePointCache();\n  return syncDates;\n});\n\nexport const useSyncDetails = buildSyncHook(function() {\n  const { syncDetails } = usePointCache();\n  return syncDetails;\n});\n\nexport const useSyncExtras = buildSyncHook(function() {\n  const { syncExtras } = usePointCache();\n  return syncExtras;\n});\n","export const buildKeyType = permissions => {\n  if (permissions.isOwner) {\n    return 'Ownership';\n  } else if (permissions.isManagementProxy) {\n    return 'Management';\n  } else if (permissions.isSpawnProxy) {\n    return 'Spawn';\n  } else if (permissions.isVotingProxy) {\n    return 'Voting';\n  } else if (permissions.isTransferProxy) {\n    return 'Transfer';\n  }\n};\n","import React, { useCallback } from 'react';\nimport { Grid } from 'indigo-react';\nimport cn from 'classnames';\nimport * as ob from 'urbit-ob';\n\nimport Sigil from 'components/Sigil';\n\nimport { usePointCache } from 'store/pointCache';\nimport { useWallet } from 'store/wallet';\n\nimport * as need from 'lib/need';\nimport usePermissionsForPoint from 'lib/usePermissionsForPoint';\nimport { useSyncDetails } from 'lib/useSyncPoints';\nimport { buildKeyType } from 'lib/point';\n\nfunction ActiveViewRow({ point, goPoint }) {\n  const { wallet } = useWallet();\n  const address = need.addressFromWallet(wallet);\n  useSyncDetails([point]);\n  const permissions = usePermissionsForPoint(address, point);\n\n  const keyType = buildKeyType(permissions);\n  const patp = ob.patp(point);\n  const sigilSize = 50;\n\n  const onClick = useCallback(() => goPoint(point), [point, goPoint]);\n  return (\n    <>\n      <Grid.Item className=\"flex-row align-center\" cols={[1, 3]}>\n        {patp}{' '}\n      </Grid.Item>\n      <Grid.Item className=\"flex-row align-center\" cols={[3, 6]}>\n        <div\n          style={{\n            display: 'inline-block',\n            height: `${sigilSize}px`,\n            width: `${sigilSize}px`,\n          }}>\n          <Sigil patp={patp} size={25} colors={['#FFFFFF', '#000000']} />\n        </div>\n      </Grid.Item>\n      <Grid.Item className=\"flex-row align-center\" cols={[6, 10]}>\n        {keyType}\n      </Grid.Item>\n      <Grid.Item\n        onClick={onClick}\n        cols={[10, 13]}\n        className=\"flex-row-r align-center mr2\">\n        ->\n      </Grid.Item>\n      <Grid.Divider />\n    </>\n  );\n}\n\nexport default function ActiveView({ className, goPoint }) {\n  // const points = [2560, 2561, 2562];\n  const { controlledPoints } = usePointCache();\n  console.log(controlledPoints);\n  const points = controlledPoints\n    .matchWith({\n      Nothing: () => [],\n      Just: ps =>\n        ps.value.matchWith({\n          Error: () => null,\n          Ok: ({ value }) => {\n            return [\n              ...value.ownedPoints,\n              ...value.votingPoints,\n              ...value.managingPoints,\n              ...value.spawningPoints,\n            ];\n          },\n        }),\n    })\n    .filter(Boolean)\n    .filter(p => 255 < p && p < 65536);\n\n  return (\n    <Grid full className={cn('f5', className)}>\n      <Grid.Item className=\"pv3 \" cols={[1, 6]} third={1}>\n        Point\n      </Grid.Item>\n      <Grid.Item className=\"pv3 \" cols={[6, 10]}>\n        Key Type\n      </Grid.Item>\n      <Grid.Divider />\n      {points.length === 0 && (\n        <Grid.Item full className=\"flex-center pv8 f5 gray4\">\n          You have no active stars\n        </Grid.Item>\n      )}\n      {points.map(point => (\n        <ActiveViewRow\n          key={point}\n          goPoint={goPoint}\n          point={point}></ActiveViewRow>\n      ))}\n    </Grid>\n  );\n}\n","export const pluralize = (count, singular, plural) => {\n  const isPlural = count === 0 || count > 1;\n  if (!plural) {\n    return `${count} ${singular}${isPlural ? 's' : ''}`;\n  }\n\n  return isPlural ? plural : singular;\n};\n","import React, { useCallback, useEffect, useMemo } from 'react';\nimport cn from 'classnames';\nimport { Grid, Flex } from 'indigo-react';\nimport { Just } from 'folktale/maybe';\n\nimport * as need from 'lib/need';\nimport useEthereumTransaction from 'lib/useEthereumTransaction';\nimport { pluralize } from 'lib/pluralize';\n\nimport { useWallet } from 'store/wallet';\nimport { usePointCache } from 'store/pointCache';\nimport { useStarReleaseCache } from 'store/starRelease';\n\nimport InlineEthereumTransaction from 'components/InlineEthereumTransaction';\nimport { matchBlinky } from 'components/Blinky';\n\nimport { NumberInput, AddressInput } from 'form/Inputs';\nimport BridgeForm from 'form/BridgeForm';\nimport FormError from 'form/FormError';\nimport { composeValidator, buildNumberValidator } from 'form/validators';\nimport { convertToNumber } from 'form/formatters';\n\nfunction MatchPluralizeStars({ quantity }) {\n  const _quantity = quantity.getOrElse(0);\n  return (\n    <>\n      {' '}\n      <span\n        className={cn({\n          green2: _quantity > 0,\n          red4: Just.hasInstance(quantity) && _quantity === 0,\n        })}>\n        {matchBlinky(quantity)}\n      </span>\n      {pluralize(_quantity, ' star ', ' stars ')}\n    </>\n  );\n}\n\nfunction AddressIndicator({ isOwn, className }) {\n  return isOwn ? (\n    <div className={cn('green2', className)}>✓ Current Address</div>\n  ) : (\n    <div className={cn('red4', className)}>! Different address</div>\n  );\n}\n\nfunction useWithdrawStars() {\n  const { syncControlledPoints } = usePointCache();\n\n  const { syncStarReleaseDetails, withdraw } = useStarReleaseCache();\n  return useEthereumTransaction(\n    useCallback((to, amount) => withdraw(amount, to), [withdraw]),\n    useCallback(\n      () => Promise.all([syncControlledPoints(), syncStarReleaseDetails()]),\n      [syncStarReleaseDetails, syncControlledPoints]\n    )\n  );\n}\n\nexport default function Locked({ className, goActive }) {\n  const { wallet } = useWallet();\n  const address = need.addressFromWallet(wallet);\n  const {\n    bind,\n    construct,\n    unconstruct,\n    inputsLocked,\n    completed,\n    reset,\n  } = useWithdrawStars();\n\n  const { syncStarReleaseDetails, starReleaseDetails } = useStarReleaseCache();\n\n  useEffect(() => {\n    syncStarReleaseDetails();\n  }, [syncStarReleaseDetails]);\n\n  const onValues = useCallback(\n    ({ valid, values }) => {\n      if (valid) {\n        construct(values.address, convertToNumber(values.numStars));\n      } else {\n        unconstruct();\n      }\n    },\n    [construct, unconstruct]\n  );\n\n  const canWithdraw = starReleaseDetails.map(b => b.available);\n  const total = starReleaseDetails.map(b => b.total);\n\n  const validate = useMemo(\n    () =>\n      composeValidator(\n        {\n          numStars: buildNumberValidator(0, canWithdraw.getOrElse(0) + 1),\n        },\n        (values, errors) => (inputsLocked ? false : errors)\n      ),\n    [canWithdraw, inputsLocked]\n  );\n\n  const initialValues = { address };\n\n  return (\n    <Grid gap={completed ? 0 : 6} className={cn('mt4', className)} full>\n      <BridgeForm\n        initialValues={initialValues}\n        onValues={onValues}\n        validate={validate}>\n        {({ values, form }) => (\n          <>\n            {!completed && (\n              <>\n                <Grid.Item full className=\"f5\">\n                  You have <MatchPluralizeStars quantity={canWithdraw} />\n                  available to withdraw\n                  <br />\n                  You have\n                  <MatchPluralizeStars quantity={total} />\n                  total\n                </Grid.Item>\n                <Grid.Item\n                  cols={[1, 4]}\n                  label=\"Stars\"\n                  as={NumberInput}\n                  placeholder=\"#\"\n                  name=\"numStars\"\n                  disabled={inputsLocked}\n                  accessory={\n                    <div className=\"flex-center h-full\">\n                      / &nbsp;{matchBlinky(canWithdraw)}\n                    </div>\n                  }\n                />\n                <Grid.Item full className=\"f5\" cols={[1, 13]} as={Flex} col>\n                  <Flex.Item\n                    name=\"address\"\n                    as={AddressInput}\n                    label=\"Withdraw To\"\n                    disabled={inputsLocked}\n                  />\n                  <Flex.Item\n                    as={AddressIndicator}\n                    isOwn={address === values.address}\n                  />\n                </Grid.Item>\n              </>\n            )}\n\n            <Grid.Item full as={FormError} />\n            {completed && (\n              <>\n                <Grid.Item full className=\"pv4\">\n                  {values.numStars}{' '}\n                  {pluralize(values.numStars, 'star has', 'stars have')} been\n                  withdrawn\n                </Grid.Item>\n                <Grid.Divider />\n              </>\n            )}\n            <Grid.Item\n              full\n              as={InlineEthereumTransaction}\n              {...bind}\n              label=\"Withdraw Stars\"\n              onReturn={() => {\n                reset();\n                form.reset();\n              }}\n            />\n          </>\n        )}\n      </BridgeForm>\n    </Grid>\n  );\n}\n","import React, { useState, useCallback } from 'react';\nimport { H1, Grid } from 'indigo-react';\nimport { Just } from 'folktale/maybe';\n\nimport * as need from 'lib/need';\n\nimport { useHistory } from 'store/history';\nimport { useWallet } from 'store/wallet';\nimport { usePointCursor } from 'store/pointCursor';\n\nimport View from 'components/View';\nimport Tabs from 'components/Tabs';\nimport CopiableAddress from 'components/CopiableAddress';\n\nimport Active from 'views/Release/Active';\nimport Locked from 'views/Release/Locked';\nimport Transfer from 'views/Release/Transfer';\nimport NavHeader from 'components/NavHeader';\n\nconst NAMES = {\n  ACTIVE: 'ACTIVE',\n  LOCKED: 'LOCKED',\n  TRANSFER: 'TRANSFER',\n};\n\nconst VIEWS = {\n  [NAMES.ACTIVE]: Active,\n  [NAMES.LOCKED]: Locked,\n  [NAMES.TRANSFER]: Transfer,\n};\nconst OPTIONS = [\n  { text: 'Active', value: NAMES.ACTIVE },\n  { text: 'Locked', value: NAMES.LOCKED },\n  { text: 'Transfer', value: NAMES.TRANSFER },\n];\nexport default function ReleaseView() {\n  const { pop, push, names } = useHistory();\n  const { wallet } = useWallet();\n\n  const { setPointCursor } = usePointCursor();\n\n  const goPoint = useCallback(\n    point => {\n      setPointCursor(Just(point));\n\n      push(names.POINT);\n    },\n    [push, names, setPointCursor]\n  );\n  // inputs\n  const [currentTab, setCurrentTab] = useState(NAMES.ACTIVE);\n\n  const goActive = useCallback(() => {\n    setCurrentTab(NAMES.ACTIVE);\n  }, [setCurrentTab]);\n\n  const address = need.addressFromWallet(wallet);\n\n  return (\n    <View pop={pop} inset>\n      <NavHeader>\n        <CopiableAddress\n          className=\"f6 mono gray4 us-none pointer\"\n          text={address}>\n          {address}\n        </CopiableAddress>\n      </NavHeader>\n      <Grid>\n        <Grid.Item full as={H1}></Grid.Item>\n\n        <Grid.Item\n          full\n          as={Tabs}\n          className=\"mt1\"\n          // Tabs\n          views={VIEWS}\n          options={OPTIONS}\n          currentTab={currentTab}\n          onTabChange={setCurrentTab}\n          // Tab extra\n          goPoint={goPoint}\n          goActive={goActive}\n          //\n          //\n        />\n      </Grid>\n    </View>\n  );\n}\n","import React, { useCallback, useEffect, useMemo } from 'react';\nimport cn from 'classnames';\nimport { Grid, Flex } from 'indigo-react';\nimport { conditionalSR, linearSR } from 'azimuth-js';\n\nimport * as need from 'lib/need';\nimport useEthereumTransaction from 'lib/useEthereumTransaction';\nimport { getLockupKind } from 'lib/starRelease';\nimport { eqAddr, isZeroAddress } from 'lib/utils/address';\n\nimport { useNetwork } from 'store/network';\nimport { useWallet } from 'store/wallet';\nimport { useHistory } from 'store/history';\nimport { useStarReleaseCache } from 'store/starRelease';\n\nimport InlineEthereumTransaction from 'components/InlineEthereumTransaction';\nimport CopiableAddress from 'components/CopiableAddress';\nimport NoticeBox from 'components/NoticeBox';\n\nimport { AddressInput } from 'form/Inputs';\nimport BridgeForm from 'form/BridgeForm';\nimport FormError from 'form/FormError';\nimport { composeValidator } from 'form/validators';\nimport { isValidAddress } from 'ethereumjs-util';\n\nfunction useTransferLockup(kind) {\n  const { contracts } = useNetwork();\n\n  return useEthereumTransaction(\n    useCallback(\n      to => {\n        const _contracts = need.contracts(contracts);\n        if (kind === 'conditional') {\n          return conditionalSR.approveCommitmentTransfer(_contracts, to);\n        } else {\n          return linearSR.approveBatchTransfer(_contracts, to);\n        }\n      },\n      [kind, contracts]\n    ),\n    () => {}\n  );\n}\n\nexport default function Transfer({ className, goActive }) {\n  const { wallet } = useWallet();\n  const { contracts } = useNetwork();\n  const { pop } = useHistory();\n  const address = need.addressFromWallet(wallet);\n\n  const { syncStarReleaseDetails, starReleaseDetails } = useStarReleaseCache();\n\n  useEffect(() => {\n    syncStarReleaseDetails();\n  }, [syncStarReleaseDetails]);\n\n  const kind = useMemo(() => {\n    return starReleaseDetails.map(a => a.kind).getOrElse('') === 'conditional'\n      ? 'conditional'\n      : 'linear';\n  }, [starReleaseDetails]);\n\n  const approvedFor = useMemo(() => {\n    let approved;\n    if (kind === 'conditional') {\n      approved = starReleaseDetails.map(a => a.conditional.approvedTransferTo);\n    } else {\n      approved = starReleaseDetails.map(a => a.linear.approvedTransferTo);\n    }\n    approved = approved.getOrElse('0x0');\n    if (isZeroAddress(approved) || eqAddr(approved, address)) {\n      return false;\n    } else {\n      return approved;\n    }\n  }, [starReleaseDetails, kind, address]);\n\n  const {\n    bind,\n    construct,\n    unconstruct,\n    inputsLocked,\n    completed,\n  } = useTransferLockup(kind);\n\n  const onValues = useCallback(\n    async ({ valid, values }) => {\n      if (valid) {\n        construct(values.to);\n      } else {\n        unconstruct();\n      }\n    },\n    [construct, unconstruct]\n  );\n\n  const validate = useMemo(\n    () =>\n      composeValidator({\n        to: async to => {\n          if (!isValidAddress(to)) {\n            return 'This is not a valid Ethereum address.';\n          }\n          const theirs = await getLockupKind(need.contracts(contracts), to);\n          if (theirs === kind || theirs === 'both') {\n            return `Target address already owns a ${kind} lockup.`;\n          }\n        },\n      }),\n    [kind, contracts]\n  );\n\n  return (\n    <Grid gap={completed ? 0 : 6} className={cn('mt4', className)} full>\n      <BridgeForm onValues={onValues} validate={validate}>\n        {({ values, form }) => (\n          <>\n            {!completed && (\n              <>\n                <Grid.Item full className=\"f5\">\n                  Allow the specified address to take over your {kind} lockup.\n                  <br />\n                  After they accept the transfer, you will no longer be able to{' '}\n                  withdraw from this lockup.\n                </Grid.Item>\n                {approvedFor && (\n                  <Grid.Item full as={NoticeBox}>\n                    Transfer currently approved for{' '}\n                    <CopiableAddress>{approvedFor}</CopiableAddress>\n                  </Grid.Item>\n                )}\n                <Grid.Item full className=\"f5\" cols={[1, 13]} as={Flex} col>\n                  <Flex.Item\n                    name=\"to\"\n                    as={AddressInput}\n                    label=\"Approve transfer to\"\n                    disabled={inputsLocked}\n                  />\n                </Grid.Item>\n              </>\n            )}\n\n            <Grid.Item full as={FormError} />\n            {completed && (\n              <>\n                <Grid.Item full className=\"pv4\">\n                  <CopiableAddress>{values.to}</CopiableAddress> is now allowed{' '}\n                  to take ownership of this lockup. They can do so by visiting:\n                </Grid.Item>\n                <Grid.Item full as=\"code\" className=\"f5 mb4 mono wrap\">\n                  https://bridge.urbit.org/?kind=takeLockup&lock={kind}\n                  &from={address}\n                </Grid.Item>\n                <Grid.Divider />\n              </>\n            )}\n            <Grid.Item\n              full\n              as={InlineEthereumTransaction}\n              {...bind}\n              label=\"Approve Transfer\"\n              onReturn={() => pop()}\n            />\n          </>\n        )}\n      </BridgeForm>\n    </Grid>\n  );\n}\n","import React, { useCallback } from 'react';\nimport cn from 'classnames';\nimport ob from 'urbit-ob';\nimport { Grid, Text, LinkButton } from 'indigo-react';\n\nimport useWasGreeted from 'lib/useWasGreeted';\n\nconst TEXT_STYLE = 'f5';\n\nexport default function ActivateDisclaimer({ point }) {\n  const [wasGreeted, setWasGreeted] = useWasGreeted();\n\n  const pointName = ob.patp(point);\n\n  const dismiss = useCallback(async () => {\n    setWasGreeted(true);\n  }, [setWasGreeted]);\n\n  return (\n    !wasGreeted && (\n      <Grid gap={4} className=\"mb10\">\n        <Grid.Item full>\n          <Text className={cn(TEXT_STYLE, 'block mb4')}>\n            Welcome <code>{pointName}</code>,\n          </Text>\n\n          <Text className={cn(TEXT_STYLE, 'block mb2')}>\n            As of this moment, you own a piece of Urbit. No one can take it from\n            you, and you can keep it for the rest of your life.\n          </Text>\n          <Text className={cn(TEXT_STYLE, 'block mb2')}>\n            Keep your Master Ticket safe. No one can recover it for you. But it\n            can get you back into Urbit at any time.\n          </Text>\n          <Text className={cn(TEXT_STYLE, 'block mb2')}>\n            Right now you can:\n          </Text>\n        </Grid.Item>\n\n        <Grid.Item\n          full\n          as={LinkButton}\n          href=\"https://urbit.org/docs/getting-started/\">\n          <Text className={cn(TEXT_STYLE, 'block mb2')}>\n            Boot Arvo, the Urbit OS\n          </Text>\n        </Grid.Item>\n\n        <Grid.Item full>\n          <Text className={cn(TEXT_STYLE, 'block mb4')}>\n            Welcome to Urbit. See you online.\n          </Text>\n        </Grid.Item>\n        <Grid.Item full as={LinkButton} onClick={dismiss}>\n          Close\n        </Grid.Item>\n      </Grid>\n    )\n  );\n}\n","import useLocalStorageState from './useLocalStorageState';\n\nconst WAS_GREETED_KEY = 'bridge:was-greeted';\n\nexport default function useWasGreeted() {\n  return useLocalStorageState(WAS_GREETED_KEY, false);\n}\n","const initCanvas = (canvas, size, ratio) => {\n  const { x, y } = size;\n  // let ctx = canvas.getContext('2d')\n\n  const dpi200 = window.devicePixelRatio * (200 / 72);\n\n  canvas.width = x * dpi200;\n  canvas.height = y * dpi200;\n  canvas.style.width = x + 'px';\n  canvas.style.height = y + 'px';\n\n  canvas.getContext('2d').scale(dpi200, dpi200);\n\n  return canvas;\n};\n\nconst mapToRange = (v, l1, h1, l2, h2) =>\n  l2 + ((h2 - l2) * (v - l1)) / (h1 - l1);\n\nconst seq = num => Array.from(Array(num), (_, i) => i);\n\nconst compose = (...fns) =>\n  fns.reduce((f, g) => (...xs) => {\n    const r = g(...xs);\n    return Array.isArray(r) ? f(...r) : f(r);\n  });\n\nconst Matrix = {\n  get: {\n    at: (m, r, c) => m[r][c],\n    nn: (m, r, c) => m[r - 1][c],\n    ne: (m, r, c) => m[r - 1][c + 1],\n    ee: (m, r, c) => m[r][c + 1],\n    se: (m, r, c) => m[r + 1][c + 1],\n    ss: (m, r, c) => m[r + 1][c],\n    sw: (m, r, c) => m[r + 1][c - 1],\n    ww: (m, r, c) => m[r][c - 1],\n    nw: (m, r, c) => m[r - 1][c - 1],\n  },\n  set: {\n    at: (m, r, c, v) => (m[r][c] = v),\n    nn: (m, r, c, v) => (m[r - 1][c] = v),\n    ne: (m, r, c, v) => (m[r - 1][c + 1] = v),\n    ee: (m, r, c, v) => (m[r][c + 1] = v),\n    se: (m, r, c, v) => (m[r + 1][c + 1] = v),\n    ss: (m, r, c, v) => (m[r + 1][c] = v),\n    sw: (m, r, c, v) => (m[r + 1][c - 1] = v),\n    ww: (m, r, c, v) => (m[r][c - 1] = v),\n    nw: (m, r, c, v) => (m[r - 1][c - 1] = v),\n  },\n  coord: {\n    at: (r, c) => ({ r: r, c: c }),\n    nn: (r, c) => ({ r: r - 1, c: c }),\n    ne: (r, c) => ({ r: r - 1, c: c + 1 }),\n    ee: (r, c) => ({ r: r, c: c + 1 }),\n    se: (r, c) => ({ r: r + 1, c: c + 1 }),\n    ss: (r, c) => ({ r: r + 1, c: c }),\n    sw: (r, c) => ({ r: r + 1, c: c - 1 }),\n    ww: (r, c) => ({ r: r, c: c - 1 }),\n    nw: (r, c) => ({ r: r - 1, c: c - 1 }),\n  },\n  dirs: {\n    NN: 'nn',\n    NE: 'ne',\n    EE: 'ee',\n    SE: 'se',\n    SS: 'ss',\n    SW: 'sw',\n    WW: 'ww',\n    NW: 'nw',\n  },\n  new: (rs, cs) => seq(rs).map(_ => seq(cs).map(_ => 0)),\n  rows: m => m.length - 1,\n  cols: m => m[0].length - 1,\n};\n\nconst chunkStr = (str, size) => {\n  const r = new RegExp(`.{1,${size}}`, 'g');\n  return str.match(r);\n};\n\nconst Base3Mapping = [\n  Matrix.dirs.NN,\n  Matrix.dirs.NE,\n  Matrix.dirs.EE,\n  Matrix.dirs.SE,\n  Matrix.dirs.SS,\n  Matrix.dirs.SW,\n  Matrix.dirs.WW,\n  Matrix.dirs.NW,\n];\n\nconst walk = (int, matrix) => {\n  // convert the int to a base8 string, split to array\n  var chunks = int.toString(8).split('');\n\n  // convert the int to a base10 string\n  var b10 = int.toString(10);\n\n  // get number of rows and cols\n  var rows = Matrix.rows(matrix);\n  var cols = Matrix.cols(matrix);\n\n  // split the length-4 number into 2 parts, which is a number from 0-99\n  // if the substring is empty, substitute 10\n  var sx = parseInt(b10.substring(0, 2) || 0, 10);\n  var sy = parseInt(b10.substring(2, 4) || 0, 10);\n\n  // generate a starting coordinate\n  var coord = {\n    c: ~~mapToRange(sx, 0, 99, 0, cols),\n    r: ~~mapToRange(sy, 0, 99, 0, rows),\n  };\n\n  var vect;\n  var next;\n\n  for (var i = 0; i < chunks.length; i++) {\n    // Each chunk is a number from 0-7 which refers to a direction assigned in Base3Mapping.\n    // Get the current chunk, and then get the direction it has been paired with.\n    vect = Base3Mapping[chunks[i]];\n\n    // generate the next coordinate to go to, based on the current coordinate and the direction stored in vect.\n    next = Matrix.coord[vect](coord.r, coord.c);\n\n    // If at an edge of the matrix, substitute the opposite direction.\n    if (next.r < 0) vect = Matrix.dirs.SS;\n    if (next.c < 0) vect = Matrix.dirs.EE;\n    if (next.r > rows) vect = Matrix.dirs.NN;\n    if (next.c > cols) vect = Matrix.dirs.WW;\n\n    // If at in the corner of the matrix, substitute an alternative direction.\n    if (next.r === 0 && coord.c === 0) vect = Matrix.dirs.SE;\n    if (next.r > rows && coord.c === 0) vect = Matrix.dirs.NE;\n    if (next.r === 0 && coord.c > cols) vect = Matrix.dirs.SW;\n    if (next.r > rows && coord.c > cols) vect = Matrix.dirs.NW;\n\n    // get the next coordinate again in case there was an edge/cornercase\n    next = Matrix.coord[vect](coord.r, coord.c);\n\n    // increment the value at the next coordinate.\n    Matrix.set.at(\n      matrix,\n      next.r,\n      next.c,\n      Matrix.get.at(matrix, next.r, next.c) + 1\n    );\n\n    // set the new current coordinate.\n    coord = next;\n  }\n\n  // return a 2-ary array in order to pass both values to the next function in the compose pipeline.\n  return [int, matrix];\n};\n\nconst rand = (int, matrix) => {\n  // break base10 integer into chunks with length of 4\n  var chunks = chunkStr(int.toString(10), 4);\n  var cols = Matrix.cols(matrix);\n  var rows = Matrix.rows(matrix);\n  var ch;\n  var x;\n  var y;\n  var c;\n  var r;\n\n  for (var i = 0; i < chunks.length; i++) {\n    // for each chunk in chunks\n    ch = chunks[i];\n\n    // split the length-4 number into 2 parts, which is a number from 0-99\n    // if the substring is empty, substitute 10\n    x = parseInt(ch.substring(0, 2) || 0, 10);\n    y = parseInt(ch.substring(2, 4) || 0, 10);\n\n    // map num from 0-99 to 0 - num of cols, then use ~~ for fast math.floor\n    // c (col) and r (row) are coordinates\n    c = ~~mapToRange(x, 0, 99, 0, cols);\n    r = ~~mapToRange(y, 0, 99, 0, rows);\n\n    // increment number at the coordinate\n    Matrix.set.at(matrix, r, c, Matrix.get.at(matrix, r, c) + 1);\n  }\n\n  // return a 2-ary array in order to pass both values to the next function in the compose pipeline.\n  return [int, matrix];\n};\n\nexport { chunkStr, initCanvas, seq, Matrix, compose, mapToRange, walk, rand };\n","import React, { useMemo } from 'react';\nimport { Just, Nothing } from 'folktale/maybe';\nimport ob from 'urbit-ob';\nimport BN from 'bn.js';\nimport 'style/anim.css';\n\nimport * as need from 'lib/need';\nimport { chunkStr, Matrix, walk, rand } from 'lib/card';\nimport usePermissionsForPoint from 'lib/usePermissionsForPoint';\nimport { useSyncDetails } from 'lib/useSyncPoints';\nimport { buildKeyType } from 'lib/point';\n\nimport { useWallet } from 'store/wallet';\n\nimport { sigil, reactRenderer } from 'urbit-sigil-js';\n\nfunction makeSigil(size, patp, colors) {\n  const config = {\n    margin: 0,\n    renderer: reactRenderer,\n    full: true,\n    patp,\n    colors,\n    size,\n  };\n\n  return sigil(config);\n}\n\nconst symbols = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13];\n\n/**\n * Address is Maybe<string>\n * point is Maybe<string>\n * animationMode is 'slide' | 'step' | 'none'\n *\n */\nfunction Passport({\n  address,\n  point,\n  inverted,\n  animationMode = 'none',\n  keyType,\n}) {\n  const [cols, rows, tile] = [35, 12, 12];\n\n  const loading = Nothing.hasInstance(address) || Nothing.hasInstance(point);\n  const defaultMatrix = () => {\n    return Matrix.new(rows, cols);\n  };\n\n  const patp = ob.patp(point.value);\n\n  const makeMatrix = addr => {\n    // remove the 0x\n    const onlyTheNumberPart = addr.substring(2);\n    // make bigNum from hex\n    const int = new BN(onlyTheNumberPart, 16);\n    // make a bigger number\n    const big = int.pow(new BN(10));\n    // parse that to a string and pad\n    const b10 = big.toString(10).padStart(32, '0');\n    // split the big number into parts\n    const chunkSize = Math.ceil(b10.length / 8);\n    const chunks = chunkStr(b10, chunkSize).map(c => new BN(c));\n    // generate an empty matrix\n    const startMatrix = Matrix.new(rows, cols);\n    // do a few random walks starting at diff coordinates\n    const [, matrix] = chunks.reduce((acc, chunk) => {\n      return walk(chunk, acc[1]);\n      // start with the 'random' points (not actually random, they are deterministic)\n    }, rand(big, startMatrix));\n\n    return matrix;\n  };\n\n  const matrix = address.matchWith({\n    Just: ({ value }) => makeMatrix(value),\n    Nothing: defaultMatrix,\n  });\n\n  const bgColor = inverted ? 'white' : 'black';\n\n  const fgColor = inverted ? 'black' : 'white';\n\n  const sigil = useMemo(\n    () => Just.hasInstance(point) && makeSigil(64, patp, [bgColor, fgColor]),\n    [patp, point, bgColor, fgColor]\n  );\n  return (\n    <div\n      style={{\n        fontFamily: 'Inter',\n        backgroundColor: bgColor,\n        border: inverted ? '2px solid #E6E6E6' : '2px solid black',\n        borderRadius: '20px',\n        marginBottom: '16px',\n        width: `${16 + 16 + cols * tile}px`,\n        minWidth: `${16 + 16 + cols * tile}px`,\n        display: 'flex',\n        flexDirection: 'column',\n      }}>\n      <div\n        style={{\n          height: '64px',\n          padding: '16px',\n          display: 'flex',\n        }}>\n        <div\n          style={{\n            width: '100%',\n            display: 'flex',\n            alignItems: 'center',\n          }}>\n          {sigil}\n          <div\n            style={{\n              marginLeft: '16px',\n            }}>\n            <div\n              style={{\n                fontWeight: '600',\n                color: fgColor,\n                fontSize: '16px',\n                fontFamily: 'Source Code Pro',\n              }}>\n              {Just.hasInstance(point) && patp}\n            </div>\n            {keyType !== '' ? (\n              <div\n                style={{\n                  marginTop: '8px',\n                  fontWeight: '500',\n                  color: fgColor,\n                  fontSize: '14px',\n                  fontFamily: 'Source Code Pro',\n                }}>\n                {keyType}\n              </div>\n            ) : (\n              <div />\n            )}\n          </div>\n        </div>\n      </div>\n      <div\n        style={{\n          display: 'flex',\n          flexDirection: 'column',\n          padding: '16px',\n          paddingTop: '0px',\n          filter: inverted ? 'invert(1)' : '',\n        }}>\n        {matrix.map((row, _row) => {\n          return (\n            <div\n              key={`card:row:${_row}`}\n              style={{ display: 'flex', justifyContent: 'space-between' }}>\n              {row.map((v, _col) => {\n                return (\n                  <Cell\n                    row={_row}\n                    col={_col}\n                    value={typeof symbols[v] === 'undefined' ? 13 : v}\n                    spriteSheet={'a'}\n                    spriteSheetHeight={12}\n                    spriteSheetWidth={168}\n                    inverted={inverted}\n                    loading={loading}\n                    animationMode={animationMode}\n                  />\n                );\n              })}\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n}\n\nconst Cell = props => {\n  return (\n    <div\n      key={`card:cell:${props.row}:${props.col}:${props.value}`}\n      className={\n        props.loading\n          ? 'blink'\n          : props.animationMode === 'none'\n          ? ''\n          : `${props.animationMode}-h-${props.value}`\n      }\n      style={{\n        backgroundImage: `url(/spritesheet_a.png)`,\n        backgroundPosition:\n          props.animationMode === 'none'\n            ? `-${props.spriteSheetHeight * props.value}px 0px`\n            : '',\n        backgroundSize: `${props.spriteSheetWidth}px ${props.spriteSheetHeight}px`,\n        width: `${props.spriteSheetHeight}px`,\n        maxWidth: `${props.spriteSheetHeight}px`,\n        height: `${props.spriteSheetHeight}px`,\n        maxHeight: `${props.spriteSheetHeight}px`,\n        animationDelay: `${props.value * 50}ms`,\n      }}\n    />\n  );\n};\n\n/**\n * point is number\n *\n */\nfunction MiniPassport({ point, inverted, ...rest }) {\n  useSyncDetails([point]);\n  const { wallet } = useWallet();\n  const address = need.addressFromWallet(wallet);\n\n  const patp = ob.patp(point);\n  const permissions = usePermissionsForPoint(address, point);\n  const keyType = buildKeyType(permissions);\n  const sigil = useMemo(\n    () =>\n      makeSigil(44, patp, inverted ? ['white', 'black'] : ['black', 'white']),\n    [inverted, patp]\n  );\n  return (\n    <div\n      style={{\n        fontFamily: 'Inter',\n        backgroundColor: inverted ? 'white' : 'black',\n        border: inverted ? '2px solid #E6E6E6' : '2px solid black',\n        borderRadius: '20px',\n        marginBottom: '16px',\n        maxWidth: `${230}px`,\n        display: 'flex',\n        flexDirection: 'column',\n      }}\n      {...rest}>\n      <div\n        style={{\n          height: '44px',\n          padding: '16px',\n          display: 'flex',\n        }}>\n        <div\n          style={{\n            width: '100%',\n            display: 'flex',\n            alignItems: 'center',\n          }}>\n          {sigil}\n          <div\n            style={{\n              marginLeft: '16px',\n              display: 'flex',\n              flexDirection: 'column',\n              justifyContent: 'space-between',\n            }}>\n            <div\n              style={{\n                fontWeight: '600',\n                color: inverted ? 'black' : 'white',\n                fontSize: '14px',\n                fontFamily: 'Source Code Pro',\n              }}>\n              {patp}\n            </div>\n            {keyType !== '' ? (\n              <div\n                style={{\n                  marginTop: '8px',\n                  fontWeight: '500',\n                  color: inverted ? 'black' : 'white',\n                  fontSize: '12px',\n                  fontFamily: 'Source Code Pro',\n                }}>\n                {keyType}\n              </div>\n            ) : (\n              <div />\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nPassport.Mini = MiniPassport;\n\nexport default Passport;\n","import React from 'react';\nimport cn from 'classnames';\nimport { Nothing } from 'folktale/maybe';\n\nconst BarGraph = ({\n  className,\n  available = Nothing(),\n  sent = Nothing(),\n  accepted = Nothing(),\n}) => {\n  const _available = available.getOrElse(1);\n  const _sent = sent.getOrElse(0);\n  const _accepted = accepted.getOrElse(0);\n  const total = _available + _sent;\n  return (\n    <div className={cn('h7 p1 b1 b-black flex', className)}>\n      <div\n        className=\"bg-black\"\n        style={{ width: `${(_accepted / total) * 100}%` }}></div>\n      <div\n        className=\"bg-yellow4\"\n        style={{ width: `${((_sent - _accepted) / total) * 100}%` }}></div>\n\n      <div className=\"flex-grow\" />\n    </div>\n  );\n};\n\nexport default BarGraph;\n","import React from 'react';\nimport cn from 'classnames';\n\nexport default function Chip({ children, bgColor, fgColor, className }) {\n  return (\n    <div\n      className={cn(\n        className,\n        'h6 r-full flex-center ph2 mh2 f6',\n        bgColor,\n        fgColor\n      )}>\n      {children}\n    </div>\n  );\n}\n","import React from 'react';\nimport cn from 'classnames';\nimport { Just, Nothing } from 'folktale/maybe';\nimport * as ob from 'urbit-ob';\nimport { take } from 'lodash';\n\nimport MaybeSigil from 'components/MaybeSigil';\n\nconst InviteSigilList = ({ className, pendingPoints, acceptedPoints }) => {\n  const _acceptedPoints = take(\n    acceptedPoints.getOrElse([]).map(x => Just(ob.patp(x))),\n    6\n  );\n\n  const _pendingPoints = take(\n    pendingPoints.getOrElse([]).map(x => Just(ob.patp(x))),\n    6 - _acceptedPoints.length\n  );\n\n  const empty = [\n    ...Array(\n      Math.max(6 - _acceptedPoints.length - _pendingPoints.length, 0)\n    ).keys(),\n  ].map(() => Nothing());\n\n  const renderSigil = (points, colors, klassName) => {\n    return (\n      <>\n        {points.map((point, idx) => (\n          <div\n            key={idx}\n            title={point.getOrElse(null)}\n            className={cn(klassName, 'h9 w9')}>\n            <MaybeSigil patp={point} size={50} colors={colors} />\n          </div>\n        ))}\n      </>\n    );\n  };\n\n  return (\n    <div className={cn('flex justify-between', className)}>\n      {renderSigil(_acceptedPoints, ['#000000', '#FFFFFF'])}\n      {renderSigil(_pendingPoints, ['#ee892b', '#FFFFFF'])}\n      {renderSigil(empty, [], 'b1 b-gray3 b-dashed')}\n    </div>\n  );\n};\n\nexport default InviteSigilList;\n","import { usePointCache } from 'store/pointCache';\n\nexport default function useInvites(point) {\n  const { getInvites } = usePointCache();\n\n  return getInvites(point);\n}\n","import usePermissionsForPoint from './usePermissionsForPoint';\nimport { useWallet } from 'store/wallet';\nimport { usePointCursor } from 'store/pointCursor';\n\nexport default function useCurrentPermissions() {\n  const { wallet } = useWallet();\n  const { pointCursor } = usePointCursor();\n\n  const _address = wallet.matchWith({\n    Nothing: () => '',\n    Just: p => p.value.address,\n  });\n\n  const _point = pointCursor.getOrElse(null);\n\n  return usePermissionsForPoint(_address, _point);\n}\n","import { useEffect } from 'react';\n\nfunction onBeforeUnload(e) {\n  e.preventDefault();\n\n  e.returnValue = '';\n}\n\nexport default function useBlockWindowClose() {\n  return useEffect(() => {\n    window.addEventListener('beforeunload', onBeforeUnload);\n\n    return function cleanup() {\n      window.removeEventListener('beforeunload', onBeforeUnload);\n    };\n  });\n}\n\nexport function useConditionalBlockWindowClose(condition) {\n  return useEffect(() => {\n    if (condition) {\n      window.addEventListener('beforeunload', onBeforeUnload);\n    } else {\n      window.removeEventListener('beforeunload', onBeforeUnload);\n    }\n\n    return function cleanup() {\n      if (condition) {\n        window.removeEventListener('beforeunload', onBeforeUnload);\n      }\n    };\n  });\n}\n","//NOTE if accessing this in a localhost configuration fails with \"CORS request\n//     did not succeed\", you might need to visit localhost:3001 or whatever\n//     explicitly and tell your browser that's safe to access.\n//     https://stackoverflow.com/a/53011185/1334324\nimport { isRopsten } from './flags';\n\nconst port = isRopsten ? '3012' : '3002';\nconst baseUrl = `https://onboarding-emails.urbit.org:${port}`;\n\nfunction sendRequest(where, what) {\n  return new Promise((resolve, reject) => {\n    fetch(baseUrl + where, {\n      method: 'POST',\n      cache: 'no-cache',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(what),\n    })\n      .then(response => {\n        if (response.ok) {\n          resolve(response.json());\n        } else {\n          reject(response);\n        }\n      })\n      .catch(reject);\n  });\n}\n\nasync function hasReceived(recipient) {\n  const res = await sendRequest('/has-received', { recipient });\n  return res.hasReceived;\n}\n\nfunction sendMail(recipient, ticket, sender, message, tx) {\n  return sendRequest('/send-ticket', {\n    recipient,\n    ticket,\n    sender,\n    message,\n    tx,\n  });\n}\n\nexport { hasReceived, sendMail };\n","import { useCallback, useRef } from 'react';\n\nimport { hasReceived, sendMail } from './inviteMail';\nimport { timeout } from './timeout';\n\nconst STUB_MAILER = process.env.REACT_APP_STUB_MAILER === 'true';\n\nexport default function useMailer() {\n  const cache = useRef({});\n\n  const getHasReceived = useCallback(\n    async email => {\n      if (!cache.current[email]) {\n        if (STUB_MAILER) {\n          await timeout(350); // simulate request\n          cache.current[email] = false;\n        } else {\n          cache.current[email] = await hasReceived(email);\n        }\n      }\n\n      return cache.current[email];\n    },\n    [cache]\n  );\n\n  // prefix to avoid clobbering sendMail import\n  // also throws if return value is false\n  const _sendMail = useCallback(\n    async (email, ticket, sender, message, rawTx) => {\n      if (STUB_MAILER) {\n        console.log(`${email} - ${ticket}`);\n        await timeout(Math.random() * 1000); // simulate request with randomness\n        return true;\n      }\n\n      const success = await sendMail(email, ticket, sender, message, rawTx);\n      if (!success) {\n        throw new Error('Failed to send mail');\n      }\n    },\n    []\n  );\n\n  return { getHasReceived, sendMail: _sendMail };\n}\n","import { useState, useCallback, useEffect } from 'react';\nimport { toBN } from 'web3-utils';\nimport * as azimuth from 'azimuth-js';\nimport { FORM_ERROR } from 'final-form';\n\nimport * as wg from 'lib/walletgen';\nimport * as tank from 'lib/tank';\nimport * as need from 'lib/need';\nimport { GAS_LIMITS } from 'lib/constants';\nimport {\n  signTransaction,\n  sendSignedTransaction,\n  waitForTransactionConfirm,\n  hexify,\n} from 'lib/txn';\nimport useGasPrice from 'lib/useGasPrice';\nimport { safeToWei } from 'lib/lib';\n\nimport { useNetwork } from 'store/network';\nimport { useWallet } from 'store/wallet';\nimport { usePointCursor } from 'store/pointCursor';\nimport { usePointCache } from 'store/pointCache';\n\nimport { WARNING } from 'form/helpers';\n\nconst GAS_LIMIT = GAS_LIMITS.GIFT_PLANET;\nconst STATUS = {\n  INPUT: 'INPUT',\n  SENDING: 'SENDING',\n  SUCCESS: 'SUCCESS',\n  FAILURE: 'FAILURE',\n};\n\nconst useInviter = () => {\n  const { contracts, web3, networkType } = useNetwork();\n  const { wallet, walletType, walletHdPath, authToken } = useWallet();\n  const { pointCursor } = usePointCursor();\n  const { syncInvites } = usePointCache();\n  const { gasPrice } = useGasPrice();\n\n  const point = need.point(pointCursor);\n\n  const [needFunds, setNeedFunds] = useState(null);\n  const [invites, setInvites] = useState([]);\n\n  const [progress, setProgress] = useState(0);\n  const [txStatus, setTxStatus] = useState(STATUS.INPUT);\n\n  const isDone = txStatus === STATUS.SUCCESS;\n  useEffect(() => {\n    if (isDone) {\n      syncInvites(point);\n    }\n  }, [isDone, syncInvites, point]);\n\n  const resetInvites = useCallback(() => {\n    setProgress(0);\n    setInvites([]);\n    setTxStatus(STATUS.INPUT);\n  }, [setProgress, setInvites, setTxStatus]);\n\n  //TODO  split this out into smaller callbacks within useInviter\n  const generateInvites = useCallback(\n    async numInvites => {\n      const _contracts = contracts.getOrElse(null);\n      const _web3 = web3.getOrElse(null);\n      const _wallet = wallet.getOrElse(null);\n      const _authToken = authToken.getOrElse(null);\n      if (!_contracts || !_web3 || !_wallet || !_authToken) {\n        // not using need because we want a custom error\n        throw new Error('Internal Error: Missing Contracts/Web3/Wallet');\n      }\n\n      const nonce = await _web3.eth.getTransactionCount(_wallet.address);\n      const chainId = await _web3.eth.net.getId();\n      const planets = await azimuth.delegatedSending.getPlanetsToSend(\n        _contracts,\n        point,\n        numInvites\n      );\n\n      setTxStatus(STATUS.SENDING);\n      // account for the race condition where invites got used up while we were\n      // composing our target list\n      if (planets.length < numInvites) {\n        // resync invites to the cache, since they're out of date\n        syncInvites(point);\n\n        setTxStatus(STATUS.FAILURE);\n\n        return {\n          errors: {\n            [FORM_ERROR]:\n              `Can currently only send ${planets.length} invites. ` +\n              `Please remove invites until you are within the limit.`,\n          },\n        };\n      }\n\n      // NB(shrugs) - must be processed in serial because main thread, etc\n      let signedInvites = [];\n      for (let i = 0; i < numInvites; i++) {\n        setProgress(x => x + 1);\n        try {\n          const planet = planets[i];\n\n          const {\n            ticket,\n            owner,\n          } = await wg.generateTemporaryDeterministicWallet(planet, _authToken);\n\n          const inviteTx = azimuth.delegatedSending.sendPoint(\n            _contracts,\n            point,\n            planet,\n            owner.keys.address\n          );\n\n          const signedTx = await signTransaction({\n            wallet: _wallet,\n            walletType,\n            walletHdPath,\n            networkType,\n            chainId,\n            nonce: nonce + i,\n            // TODO: ^ make a useTransactionSigner to encapsulate this logic\n            txn: inviteTx,\n            gasPrice: gasPrice.toFixed(), // expects string gwei\n            gasLimit: GAS_LIMIT.toFixed(),\n          });\n\n          const rawTx = hexify(signedTx.serialize());\n\n          signedInvites.push({ ticket, signedTx, rawTx });\n        } catch (error) {\n          console.error(error);\n          return {\n            errors: {\n              [WARNING]: `There was an error while generating wallets.`,\n            },\n          };\n        }\n      }\n\n      const totalCost = toBN(GAS_LIMIT)\n        .mul(toBN(gasPrice))\n        .mul(toBN(numInvites));\n      const tankWasUsed = await tank.ensureFundsFor(\n        _web3,\n        point,\n        _wallet.address,\n        walletType,\n        safeToWei(totalCost, 'gwei'),\n        signedInvites.map(si => si.rawTx),\n        (address, minBalance, balance) =>\n          setNeedFunds({ address, minBalance, balance }),\n        () => setNeedFunds(undefined)\n      );\n\n      let inviteErrors = [];\n      let confirmedInvites = [];\n      const txAndMailings = signedInvites.map(async invite => {\n        try {\n          const txHash = await sendSignedTransaction(\n            _web3,\n            invite.signedTx,\n            tankWasUsed\n          );\n\n          await waitForTransactionConfirm(_web3, txHash);\n          confirmedInvites.push(invite);\n        } catch (error) {\n          console.error('Error sending invite tx:', error);\n          if (typeof error === 'string') {\n            inviteErrors.push(error);\n          } else if (typeof error === 'object' && error.message) {\n            inviteErrors.push(error.message);\n          }\n          return;\n        }\n      });\n\n      await Promise.all(txAndMailings);\n\n      setTxStatus(STATUS.SUCCESS);\n      setInvites(confirmedInvites);\n\n      if (inviteErrors.length > 0) {\n        return {\n          errors: {\n            [FORM_ERROR]: ['Error sending invites: ', ...inviteErrors],\n          },\n        };\n      }\n\n      return { invites: confirmedInvites };\n    },\n    [\n      authToken,\n      contracts,\n      gasPrice,\n      networkType,\n      point,\n      syncInvites,\n      wallet,\n      walletHdPath,\n      walletType,\n      web3,\n    ]\n  );\n\n  return {\n    progress,\n    txStatus,\n    needFunds,\n    invites,\n    generateInvites,\n    resetInvites,\n  };\n};\n\nexport default useInviter;\n","import React, { useState, useCallback } from 'react';\nimport { Flex, ErrorText } from 'indigo-react';\nimport cn from 'classnames';\nimport { useField } from 'react-final-form';\nimport { useFieldArray } from 'react-final-form-arrays';\n\nimport { hasErrors } from 'form/validators';\n\nconst Chip = ({ onDelete, disabled, name }) => {\n  const { input } = useField(name, { subscription: { value: true } });\n  return (\n    <Flex\n      className={cn('r32 ph2 m1 flex-center h7', {\n        'bg-gray2': !disabled,\n        'bg-gray1 gray4': disabled,\n      })}>\n      <Flex.Item>{input.value}</Flex.Item>\n      <Flex.Item\n        onClick={disabled ? undefined : onDelete}\n        className=\"ml1 f6 pointer-hover\">\n        ✗\n      </Flex.Item>\n    </Flex>\n  );\n};\n\nconst EmailChipInput = ({ className, name, label, disabled }) => {\n  const {\n    fields,\n    meta: { error, active },\n  } = useFieldArray(name, { subscription: { error: true, active: true } });\n\n  const [value, setValue] = useState('');\n\n  const handleChange = useCallback(\n    event => {\n      event.preventDefault();\n      setValue(event.target.value);\n    },\n    [setValue]\n  );\n\n  const addToChips = useCallback(() => {\n    fields.concat(value.split(/[\\n\\t, ]+/));\n    setValue('');\n  }, [value, fields, setValue]);\n\n  const handleKeyDown = useCallback(\n    event => {\n      if (['Enter', 'Tab', ',', ' '].includes(event.key) && value !== '') {\n        event.preventDefault();\n        addToChips();\n      } else if ('Backspace' === event.key && value === '') {\n        event.preventDefault();\n        fields.pop();\n      } else if (disabled) {\n        event.preventDefault();\n      }\n    },\n    [fields, value, disabled, addToChips]\n  );\n\n  const handleDelete = useCallback(\n    idx => () => {\n      fields.remove(idx);\n    },\n    [fields]\n  );\n\n  const handleBlur = useCallback(\n    e => {\n      e.preventDefault();\n      if (value !== '') {\n        addToChips();\n      }\n    },\n    [addToChips, value]\n  );\n\n  const hasError = hasErrors(error);\n\n  return (\n    <Flex col className={className}>\n      {label && (\n        <Flex.Item as=\"label\" className={cn('f6 lh-tall')} htmlFor={name}>\n          {label}\n        </Flex.Item>\n      )}\n      <Flex.Item\n        className={cn('flex b1 flex-wrap', {\n          'b-green2': active && !disabled && !hasError,\n          'b-red3': active && !disabled && hasError,\n        })}>\n        {fields.map((name, idx) => (\n          <Chip\n            key={idx}\n            name={name}\n            disabled={disabled}\n            onDelete={handleDelete(idx)}\n          />\n        ))}\n\n        <input\n          type=\"textarea\"\n          className=\"mv1 mh2 h7 b-none flex1\"\n          placeholder=\"Enter an email address\"\n          value={value}\n          onChange={handleChange}\n          onKeyDown={handleKeyDown}\n          onBlur={handleBlur}\n        />\n      </Flex.Item>\n      {error && (\n        <Flex.Item as={ErrorText} className=\"mv1\">\n          {error}\n        </Flex.Item>\n      )}\n    </Flex>\n  );\n};\n\nexport default EmailChipInput;\n","import React, { useState, useCallback, useMemo } from 'react';\nimport { Grid } from 'indigo-react';\nimport { FORM_ERROR } from 'final-form';\nimport * as ob from 'urbit-ob';\nimport { uniq, zip, compact, isEqual } from 'lodash';\n\nimport { usePointCursor } from 'store/pointCursor';\n\nimport * as need from 'lib/need';\nimport useMailer from 'lib/useMailer';\nimport { pluralize } from 'lib/pluralize';\nimport useInviter from 'lib/useInviter';\n\nimport {\n  composeValidator,\n  hasErrors,\n  buildEmailValidator,\n  buildArrayValidator,\n} from 'form/validators';\nimport EmailChipInput from 'form/EmailChipInput';\nimport FormError from 'form/FormError';\nimport SubmitButton from 'form/SubmitButton';\nimport BridgeForm from 'form/BridgeForm';\n\nimport NeedFundsNotice from 'components/NeedFundsNotice';\nimport ProgressButton from 'components/ProgressButton';\n\nconst HAS_RECEIVED_TEXT = 'This email has already received an invite: ';\n\nconst STATUS = {\n  INPUT: 'INPUT',\n  SENDING: 'SENDING',\n  SUCCESS: 'SUCCESS',\n  FAILURE: 'FAILURE',\n};\n\nconst InviteMail = ({ setSubmitting }) => {\n  const {\n    progress,\n    txStatus,\n    needFunds,\n    generateInvites,\n    resetInvites,\n  } = useInviter();\n\n  const { sendMail, getHasReceived } = useMailer();\n\n  const [status, setStatus] = useState(STATUS.INPUT);\n\n  const [count, setCount] = useState(0);\n  const canInput = status === STATUS.INPUT;\n  const isSending = txStatus === STATUS.SENDING || status === STATUS.SENDING;\n  const isDone = status === STATUS.SUCCESS;\n  const isFailed = status === STATUS.FAILED;\n\n  const { pointCursor } = usePointCursor();\n  const point = need.point(pointCursor);\n\n  const sendInvites = useCallback(\n    async (emails, invites) => {\n      const mailingErrors = compact(\n        await Promise.all(\n          zip(emails, invites).map(([email, invite]) =>\n            sendMail(email, invite.ticket, ob.patp(point), '', invite.rawTx)\n              .then(() => null)\n              .catch(\n                () => `Sending ticket ${invite.ticket} to ${email} failed.`\n              )\n          )\n        )\n      ).join(', ');\n      if (mailingErrors.length) {\n        return { [FORM_ERROR]: mailingErrors };\n      }\n    },\n    [point, sendMail]\n  );\n\n  const onSubmit = useCallback(\n    async (values, form) => {\n      const emailCount = values.emails.length;\n      setCount(emailCount);\n      setStatus(STATUS.SENDING);\n      setSubmitting(true);\n      const { errors, invites } = await generateInvites(emailCount);\n      if (errors) {\n        setStatus(STATUS.FAILED);\n        setSubmitting(false);\n        return errors;\n      }\n      const mailErrors = await sendInvites(values.emails, invites);\n      if (mailErrors) {\n        console.log(mailErrors);\n        setStatus(STATUS.FAILED);\n        setSubmitting(false);\n        return mailErrors;\n      }\n      setSubmitting(false);\n      setStatus(STATUS.SUCCESS);\n      setTimeout(() => {\n        setStatus(STATUS.INPUT);\n        resetInvites();\n        form.reset();\n      }, 1500);\n    },\n    [setSubmitting, generateInvites, sendInvites, resetInvites]\n  );\n\n  const validateHasReceived = useCallback(\n    async email => {\n      const hasReceived = await getHasReceived(email);\n      if (hasReceived) {\n        return HAS_RECEIVED_TEXT + email;\n      }\n    },\n    [getHasReceived]\n  );\n\n  const buttonText = useCallback(() => {\n    switch (status) {\n      case STATUS.INPUT:\n        return 'Add to Invite Group';\n      case STATUS.SENDING:\n        return `Sending ${pluralize(count, 'Invite')}...`;\n      case STATUS.SUCCESS:\n        return `✓ ${pluralize(count, 'Invite')} sent`;\n      case STATUS.FAILURE:\n      default:\n        return 'Error';\n    }\n  }, [status, count]);\n\n  const renderButton = useCallback(\n    handleSubmit => {\n      if (canInput) {\n        return (\n          <Grid.Item full as={SubmitButton} handleSubmit={handleSubmit}>\n            {buttonText()}\n          </Grid.Item>\n        );\n      }\n\n      if (isSending) {\n        const percentProgress = progress / count;\n        return (\n          <Grid.Item\n            full\n            as={ProgressButton}\n            className=\"mt4\"\n            solid\n            disabled\n            success\n            progress={percentProgress}>\n            {buttonText(count)}\n          </Grid.Item>\n        );\n      }\n      if (isDone) {\n        return (\n          <Grid.Item full className=\"mt4 p3 bg-green3 white f5\">\n            {buttonText(count)}\n          </Grid.Item>\n        );\n      }\n      if (isFailed) {\n        return (\n          <Grid.Item full className=\"mt4 p3 bg-red3 white f5\">\n            {buttonText(count)}\n          </Grid.Item>\n        );\n      }\n\n      return null;\n    },\n    [buttonText, isDone, isFailed, isSending, canInput, count, progress]\n  );\n\n  const validateForm = useCallback((values, errors) => {\n    if (hasErrors(errors)) {\n      return errors;\n    }\n\n    // check for email uniqenesss\n    const emails = values.emails.filter(d => !!d);\n    if (uniq(emails).length !== emails.length) {\n      return { [FORM_ERROR]: 'Duplicate email.' };\n    }\n  }, []);\n\n  const validate = useMemo(\n    () =>\n      composeValidator(\n        {\n          emails: buildArrayValidator(buildEmailValidator(validateHasReceived)),\n        },\n        validateForm\n      ),\n    [validateHasReceived, validateForm]\n  );\n\n  const initialValues = { emails: [] };\n  return (\n    <Grid.Item full as={Grid}>\n      <BridgeForm\n        validate={validate}\n        initialValues={initialValues}\n        initialValuesEqual={isEqual}\n        onSubmit={onSubmit}>\n        {({ handleSubmit, values }) => (\n          <>\n            <Grid.Item full as={EmailChipInput} name=\"emails\" className=\"mt4\" />\n            {renderButton(handleSubmit)}\n\n            <Grid.Item full as={FormError} />\n            {needFunds && (\n              <Grid.Item full as={NeedFundsNotice} {...needFunds} />\n            )}\n          </>\n        )}\n      </BridgeForm>\n    </Grid.Item>\n  );\n};\n\nexport default InviteMail;\n","import React, { useCallback, useState } from 'react';\nimport { Grid, ErrorText, Flex } from 'indigo-react';\nimport { get } from 'lodash';\nimport { FORM_ERROR } from 'final-form';\n\nimport useCopiable from 'lib/useCopiable';\nimport useInviter from 'lib/useInviter';\n\nimport ProgressButton from 'components/ProgressButton';\nimport { ForwardButton } from 'components/Buttons';\nimport NeedFundsNotice from 'components/NeedFundsNotice';\n\nimport { hasErrors } from 'form/validators';\nimport { WARNING } from 'form/helpers';\nconst STATUS = {\n  INPUT: 'INPUT',\n  SENDING: 'SENDING',\n  SUCCESS: 'SUCCESS',\n  FAILURE: 'FAILURE',\n};\n\nconst InviteUrl = ({ setSubmitting }) => {\n  const { txStatus, needFunds, invites, generateInvites } = useInviter();\n\n  const [error, setError] = useState();\n\n  const generateInvite = useCallback(async () => {\n    setSubmitting(true);\n    const { errors } = await generateInvites(1);\n    if (hasErrors(errors)) {\n      setError(errors);\n    }\n    setSubmitting(false);\n  }, [generateInvites, setSubmitting]);\n\n  const renderGenerateButton = useCallback(() => {\n    if (error) {\n      return (\n        <Grid.Item full className=\"mt4 p3 bg-red3 white f5\">\n          Error generating invite\n        </Grid.Item>\n      );\n    }\n    switch (txStatus) {\n      case STATUS.INPUT:\n        return (\n          <Grid.Item\n            solid\n            full\n            className=\"mt4\"\n            as={ForwardButton}\n            onClick={() => generateInvite()}>\n            Generate Invite URL\n          </Grid.Item>\n        );\n      case STATUS.SENDING:\n        return (\n          <Grid.Item\n            full\n            as={ProgressButton}\n            className=\"mt4\"\n            solid\n            disabled\n            success\n            progress={0.5}>\n            Generating Invite URL\n          </Grid.Item>\n        );\n      default:\n        return null;\n    }\n  }, [txStatus, error, generateInvite]);\n\n  const url = `https://bridge.urbit.org/#${get(invites, '[0].ticket', '').slice(\n    1\n  )}`;\n\n  const [doCopy, didCopy] = useCopiable(url);\n\n  return (\n    <Grid.Item full as={Grid} gap={3}>\n      {invites.length > 0 && (\n        <Grid.Item as={Flex} full col>\n          <Flex.Item full className=\"b-gray3 b1 mt4 mb1 p1 flex flex-center\">\n            <div className=\"flex1 ml1 f6\">{url}</div>\n            <Flex.Item\n              className=\"p2 bg-black white pointer-hover f6\"\n              onClick={() => doCopy()}>\n              {didCopy ? 'Copied' : 'Copy'}\n            </Flex.Item>\n          </Flex.Item>\n          <Flex.Item full className=\"f6 mb4 gray5\">\n            Your invite link expires after consumption.\n          </Flex.Item>\n        </Grid.Item>\n      )}\n      {invites.length === 0 && renderGenerateButton()}\n      {needFunds && <Grid.Item full as={NeedFundsNotice} {...needFunds} />}\n      {error && (\n        <Grid.Item as={ErrorText}>\n          {error[FORM_ERROR] || error[WARNING]}\n        </Grid.Item>\n      )}\n    </Grid.Item>\n  );\n};\n\nexport default InviteUrl;\n","import React, { useState, useCallback } from 'react';\nimport { Grid } from 'indigo-react';\n\nimport { useConditionalBlockWindowClose } from 'lib/useBlockWindowClose';\n\nimport Tabs from 'components/Tabs';\n\nimport InviteMail from 'views/Invite/Email';\nimport InviteUrl from 'views/Invite/Url';\n\nconst Inviter = () => {\n  const [tab, setTab] = useState(NAMES.MAIL);\n  const [submitting, setSubmitting] = useState(false);\n\n  useConditionalBlockWindowClose(submitting);\n  const onTabChange = useCallback(\n    newTab => {\n      if (!submitting) {\n        setTab(newTab);\n      }\n    },\n    [submitting, setTab]\n  );\n  return (\n    <Grid.Item\n      full\n      as={Tabs}\n      center\n      className=\"flex1\"\n      views={VIEWS}\n      options={OPTIONS}\n      currentTab={tab}\n      onTabChange={onTabChange}\n      setSubmitting={setSubmitting}\n    />\n  );\n};\n\nconst NAMES = {\n  MAIL: 'MAIL',\n  URL: 'URL',\n};\n\nconst VIEWS = {\n  [NAMES.MAIL]: InviteMail,\n  [NAMES.URL]: InviteUrl,\n};\n\nconst OPTIONS = [\n  { text: 'Email', value: NAMES.MAIL },\n  { text: 'URL', value: NAMES.URL },\n];\n\nexport default Inviter;\n","import React, { useCallback, useState } from 'react';\nimport cn from 'classnames';\nimport { Just } from 'folktale/maybe';\nimport { Grid, Flex, Button } from 'indigo-react';\nimport { azimuth } from 'azimuth-js';\n\nimport { usePointCursor } from 'store/pointCursor';\nimport { useWallet } from 'store/wallet';\n\nimport View from 'components/View';\nimport Greeting from 'components/Greeting';\nimport Passport from 'components/Passport';\nimport Blinky, { matchBlinky } from 'components/Blinky';\nimport BarGraph from 'components/BarGraph';\nimport Chip from 'components/Chip';\nimport InviteSigilList from 'components/InviteSigilList';\nimport { ForwardButton } from 'components/Buttons';\n\nimport * as need from 'lib/need';\nimport useInvites from 'lib/useInvites';\nimport { useSyncExtras } from 'lib/useSyncPoints';\nimport useCurrentPermissions from 'lib/useCurrentPermissions';\nimport { useLocalRouter } from 'lib/LocalRouter';\n\nimport Inviter from 'views/Invite/Inviter';\nimport { usePointCache } from 'store/pointCache';\n\nfunction InviteForm({\n  showInviteForm,\n  setShowInviteForm,\n  acceptedInvites,\n  acceptedPoints,\n  availableInvites,\n  goCohort,\n  pendingPoints,\n  sentInvites,\n  showInvites,\n}) {\n  const _totalInvites =\n    sentInvites.getOrElse(0) + availableInvites.getOrElse(0);\n  const _pendingInvites = pendingPoints.getOrElse([]).length;\n\n  return (\n    <>\n      <Grid.Item cols={[1, 11]}>\n        Invite Group\n        <br />\n      </Grid.Item>\n\n      <Grid.Item\n        className={cn('t-right underline pointer-hover', {\n          gray4: sentInvites.getOrElse(0) === 0,\n        })}\n        onClick={goCohort}\n        cols={[11, 13]}>\n        View\n      </Grid.Item>\n      <Grid.Item full>\n        <Flex align=\"center\">\n          <Flex.Item>\n            {acceptedInvites.getOrElse(0)} / {_totalInvites}\n          </Flex.Item>\n          {_pendingInvites > 0 && (\n            <Flex.Item as={Chip} className=\"bg-yellow1 yellow4\">\n              {_pendingInvites} pending\n            </Flex.Item>\n          )}\n        </Flex>\n      </Grid.Item>\n\n      {showInvites && (\n        <>\n          <Grid.Item\n            full\n            as={BarGraph}\n            available={availableInvites}\n            sent={sentInvites}\n            accepted={acceptedInvites}\n          />\n          <Grid.Item\n            full\n            as={InviteSigilList}\n            pendingPoints={pendingPoints}\n            acceptedPoints={acceptedPoints}\n          />\n        </>\n      )}\n      {!showInvites && (\n        <>\n          <Grid.Item full className=\"b-gray4 b-dotted b1 self-center\">\n            <div className=\"p4 pv8 t-center gray4\">\n              Start your invite group by adding members\n            </div>\n          </Grid.Item>\n        </>\n      )}\n      {!showInviteForm && availableInvites.getOrElse(0) > 0 && (\n        <Grid.Item\n          full\n          solid\n          as={Button}\n          center\n          onClick={() => setShowInviteForm(true)}>\n          Add Members\n        </Grid.Item>\n      )}\n      {showInviteForm && <Inviter />}\n      <Grid.Item full className=\"mb2\" />\n    </>\n  );\n}\n\nexport default function Point() {\n  const { pop, push, names } = useLocalRouter();\n  const { pointCursor } = usePointCursor();\n\n  const { wallet, urbitWallet } = useWallet();\n  const point = need.point(pointCursor);\n\n  const { getResidents } = usePointCache();\n\n  const { residentCount, requestCount } = getResidents(point);\n\n  const {\n    isParent,\n    isActiveOwner,\n    canManage,\n    canSpawn,\n    canVote,\n  } = useCurrentPermissions();\n\n  const canBitcoin = Just.hasInstance(urbitWallet);\n\n  // fetch the invites for the current cursor\n  const invites = useInvites(point);\n  const {\n    availableInvites,\n    sentInvites,\n    acceptedInvites,\n    pendingPoints,\n    acceptedPoints,\n  } = invites;\n\n  const showInvites = !(\n    acceptedInvites.getOrElse(0) === 0 && sentInvites.getOrElse(0) === 0\n  );\n\n  const hasInvites = showInvites || availableInvites.getOrElse(0) !== 0;\n\n  const loadedInvites = Just.hasInstance(availableInvites);\n  //\n  // availableInvites.getOrElse(0) === 0\n\n  const goSenate = useCallback(() => push(names.SENATE), [push, names]);\n\n  const goCohort = useCallback(() => push(names.INVITE_COHORT), [push, names]);\n\n  const goUrbitOS = useCallback(() => push(names.URBIT_OS), [push, names]);\n\n  const goBitcoin = useCallback(() => push(names.BITCOIN), [push, names]);\n\n  const goUrbitID = useCallback(() => push(names.URBIT_ID), [push, names]);\n\n  const goResidents = useCallback(() => push(names.RESIDENTS), [push, names]);\n\n  const goPartiesSetPoolSize = useCallback(\n    () => push(names.PARTY_SET_POOL_SIZE),\n    [push, names]\n  );\n\n  const goIssuePoint = useCallback(() => push(names.ISSUE_CHILD), [\n    names.ISSUE_CHILD,\n    push,\n  ]);\n\n  const isPlanet = azimuth.getPointSize(point) === azimuth.PointSize.Planet;\n\n  const [showInviteForm, setShowInviteForm] = useState(false);\n\n  const inviteButton = (() => {\n    if (azimuth.getPointSize(point) === azimuth.PointSize.Star) {\n      return (\n        <>\n          <Grid.Item\n            full\n            as={ForwardButton}\n            disabled={!isActiveOwner}\n            onClick={goPartiesSetPoolSize}>\n            Manage Invite Pools\n          </Grid.Item>\n          <Grid.Divider />\n        </>\n      );\n    }\n\n    return null;\n  })();\n\n  const senateButton = (() => {\n    if (azimuth.getPointSize(point) !== azimuth.PointSize.Galaxy) {\n      return null;\n    }\n    return (\n      <>\n        <Grid.Item\n          full\n          as={ForwardButton}\n          disabled={!canVote}\n          onClick={goSenate}>\n          Senate\n        </Grid.Item>\n        <Grid.Divider />\n      </>\n    );\n  })();\n\n  // sync the current cursor\n  useSyncExtras([point]);\n\n  const address = need.addressFromWallet(wallet);\n\n  const _requestCount = requestCount.getOrElse(0);\n\n  return (\n    <View pop={pop} inset>\n      <Greeting point={point} />\n      <Passport\n        point={Just(point)}\n        address={Just(address)}\n        animationMode={'slide'}\n      />\n      <Grid gap={3}>\n        {isParent && (\n          <Grid.Item\n            full\n            as={Flex}\n            justify=\"between\"\n            onClick={goResidents}\n            className=\"mv1 pointer\">\n            <Flex.Item>\n              Residents{' '}\n              <span className=\"gray3\">{matchBlinky(residentCount)}</span>\n            </Flex.Item>\n            {_requestCount !== 0 && (\n              <Flex.Item className=\"f7 bg-gray2 h3 pv1 ph2 br-full r-full text-center\">\n                {_requestCount} PENDING\n              </Flex.Item>\n            )}\n          </Grid.Item>\n        )}\n        {isPlanet && hasInvites && (\n          <InviteForm\n            showInviteForm={showInviteForm}\n            setShowInviteForm={setShowInviteForm}\n            acceptedInvites={acceptedInvites}\n            acceptedPoints={acceptedPoints}\n            availableInvites={availableInvites}\n            goCohort={goCohort}\n            pendingPoints={pendingPoints}\n            sentInvites={sentInvites}\n            showInvites={showInvites}\n          />\n        )}\n        {!loadedInvites && isPlanet && (\n          <Grid.Item className=\"mv2\" full>\n            Invite Group <Blinky />\n          </Grid.Item>\n        )}\n      </Grid>\n      <Grid className=\"pt2\">\n        <Grid.Divider />\n        {inviteButton}\n        <Grid.Item\n          full\n          as={ForwardButton}\n          disabled={!canManage}\n          onClick={goUrbitID}\n          className=\"mt1\"\n          detail=\"Identity and security settings\">\n          ID\n        </Grid.Item>\n        <Grid.Divider />\n        <Grid.Item\n          full\n          as={ForwardButton}\n          disabled={!canManage}\n          className=\"mt1\"\n          detail=\"Urbit OS Settings\"\n          onClick={goUrbitOS}>\n          OS\n        </Grid.Item>\n        <Grid.Divider />\n        <Grid.Item\n          full\n          as={ForwardButton}\n          disabled={!canBitcoin}\n          className=\"mt1\"\n          detail=\"Bitcoin management\"\n          onClick={goBitcoin}>\n          Bitcoin\n        </Grid.Item>\n        <Grid.Divider />\n        {isParent && (\n          <>\n            <Grid.Item\n              full\n              as={ForwardButton}\n              disabled={!canSpawn}\n              onClick={goIssuePoint}>\n              Issue Point\n            </Grid.Item>\n            <Grid.Divider />\n          </>\n        )}\n        {senateButton}\n      </Grid>\n    </View>\n  );\n}\n","import { useEffect } from 'react';\n\n// https://overreacted.io/a-complete-guide-to-useeffect/\nexport default function useLifecycle(fn) {\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  return useEffect(fn, []);\n}\n","import React, { useCallback, useEffect, useMemo } from 'react';\nimport { Just, Nothing } from 'folktale/maybe';\nimport { Grid, H5, HelpText, LinkButton, Flex } from 'indigo-react';\nimport { get } from 'lodash';\n\nimport { useHistory } from 'store/history';\nimport { useWallet } from 'store/wallet';\nimport { usePointCache } from 'store/pointCache';\nimport { usePointCursor } from 'store/pointCursor';\nimport { useStarReleaseCache } from 'store/starRelease';\n\nimport * as need from 'lib/need';\nimport { isZeroAddress, abbreviateAddress } from 'lib/utils/address';\nimport useIsEclipticOwner from 'lib/useIsEclipticOwner';\nimport { useSyncDetails } from 'lib/useSyncPoints';\nimport useRejectedIncomingPointTransfers from 'lib/useRejectedIncomingPointTransfers';\nimport { pluralize } from 'lib/pluralize';\nimport newGithubIssueUrl from 'new-github-issue-url';\n\nimport View from 'components/View';\nimport Blinky from 'components/Blinky';\nimport Passport from 'components/Passport';\nimport Footer from 'components/Footer';\nimport { ForwardButton } from 'components/Buttons';\nimport CopiableAddress from 'components/CopiableAddress';\nimport NavHeader from 'components/NavHeader';\n\nconst maybeGetResult = (obj, key, defaultValue) =>\n  obj.matchWith({\n    Nothing: () => defaultValue,\n    Just: p =>\n      p.value.matchWith({\n        Ok: r => get(r.value, key, defaultValue),\n        Error: e => defaultValue,\n      }),\n  });\n\nconst hasTransferProxy = details => !isZeroAddress(details.transferProxy);\n\nconst PointList = function({ points, className, actions, ...rest }) {\n  const { setPointCursor } = usePointCursor();\n  const { push, names } = useHistory();\n\n  return (\n    <Grid gap={3} className={className}>\n      {points.map((point, i) => (\n        <Grid.Item\n          key={point}\n          className={`full half-${(i % 2) + 1}-md half-${(i % 2) + 1}-lg`}>\n          <Flex col>\n            <Passport.Mini\n              point={point}\n              className=\"pointer\"\n              onClick={() => {\n                setPointCursor(Just(point));\n                push(names.POINT);\n              }}\n              {...rest}\n            />\n            {actions && (\n              <Flex.Item className=\"mt2\">{actions(point, i)}</Flex.Item>\n            )}\n          </Flex>\n        </Grid.Item>\n      ))}\n    </Grid>\n  );\n};\n\nfunction ActionButtons({ actions = [] }) {\n  return (\n    <Flex row>\n      {actions.map(action => (\n        <Flex.Item\n          key={action.text}\n          as={LinkButton}\n          className=\"mr3\"\n          onClick={action.onClick}>\n          {action.text}\n        </Flex.Item>\n      ))}\n    </Flex>\n  );\n}\n\nexport default function Points() {\n  const { wallet } = useWallet();\n  const { pop, push, popAndPush, names } = useHistory();\n  const { setPointCursor } = usePointCursor();\n  const { controlledPoints, getDetails } = usePointCache();\n  const isEclipticOwner = useIsEclipticOwner();\n  const [\n    rejectedPoints,\n    addRejectedPoint,\n  ] = useRejectedIncomingPointTransfers();\n  const { syncStarReleaseDetails, starReleaseDetails } = useStarReleaseCache();\n\n  const maybeOutgoingPoints = useMemo(\n    () =>\n      controlledPoints.chain(points =>\n        points.matchWith({\n          Error: () => Nothing(),\n          Ok: c => {\n            const points = c.value.ownedPoints.map(point =>\n              getDetails(point).chain(details =>\n                Just({ point: point, has: hasTransferProxy(details) })\n              )\n            );\n            // if we have details for every point,\n            // return the array of pending transfers.\n            if (points.every(p => Just.hasInstance(p))) {\n              const outgoing = points\n                .filter(p => p.value.has)\n                .map(p => p.value.point);\n              return Just(outgoing);\n            } else {\n              return Nothing();\n            }\n          },\n        })\n      ),\n    [getDetails, controlledPoints]\n  );\n\n  // if we can only interact with a single point, forget about the existence\n  // of this page and jump to the point page.\n  // if there are any pending transfers, incoming or outgoing, stay on this\n  // page, because those can only be completed/cancelled here.\n  useEffect(() => {\n    if (\n      Nothing.hasInstance(maybeOutgoingPoints) ||\n      Nothing.hasInstance(starReleaseDetails)\n    ) {\n      return;\n    }\n    controlledPoints.matchWith({\n      Nothing: () => null,\n      Just: r => {\n        r.value.matchWith({\n          Error: () => null,\n          Ok: c => {\n            let all = [\n              ...c.value.ownedPoints,\n              ...c.value.votingPoints,\n              ...c.value.managingPoints,\n              ...c.value.spawningPoints,\n            ];\n            const incoming = c.value.incomingPoints.filter(\n              p => !rejectedPoints.includes(p)\n            );\n            if (\n              all.length === 1 &&\n              incoming.length === 0 &&\n              maybeOutgoingPoints.value.length === 0 &&\n              (starReleaseDetails.value === null ||\n                starReleaseDetails.value.total === 0)\n            ) {\n              setPointCursor(Just(all[0]));\n              popAndPush(names.POINT);\n            }\n          },\n        });\n      },\n    });\n  }, [\n    controlledPoints,\n    rejectedPoints,\n    maybeOutgoingPoints,\n    setPointCursor,\n    popAndPush,\n    names,\n    starReleaseDetails,\n  ]);\n\n  const address = need.addressFromWallet(wallet);\n\n  const loading = Nothing.hasInstance(controlledPoints);\n\n  const ownedPoints = maybeGetResult(controlledPoints, 'ownedPoints', []);\n  const incomingPoints = maybeGetResult(\n    controlledPoints,\n    'incomingPoints',\n    []\n  ).filter(point => !rejectedPoints.includes(point));\n  const managingPoints = maybeGetResult(controlledPoints, 'managingPoints', []);\n  const votingPoints = maybeGetResult(controlledPoints, 'votingPoints', []);\n  const spawningPoints = maybeGetResult(controlledPoints, 'spawningPoints', []);\n  const outgoingPoints = maybeOutgoingPoints.getOrElse([]);\n\n  const allPoints = [\n    ...ownedPoints.filter(p => !outgoingPoints.includes(p)),\n    ...managingPoints,\n    ...votingPoints,\n    ...spawningPoints,\n  ];\n\n  const displayEmptyState =\n    !loading && incomingPoints.length === 0 && allPoints.length === 0;\n\n  const starReleasing = starReleaseDetails\n    .map(s => (s ? s.total > 0 : false))\n    .getOrElse(false);\n\n  useEffect(() => {\n    syncStarReleaseDetails();\n  }, [syncStarReleaseDetails]);\n\n  // sync display details for known points\n  useSyncDetails(ownedPoints);\n\n  const goCreateGalaxy = useCallback(() => push(names.CREATE_GALAXY), [\n    names.CREATE_GALAXY,\n    push,\n  ]);\n\n  const goStarRelease = useCallback(() => push(names.STAR_RELEASE), [\n    names.STAR_RELEASE,\n    push,\n  ]);\n\n  //  if we got an error result, we should display it, instead of showing\n  //  a potentially inaccurately empty point list.\n  //\n  if (\n    Just.hasInstance(controlledPoints) &&\n    controlledPoints.value.matchWith({\n      Error: e => true,\n      Ok: v => false,\n    })\n  ) {\n    const url = newGithubIssueUrl({\n      user: 'urbit',\n      repo: 'bridge',\n      title: controlledPoints.value.value,\n      body: `<!-- Please provide some context. Do you have Metamask installed? What login method did you use? -->`,\n    });\n    return (\n      <View inset>\n        <Grid>\n          <Grid.Item full as={HelpText} className=\"mt8 t-center\">\n            {controlledPoints.value.value}\n            <br />\n            Try reloading the page. If this problem persists, please{' '}\n            <a href={url}>file an issue on GitHub</a>.\n          </Grid.Item>\n        </Grid>\n      </View>\n    );\n  }\n\n  if (\n    loading ||\n    (allPoints.length === 1 &&\n      incomingPoints.length === 0 &&\n      outgoingPoints.length === 0 &&\n      !starReleasing)\n  ) {\n    return (\n      <View inset>\n        <Grid>\n          <Grid.Item full as={HelpText} className=\"mt8 t-center\">\n            <Blinky /> Loading...\n          </Grid.Item>\n        </Grid>\n      </View>\n    );\n  }\n\n  return (\n    <View inset pop={pop} hideBack>\n      <NavHeader>\n        <CopiableAddress\n          text={address}\n          className=\"f6 mono gray4 mb4 us-none pointer\">\n          {abbreviateAddress(address)}\n        </CopiableAddress>\n      </NavHeader>\n      <Grid>\n        {displayEmptyState && (\n          <Grid.Item full as={HelpText} className=\"mt8 t-center\">\n            No points to display. This wallet is not the owner or proxy for any\n            points.\n          </Grid.Item>\n        )}\n\n        {incomingPoints.length > 0 && (\n          <Grid.Item full as={Grid} gap={1} className=\"mb6\">\n            <Grid.Item full as={H5}>\n              {pluralize(\n                incomingPoints.length,\n                'Incoming Transfer',\n                'Incoming Transfers'\n              )}\n            </Grid.Item>\n            <Grid.Item\n              full\n              as={PointList}\n              points={incomingPoints}\n              actions={(point, i) => (\n                <ActionButtons\n                  actions={[\n                    {\n                      text: 'Accept',\n                      onClick: () => {\n                        setPointCursor(Just(point));\n                        push(names.ACCEPT_TRANSFER);\n                      },\n                    },\n                    {\n                      text: 'Reject',\n                      onClick: () => {\n                        addRejectedPoint(point);\n                      },\n                    },\n                  ]}\n                />\n              )}\n              inverted\n            />\n          </Grid.Item>\n        )}\n\n        {outgoingPoints.length > 0 && (\n          <Grid.Item full as={Grid} gap={1} className=\"mb6\">\n            <Grid.Item full as={H5}>\n              {pluralize(\n                outgoingPoints.length,\n                'Outgoing Transfer',\n                'Outgoing Transfers'\n              )}\n            </Grid.Item>\n            <Grid.Item\n              full\n              as={PointList}\n              points={outgoingPoints}\n              actions={(point, i) => (\n                <ActionButtons\n                  actions={[\n                    {\n                      text: 'Cancel',\n                      onClick: () => {\n                        setPointCursor(Just(point));\n                        // TODO: deep linking to fix this duplicate route\n                        push(names.CANCEL_TRANSFER);\n                      },\n                    },\n                  ]}\n                />\n              )}\n              inverted\n            />\n          </Grid.Item>\n        )}\n\n        {allPoints.length > 0 && (\n          <Grid.Item full as={Grid} gap={1}>\n            <Grid.Item full as={H5}>\n              {pluralize(allPoints.length, 'ID')}\n            </Grid.Item>\n            <Grid.Item full as={PointList} points={allPoints} />\n          </Grid.Item>\n        )}\n\n        <Footer>\n          <Grid>\n            <Grid.Divider />\n            {isEclipticOwner && (\n              <>\n                <Grid.Item\n                  full\n                  as={ForwardButton}\n                  detail=\"You have the authority to create a new Galaxy.\"\n                  onClick={goCreateGalaxy}>\n                  Create a galaxy\n                </Grid.Item>\n                <Grid.Divider />\n              </>\n            )}\n            {starReleasing && (\n              <>\n                <Grid.Item\n                  full\n                  as={ForwardButton}\n                  detail=\"You have points being released\"\n                  onClick={goStarRelease}>\n                  View Star Release\n                </Grid.Item>\n                <Grid.Divider />\n              </>\n            )}\n          </Grid>\n        </Footer>\n      </Grid>\n    </View>\n  );\n}\n","import { createContext, useContext } from 'react';\n\nexport const ActivateFlowContext = createContext(null);\nexport const ActivateFlowProvider = ActivateFlowContext.Provider;\n\n// Hook version\nexport function useActivateFlow() {\n  return useContext(ActivateFlowContext);\n}\n","import React from 'react';\nimport { Grid, Button } from 'indigo-react';\n\nimport Footer from './Footer';\n\nexport default function FooterButton({ as: As = Button, ...props }) {\n  return (\n    <Footer>\n      <Grid className=\"pt4\">\n        <Grid.Divider />\n        <Grid.Item full>\n          <As {...props} />\n        </Grid.Item>\n      </Grid>\n    </Footer>\n  );\n}\n","import * as wg from './walletgen';\n\nimport JSZip from 'jszip';\nimport saveAs from 'file-saver';\n\nexport async function generateWallet(point, boot) {\n  const ticket = await wg.makeTicket(point);\n  const wallet = await wg.generateWallet(point, ticket, boot);\n  return wallet;\n}\n\n//TODO should be moved to lib/walletgen\nexport async function downloadWallet(paperWallets, keyfile, keyfilename) {\n  if (paperWallets.length === 1) {\n    const zip = new JSZip();\n\n    const wallet = paperWallets[0];\n    const ship = wallet.wallet.meta.patp.replace('~', '');\n    const zipName = `${ship}-passport`;\n    const folder = zip.folder(zipName);\n\n    wallet.frames.forEach(frame => {\n      const filename = `${ship}-${frame.givenName}.png`;\n      folder.file(filename, frame.image);\n    });\n\n    if (keyfile && keyfilename) {\n      folder.file(keyfilename, keyfile);\n    }\n\n    await zip.generateAsync({ type: 'blob' }).then(content => {\n      saveAs(content, `${zipName}.zip`);\n      // resolve(true);\n    });\n  } else {\n    console.error('downloadWallet() can only download 1 wallet at a time.');\n  }\n}\n","import ob from 'urbit-ob';\n\nimport { ensurePatFormat } from 'form/formatters';\n\n/**\n * pull the suggested ticket from the #hash in the url\n */\nexport default function useImpliedTicket() {\n  const hash = window.location.hash.slice(1);\n  const ticket = ensurePatFormat(hash);\n  const isValid = ob.isValidPatq(ticket);\n\n  return isValid ? ticket : null;\n}\n","import React from 'react';\nimport PaperRenderer from 'urbit-paper-renderer';\n\nexport default function PaperBuilder({ point, wallets, callback, ...props }) {\n  return (\n    <PaperRenderer\n      wallets={wallets}\n      callback={data => {\n        console.log(data);\n        callback(data);\n      }}\n      show={false}\n      debug={false}\n      output={'png'}\n    />\n  );\n}\n","import React from 'react';\nimport cn from 'classnames';\nimport { Text } from 'indigo-react';\n\nexport default function Steps({ num = 1, total = 3, className, ...rest }) {\n  return (\n    <Text className={cn('f5 gray3', className)} {...rest}>\n      <Text className=\"f5 black\">Step {num}</Text> of {total}\n    </Text>\n  );\n}\n","import React from 'react';\nimport cn from 'classnames';\nimport { Grid, H4 } from 'indigo-react';\n\nimport Steps from 'components/Steps';\n\n// NOTE: the 48px matches the `mt8` class on Passport so things line up nicely\n// TODO: there's probably a clever grid/flex way to do this instead\nexport default function PassportView({ className, children, header, step }) {\n  return (\n    <>\n      <Grid className={cn(className, 'auto-rows-min')}>\n        <Grid.Item\n          full\n          as={Steps}\n          num={step}\n          total={3}\n          style={{ height: '48px' }}\n        />\n        <Grid.Item full as={H4}>\n          {header}\n        </Grid.Item>\n        <Grid.Item full>{children}</Grid.Item>\n      </Grid>\n    </>\n  );\n}\n","import React, { useCallback, useMemo } from 'react';\nimport { Grid, P, CheckboxInput } from 'indigo-react';\n\nimport * as need from 'lib/need';\nimport { useLocalRouter } from 'lib/LocalRouter';\nimport { validateExactly } from 'lib/validators';\nimport { isDevelopment } from 'lib/flags';\n\nimport SubmitButton from 'form/SubmitButton';\nimport { TicketInput } from 'form/Inputs';\nimport {\n  composeValidator,\n  buildPatqValidator,\n  buildCheckboxValidator,\n} from 'form/validators';\nimport BridgeForm from 'form/BridgeForm';\n\nimport { useActivateFlow } from './ActivateFlow';\nimport PassportView from './PassportView';\nimport FormError from 'form/FormError';\n\nconst STUB_VERIFY_TICKET = isDevelopment;\n\nexport default function PassportVerify({ className }) {\n  const { push, names } = useLocalRouter();\n  const { derivedWallet } = useActivateFlow();\n  const goToTransfer = useCallback(() => push(names.TRANSFER), [push, names]);\n\n  const { ticket } = need.wallet(derivedWallet);\n  const validate = useMemo(\n    () =>\n      composeValidator({\n        ticket: buildPatqValidator([\n          validateExactly(ticket, 'Does not match expected master ticket.'),\n        ]),\n        showTicket: buildCheckboxValidator(),\n      }),\n    [ticket]\n  );\n\n  const initialValues = useMemo(\n    () => ({\n      ticket: STUB_VERIFY_TICKET ? ticket : undefined,\n      showTicket: true,\n    }),\n    [ticket]\n  );\n\n  return (\n    <PassportView\n      header=\"Verify Your Master Ticket\"\n      step={2}\n      className={className}>\n      <Grid>\n        <Grid.Item full as={P}>\n          We need to verify that you’re you. Unzip the file you downloaded in\n          the previous step. It should yield a directory of images.\n        </Grid.Item>\n        <Grid.Item full as={P}>\n          One of the images includes your Master Ticket. It’s a four-word phrase\n          separated with hyphens. Enter it below to verify you recieved it\n          (include the hyphens).\n        </Grid.Item>\n        <Grid.Item full as={P}>\n          <b>Never share your Master Ticket with anyone else.</b>\n        </Grid.Item>\n        <BridgeForm\n          validate={validate}\n          afterSubmit={goToTransfer}\n          initialValues={initialValues}>\n          {({ values, handleSubmit }) => (\n            <>\n              <Grid.Item\n                full\n                as={TicketInput}\n                type={values.showTicket ? 'text' : 'password'}\n                name=\"ticket\"\n                label=\"Master Ticket\"\n              />\n\n              <Grid.Item\n                full\n                as={CheckboxInput}\n                name=\"showTicket\"\n                label=\"Show\"\n              />\n\n              <Grid.Item full as={FormError} />\n\n              <Grid.Item\n                full\n                className=\"mt3\"\n                as={SubmitButton}\n                handleSubmit={handleSubmit}>\n                Verify\n              </Grid.Item>\n            </>\n          )}\n        </BridgeForm>\n      </Grid>\n    </PassportView>\n  );\n}\n","import * as azimuth from 'azimuth-js';\nimport * as tank from './tank';\n\nimport { hexify } from './txn';\nimport {\n  deriveNetworkSeedFromUrbitWallet,\n  deriveNetworkKeys,\n  CRYPTO_SUITE_VERSION,\n} from './keys';\nimport { addHexPrefix } from './utils/address';\nimport {\n  sendAndAwaitAllSerial,\n  signTransaction,\n  sendSignedTransaction,\n} from './txn';\nimport getSuggestedGasPrice from './getSuggestedGasPrice';\nimport { GAS_LIMITS } from './constants';\nimport { toBN } from 'web3-utils';\nimport { safeToWei } from './lib';\n\n// the initial network key revision is always 1\nconst INITIAL_NETWORK_KEY_REVISION = 1;\n\nexport const TRANSACTION_PROGRESS = {\n  GENERATING: 0.01,\n  SIGNING: 0.15,\n  FUNDING: 0.3,\n  TRANSFERRING: 0.55,\n  CLEANING: 0.95,\n  DONE: 1.0,\n};\n\nexport async function reticketPointBetweenWallets({\n  fromWallet,\n  fromWalletType,\n  fromWalletHdPath,\n  toWallet,\n  point,\n  web3,\n  contracts,\n  networkType,\n  onUpdate,\n  transferEth = false,\n  nextRevision = INITIAL_NETWORK_KEY_REVISION,\n  txnSigner,\n  txnSender,\n}) {\n  const askForFunding = (address, minBalance, balance) =>\n    onUpdate({\n      type: 'askFunding',\n      value: { address, minBalance, balance },\n    });\n\n  const gotFunding = () => onUpdate({ type: 'gotFunding' });\n  const progress = state => onUpdate({ type: 'progress', state });\n\n  //\n  // generate transactions\n  //\n\n  progress(TRANSACTION_PROGRESS.GENERATING);\n\n  // transfer to invite wallet, so it can configure\n  //NOTE doing this in the invite wallet instead of the final wallet makes\n  //     failure cases \"solvable\" by just telling the user to fully retry.\n  //     in other words, the invite flow is effectively idempotent.\n\n  //TODO no harm done if we already owned it, but should still get a bool arg\n  //     for skipping this, if it isn't too big a burden for callers\n  const transferTmpTx = azimuth.ecliptic.transferPoint(\n    contracts,\n    point,\n    fromWallet.address,\n    false\n  );\n  transferTmpTx.gas = GAS_LIMITS.TRANSFER;\n\n  // configure networking public keys\n  const seed = await deriveNetworkSeedFromUrbitWallet(toWallet, nextRevision);\n\n  const networkSeed = seed.matchWith({\n    Nothing: () => {\n      throw new Error('network seed not derived');\n    },\n    Just: p => p.value,\n  });\n\n  const networkKeys = deriveNetworkKeys(networkSeed);\n\n  const keysTx = azimuth.ecliptic.configureKeys(\n    contracts,\n    point,\n    addHexPrefix(networkKeys.crypt.public),\n    addHexPrefix(networkKeys.auth.public),\n    CRYPTO_SUITE_VERSION,\n    /* discontinuous */ false\n  );\n  keysTx.gas = GAS_LIMITS.CONFIGURE_KEYS;\n\n  // configure management proxy\n\n  const managementTx = azimuth.ecliptic.setManagementProxy(\n    contracts,\n    point,\n    toWallet.management.keys.address\n  );\n  managementTx.gas = GAS_LIMITS.SET_PROXY;\n\n  // set spawn & voting proxies situationally\n\n  let txs = [transferTmpTx, keysTx, managementTx];\n  if (\n    azimuth.azimuth.getPointSize(point) !== azimuth.azimuth.PointSize.Planet\n  ) {\n    const spawnTx = azimuth.ecliptic.setSpawnProxy(\n      contracts,\n      point,\n      toWallet.spawn.keys.address\n    );\n    spawnTx.gas = GAS_LIMITS.SET_PROXY;\n    txs.push(spawnTx);\n\n    if (\n      azimuth.azimuth.getPointSize(point) === azimuth.azimuth.PointSize.Galaxy\n    ) {\n      const votingTx = azimuth.ecliptic.setVotingProxy(\n        contracts,\n        point,\n        toWallet.voting.keys.address\n      );\n      votingTx.gas = GAS_LIMITS.SET_PROXY;\n      txs.push(votingTx);\n    }\n  }\n\n  // transfer configured point to user's new wallet\n\n  const transferFinalTx = azimuth.ecliptic.transferPoint(\n    contracts,\n    point,\n    toWallet.ownership.keys.address,\n    false\n  );\n  transferFinalTx.gas = GAS_LIMITS.TRANSFER;\n  txs.push(transferFinalTx);\n\n  //\n  // finalizing & signing transactions\n  //\n\n  progress(TRANSACTION_PROGRESS.SIGNING);\n\n  const gasPriceGwei = (await getSuggestedGasPrice(networkType)).toFixed();\n  const chainId = await web3.eth.net.getId();\n  const gasPriceWeiBN = toBN(safeToWei(gasPriceGwei, 'gwei'));\n  let inviteNonce = await web3.eth.getTransactionCount(fromWallet.address);\n  const totalCost = txs.reduce(\n    (acc, tx) => acc.add(gasPriceWeiBN.mul(toBN(tx.gas))),\n    toBN(0)\n  );\n\n  let txPairs = [];\n\n  // Must be done in serial else hardware will give nonce errors\n  for (let i = 0; i < txs.length; i++) {\n    const stx = await signTransaction({\n      wallet: fromWallet,\n      walletType: fromWalletType,\n      walletHdPath: fromWalletHdPath,\n      networkType,\n      txn: txs[i],\n      nonce: inviteNonce + i,\n      chainId,\n      gasPrice: gasPriceGwei,\n      gasLimit: txs[i].gas,\n      txnSigner,\n      txnSender,\n    });\n    txPairs.push({\n      raw: hexify(stx.serialize()),\n      signed: stx,\n    });\n  }\n\n  inviteNonce = inviteNonce + txs.length;\n\n  //\n  // ensuring funding for transactions\n  //\n\n  progress(TRANSACTION_PROGRESS.FUNDING);\n\n  const usedTank = await tank.ensureFundsFor(\n    web3,\n    point,\n    fromWallet.address,\n    fromWalletType,\n    totalCost,\n    txPairs.map(p => p.raw),\n    askForFunding,\n    gotFunding\n  );\n\n  //\n  // sending and awaiting transactions\n  //\n\n  progress(TRANSACTION_PROGRESS.TRANSFERRING);\n\n  const receipts = await sendAndAwaitAllSerial(\n    web3,\n    txPairs.map(p => p.signed),\n    usedTank\n  );\n\n  const realCost = gasPriceWeiBN.mul(\n    receipts.reduce((sum, receipt) => {\n      return sum.add(toBN(receipt.gasUsed));\n    }, toBN(0))\n  );\n\n  //\n  // move leftover eth\n  //\n\n  progress(TRANSACTION_PROGRESS.CLEANING);\n\n  let balance = toBN(await web3.eth.getBalance(fromWallet.address));\n  const gasLimit = GAS_LIMITS.SEND_ETH;\n  const sendEthCost = gasPriceWeiBN.mul(toBN(gasLimit));\n\n  // if we have funds left over from what the gas tank gave us, send those back\n  if (usedTank && realCost.add(sendEthCost).lt(totalCost)) {\n    try {\n      const remainder = totalCost.sub(realCost).sub(sendEthCost);\n      console.log('returning to gas tank', remainder.toString());\n      const txn = { to: tank.TANK_ADDRESS, value: remainder };\n      const stx = await signTransaction({\n        wallet: fromWallet,\n        walletType: fromWalletType,\n        walletHdPath: fromWalletHdPath,\n        txn,\n        chainId,\n        networkType,\n        gasPrice: gasPriceGwei,\n        gasLimit,\n        nonce: inviteNonce,\n      });\n      sendSignedTransaction(web3, stx);\n\n      // only update these after the above succeeded\n      inviteNonce++;\n      balance = balance.sub(remainder).sub(sendEthCost);\n    } catch (err) {\n      console.log('error returning gas, safely ignored:');\n      console.log(err);\n    }\n  }\n\n  // if non-trivial eth left in invite wallet, transfer to new ownership\n  if (transferEth && balance.gt(sendEthCost)) {\n    try {\n      const value = balance.sub(sendEthCost);\n      const txn = {\n        to: toWallet.ownership.keys.address,\n        value: value,\n      };\n      const stx = await signTransaction({\n        wallet: fromWallet,\n        walletType: fromWalletType,\n        walletHdPath: fromWalletHdPath,\n        txn,\n        chainId,\n        networkType,\n        gasPrice: gasPriceGwei,\n        gasLimit,\n        nonce: inviteNonce,\n      });\n      sendSignedTransaction(web3, stx);\n    } catch (err) {\n      console.log('error sending value tx, safely ignored:');\n      console.log(err);\n    }\n  }\n\n  progress(TRANSACTION_PROGRESS.DONE);\n}\n","import React from 'react';\nimport cn from 'classnames';\n\n// progrss is [0, 1]\nexport default function LoadingBar({ className, progress = 1.0 }) {\n  return (\n    <div className={cn('rel bg-gray2', className)} style={{ height: '4px' }}>\n      <div\n        className=\"abs bg-green3 animated-width\"\n        style={{\n          top: 0,\n          bottom: 0,\n          left: 0,\n          width: `${progress * 100.0}%`,\n        }}\n      />\n    </div>\n  );\n}\n","import React, { useState, useCallback } from 'react';\nimport { Grid, Text, ErrorText } from 'indigo-react';\n\nimport { useNetwork } from 'store/network';\nimport { useWallet } from 'store/wallet';\nimport { useHistory } from 'store/history';\nimport { usePointCursor } from 'store/pointCursor';\n\nimport * as need from 'lib/need';\nimport useLifecycle from 'lib/useLifecycle';\nimport useBlockWindowClose from 'lib/useBlockWindowClose';\nimport {\n  reticketPointBetweenWallets,\n  TRANSACTION_PROGRESS,\n} from 'lib/reticket';\nimport { timeout } from 'lib/timeout';\n\nimport WarningBox from 'components/WarningBox';\nimport LoadingBar from 'components/LoadingBar';\nimport { RestartButton } from 'components/Buttons';\nimport NeedFundsNotice from 'components/NeedFundsNotice';\n\nimport { useActivateFlow } from './ActivateFlow';\nimport PassportView from './PassportView';\n\nconst labelForProgress = progress => {\n  if (progress <= 0) {\n    return 'Verify Passport';\n  } else if (progress <= TRANSACTION_PROGRESS.GENERATING) {\n    return 'Generating Ethereum Transactions...';\n  } else if (progress <= TRANSACTION_PROGRESS.SIGNING) {\n    return 'Signing Ethereum Transactions...';\n  } else if (progress <= TRANSACTION_PROGRESS.FUNDING) {\n    return 'Funding Ethereum Transactions...';\n  } else if (progress <= TRANSACTION_PROGRESS.TRANSFERRING) {\n    return 'Transferring ID...';\n  } else if (progress <= TRANSACTION_PROGRESS.CLEANING) {\n    return 'Cleaning Up...';\n  } else if (progress <= TRANSACTION_PROGRESS.DONE) {\n    return 'Done';\n  }\n};\n\nexport default function PassportTransfer({ className, resetActivateRouter }) {\n  const { replaceWith, names } = useHistory();\n  const { setUrbitWallet } = useWallet();\n  const { setPointCursor } = usePointCursor();\n  const { web3, contracts, networkType } = useNetwork();\n  const {\n    derivedWallet,\n    derivedPoint,\n    inviteWallet,\n    reset: resetActivateFlow,\n  } = useActivateFlow();\n  const [generalError, setGeneralError] = useState();\n  const [progress, setProcesss] = useState(0);\n  const [needFunds, setNeedFunds] = useState();\n\n  const goToLogin = useCallback(\n    () => replaceWith([{ key: names.LOGIN }, { key: names.POINT }]),\n    [replaceWith, names]\n  );\n\n  useBlockWindowClose();\n\n  const goToRestart = useCallback(() => {\n    // NOTE: because we're already on the ACTIVATE view in the history,\n    // react (intelligently) doesn't trigger a re-render and that means the\n    // current state of the two nested routers (activate & passport) stick\n    // around unless we manually clear them.\n    // we only need to clear activate because that will unmount the passport\n    // router (which will be set to initialRoutes when mounted again)\n\n    // 2) reset local router\n    resetActivateRouter();\n    // 3) clear the state\n    resetActivateFlow();\n  }, [resetActivateRouter, resetActivateFlow]);\n\n  const handleUpdate = useCallback(\n    ({ type, state, value }) => {\n      switch (type) {\n        case 'progress':\n          return setProcesss(state);\n        case 'askFunding':\n          return setNeedFunds(value);\n        case 'gotFunding':\n          return setNeedFunds(false);\n        default:\n          console.error(`Unknown update: ${type}`);\n      }\n    },\n    [setProcesss, setNeedFunds]\n  );\n\n  const claimPoint = useCallback(async () => {\n    setGeneralError(false);\n\n    try {\n      const _inviteWallet = need.wallet(inviteWallet);\n      const _wallet = need.wallet(derivedWallet);\n      const _point = need.point(derivedPoint);\n      const _web3 = need.web3(web3);\n      const _contracts = need.contracts(contracts);\n\n      await reticketPointBetweenWallets({\n        fromWallet: _inviteWallet,\n        toWallet: _wallet,\n        point: _point,\n        web3: _web3,\n        contracts: _contracts,\n        networkType,\n        onUpdate: handleUpdate,\n        transferEth: true,\n        //NOTE  not passing wc function, we always have invite ticket wallet\n      });\n\n      // set the global wallet\n      setUrbitWallet(derivedWallet);\n      setPointCursor(derivedPoint);\n\n      // and redirect to login\n      await timeout(3000);\n      goToLogin();\n    } catch (error) {\n      // some generic error\n      setGeneralError(error);\n    }\n  }, [\n    inviteWallet,\n    derivedWallet,\n    derivedPoint,\n    web3,\n    contracts,\n    networkType,\n    setUrbitWallet,\n    setPointCursor,\n    handleUpdate,\n    goToLogin,\n  ]);\n\n  useLifecycle(() => {\n    claimPoint();\n  });\n\n  const renderAdditionalInfo = () => {\n    if (generalError) {\n      console.log(generalError);\n      generalError.message = generalError.message || 'Something went wrong!';\n      return (\n        <>\n          <Grid.Item full className=\"mt8\">\n            <ErrorText>{generalError.message.toString()}</ErrorText>\n          </Grid.Item>\n          <Grid.Item\n            full\n            className=\"mt3\"\n            as={RestartButton}\n            solid\n            onClick={goToRestart}>\n            Restart\n          </Grid.Item>\n        </>\n      );\n    }\n\n    if (needFunds) {\n      return (\n        <Grid.Item full as={NeedFundsNotice} className=\"mt8\" {...needFunds} />\n      );\n    }\n\n    if (progress < 1.0) {\n      return (\n        <Grid.Item full as={WarningBox} className=\"mt8\">\n          Never give your Master Ticket to anyone\n        </Grid.Item>\n      );\n    }\n\n    return null;\n  };\n\n  return (\n    <PassportView\n      className={className}\n      header={labelForProgress(progress)}\n      step={3}>\n      <Grid>\n        <Grid.Item full as={Grid} className=\"mt3\" gap={3}>\n          <Grid.Item full as={LoadingBar} progress={progress} />\n          <Grid.Item full>\n            <Text className=\"f5 green4\">\n              This process can take up to 5 minutes to complete. Don't close\n              this page until the process is complete.\n            </Text>\n          </Grid.Item>\n        </Grid.Item>\n\n        {renderAdditionalInfo()}\n      </Grid>\n    </PassportView>\n  );\n}\n","import React, { useMemo } from 'react';\nimport cn from 'classnames';\nimport { Grid } from 'indigo-react';\n\nimport { LocalRouterProvider, useLocalRouter } from 'lib/LocalRouter';\n\nimport View from 'components/View';\nimport Passport from 'components/Passport';\n\nimport { useActivateFlow } from './ActivateFlow';\nimport useBreakpoints from 'lib/useBreakpoints';\nimport useRouter from 'lib/useRouter';\n\nimport PassportDownload from './PassportDownload';\nimport PassportVerify from './PassportVerify';\nimport PassportTransfer from './PassportTransfer';\nimport { walletFromMnemonic } from 'lib/wallet';\nimport { DEFAULT_HD_PATH } from 'lib/constants';\nimport { publicToAddress } from 'lib/utils/address';\n\nconst NAMES = {\n  DOWNLOAD: 'DOWNLOAD',\n  VERIFY: 'VERIFY',\n  TRANSFER: 'TRANSFER',\n};\n\nconst VIEWS = {\n  [NAMES.DOWNLOAD]: PassportDownload,\n  [NAMES.VERIFY]: PassportVerify,\n  [NAMES.TRANSFER]: PassportTransfer,\n};\n\nexport default function ActivatePassport() {\n  const { derivedPoint, generated, derivedWallet } = useActivateFlow();\n  // pull the reset function out of the 'activate' router\n  const { reset: resetActivateRouter } = useLocalRouter();\n  const { Route, ...router } = useRouter({\n    names: NAMES,\n    views: VIEWS,\n    initialRoutes: [{ key: NAMES.DOWNLOAD }],\n  });\n\n  const gap = useBreakpoints([4, 4, 7]);\n  const marginTop = useBreakpoints([false, false, 8]);\n\n  // addresses are not derived until we set[Urbit]Wallet(), so do that inline\n  const address = useMemo(\n    () =>\n      derivedWallet\n        .chain(wallet =>\n          walletFromMnemonic(\n            wallet.ownership.seed,\n            DEFAULT_HD_PATH,\n            wallet.meta.passphrase\n          )\n        )\n        .map(wallet => publicToAddress(wallet.publicKey)),\n    [derivedWallet]\n  );\n  //~hobbyn-mismur-fonrux-datber\n  return (\n    <View inset>\n      <LocalRouterProvider value={router}>\n        <Grid gap={gap} className=\"mt8 mb10\">\n          <Grid.Item full>\n            <Passport\n              className={cn({ [`mt${marginTop}`]: marginTop })}\n              point={derivedPoint}\n              ticket={generated}\n              address={address}\n            />\n          </Grid.Item>\n          <Grid.Item\n            full\n            as={Route}\n            resetActivateRouter={resetActivateRouter}\n          />\n        </Grid>\n      </LocalRouterProvider>\n    </View>\n  );\n}\n","import React, { useState, useEffect, useCallback } from 'react';\nimport { Just, Nothing } from 'folktale/maybe';\nimport { Grid, P } from 'indigo-react';\nimport ob from 'urbit-ob';\n\nimport * as need from 'lib/need';\nimport { downloadWallet } from 'lib/invite';\nimport { useLocalRouter } from 'lib/LocalRouter';\nimport { compileNetworkingKey } from 'lib/keys';\n\nimport { DownloadButton, ForwardButton } from 'components/Buttons';\nimport PaperBuilder from 'components/PaperBuilder';\n\nimport { useActivateFlow } from './ActivateFlow';\nimport PassportView from './PassportView';\n\nexport default function PassportDownload({ className }) {\n  const {\n    derivedPoint,\n    derivedWallet,\n    generated,\n    setGenerated,\n  } = useActivateFlow();\n  const { push, names } = useLocalRouter();\n  const point = need.point(derivedPoint);\n  const wallet = need.wallet(derivedWallet);\n\n  const [paper, setPaper] = useState(Nothing());\n  const [downloaded, setDownloaded] = useState(false);\n\n  const pointAsString = derivedPoint.matchWith({\n    Nothing: () => '',\n    Just: p => p.value.toFixed(),\n  });\n\n  const download = useCallback(() => {\n    const netkey = compileNetworkingKey(wallet.network.keys, point, 1);\n    //TODO  could be deduplicated with useKeyfileGenerator's logic\n    const filename = ob.patp(point).slice(1) + '-1.key';\n    downloadWallet(paper.getOrElse([]), netkey, filename);\n    setDownloaded(true);\n  }, [paper, wallet, point, setDownloaded]);\n\n  // sync paper value to activation state\n  useEffect(\n    () =>\n      setGenerated(\n        paper.matchWith({\n          Nothing: () => false,\n          Just: () => true,\n        })\n      ),\n    [paper, setGenerated]\n  );\n\n  const goToVerify = useCallback(() => push(names.VERIFY), [push, names]);\n\n  return (\n    <>\n      <PassportView\n        className={className}\n        header=\"Download Your Urbit Passport\"\n        step={1}>\n        <Grid>\n          <Grid.Item full>\n            <P>\n              Your Passport includes your Master Ticket, a password giving you\n              total control of your Urbit identity. You’ll need it to access the\n              network and manage your identity.\n            </P>\n            <P>\n              After your Passport is downloaded, make sure to print it out on\n              paper and store it somewhere safe.\n            </P>\n          </Grid.Item>\n          <Grid.Item\n            full\n            as={!downloaded ? DownloadButton : ForwardButton}\n            disabled={!generated}\n            onClick={!downloaded ? download : goToVerify}\n            success={downloaded}\n            solid>\n            {!downloaded ? 'Download Passport' : 'Continue'}\n          </Grid.Item>\n        </Grid>\n      </PassportView>\n      <PaperBuilder\n        point={pointAsString}\n        wallets={[wallet]}\n        callback={data => {\n          setPaper(Just(data));\n        }}\n      />\n    </>\n  );\n}\n","var _path;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgSearch(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 14,\n    height: 14,\n    viewBox: \"0 0 14 14\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M9.18806 10.1969C8.04395 11.0861 6.60411 11.5056 5.16172 11.37C3.71932 11.2344 2.38282 10.5538 1.42436 9.46684C0.465895 8.3799 -0.0424681 6.96833 0.00278089 5.51955C0.0480299 4.07077 0.643489 2.69371 1.66791 1.66876C2.69234 0.643816 4.0687 0.0480543 5.51674 0.00278231C6.96479 -0.0424897 8.37564 0.466132 9.46203 1.42508C10.5484 2.38404 11.2286 3.72121 11.3642 5.16434C11.4998 6.60747 11.0805 8.04805 10.1917 9.19274L14 12.9887L12.9892 14L9.19518 10.1969H9.18806ZM5.70012 9.96902C6.26099 9.96902 6.81637 9.85849 7.33454 9.64375C7.85272 9.429 8.32354 9.11425 8.72014 8.71745C9.11673 8.32066 9.43133 7.84959 9.64596 7.33115C9.8606 6.81271 9.97107 6.25705 9.97107 5.6959C9.97107 5.13474 9.8606 4.57908 9.64596 4.06064C9.43133 3.54221 9.11673 3.07114 8.72014 2.67434C8.32354 2.27755 7.85272 1.96279 7.33454 1.74805C6.81637 1.5333 6.26099 1.42278 5.70012 1.42278C4.56739 1.42278 3.48106 1.87298 2.6801 2.67434C1.87914 3.47571 1.42917 4.5626 1.42917 5.6959C1.42917 6.8292 1.87914 7.91609 2.6801 8.71745C3.48106 9.51882 4.56739 9.96902 5.70012 9.96902Z\",\n    fill: \"#7F7F7F\"\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgSearch);\nexport default __webpack_public_path__ + \"static/media/search.08f89f2a.svg\";\nexport { ForwardRef as ReactComponent };","import React, { useEffect } from 'react';\n\nimport useRouter from 'lib/useRouter';\nimport { LocalRouterProvider } from 'lib/LocalRouter';\nimport { useSyncDates } from 'lib/useSyncPoints';\n\nimport { ActivateFlowProvider } from './Activate/ActivateFlow';\nimport useActivateFlowState from './Activate/useActivateFlowState';\nimport ActivateCode from './Activate/ActivateCode';\nimport ActivatePassport from './Activate/ActivatePassport';\nimport Disclaimer from './Disclaimer';\n\nconst NAMES = {\n  CODE: 'CODE',\n  DISCLAIMER: 'DISCLAIMER',\n  PASSPORT: 'PASSPORT',\n};\n\nconst VIEWS = {\n  [NAMES.CODE]: ActivateCode,\n  [NAMES.PASSPORT]: ActivatePassport,\n  [NAMES.DISCLAIMER]: Disclaimer,\n};\n\nexport default function Activate() {\n  const state = useActivateFlowState();\n  const { Route, ...router } = useRouter({\n    names: NAMES,\n    views: VIEWS,\n    initialRoutes: [{ key: NAMES.CODE }],\n  });\n\n  useEffect(() => {\n    // remove potential /activate path on unmount\n    return () => {\n      window.history.replaceState(null, null, '');\n    };\n  }, []);\n\n  // when we know the derived point, ensure we have the data to display it\n  useSyncDates([state.derivedPoint.getOrElse(null)].filter(p => p !== null));\n\n  return (\n    <LocalRouterProvider value={router}>\n      <ActivateFlowProvider value={state}>\n        <Route />\n      </ActivateFlowProvider>\n    </LocalRouterProvider>\n  );\n}\n","import React, { useCallback, useMemo, useRef } from 'react';\nimport { Just, Nothing } from 'folktale/maybe';\nimport * as azimuth from 'azimuth-js';\nimport { Grid, H4, P, CheckboxInput } from 'indigo-react';\nimport { FORM_ERROR } from 'final-form';\n\nimport View from 'components/View';\nimport { ForwardButton } from 'components/Buttons';\nimport Passport from 'components/Passport';\nimport WarningBox from 'components/WarningBox';\nimport FooterButton from 'components/FooterButton';\n\nimport { useNetwork } from 'store/network';\nimport { useHistory } from 'store/history';\n\nimport * as need from 'lib/need';\nimport { ROUTE_NAMES } from 'lib/routeNames';\nimport { walletFromMnemonic } from 'lib/wallet';\nimport { DEFAULT_HD_PATH } from 'lib/constants';\nimport { generateWallet } from 'lib/invite';\nimport { generateTemporaryOwnershipWallet } from 'lib/walletgen';\nimport { useLocalRouter } from 'lib/LocalRouter';\nimport useImpliedTicket from 'lib/useImpliedTicket';\nimport { timeout } from 'lib/timeout';\nimport useHasDisclaimed from 'lib/useHasDisclaimed';\nimport useBreakpoints from 'lib/useBreakpoints';\n\nimport BridgeForm from 'form/BridgeForm';\nimport SubmitButton from 'form/SubmitButton';\nimport { TicketInput } from 'form/Inputs';\nimport {\n  composeValidator,\n  buildPatqValidator,\n  hasErrors,\n  buildCheckboxValidator,\n} from 'form/validators';\nimport FormError from 'form/FormError';\n\nimport { useActivateFlow } from './ActivateFlow';\nimport { WARNING } from 'form/helpers';\nimport { convertToInt } from 'lib/convertToInt';\n\nexport default function ActivateCode() {\n  const history = useHistory();\n  const { names, push } = useLocalRouter();\n  const { contracts } = useNetwork();\n  const impliedTicket = useImpliedTicket();\n  const [hasDisclaimed] = useHasDisclaimed();\n  const didWarn = useRef(false);\n\n  const {\n    setDerivedWallet,\n    setInviteWallet,\n    derivedPoint,\n    setDerivedPoint,\n  } = useActivateFlow();\n  // this is a pretty naive way to detect if we're on a mobile device\n  // (i.e. we're checking the width of the screen)\n  // but it will suffice for the 99% case and if someone wants to get around it\n  // well by golly they're allowed to turn their phone into landscape mode\n  // for this screen\n  const activationAllowed = useBreakpoints([false, true, true]);\n\n  const goToLogin = useCallback(() => history.popAndPush(ROUTE_NAMES.LOGIN), [\n    history,\n  ]);\n\n  const goToPassport = useCallback(() => {\n    if (!hasDisclaimed) {\n      push(names.DISCLAIMER, { next: names.PASSPORT });\n    } else {\n      push(names.PASSPORT);\n    }\n  }, [hasDisclaimed, names.DISCLAIMER, names.PASSPORT, push]);\n\n  const validateForm = useCallback((values, errors) => {\n    didWarn.current = false;\n\n    if (hasErrors(errors)) {\n      return errors;\n    }\n  }, []);\n\n  const validate = useMemo(\n    () =>\n      composeValidator(\n        { ticket: buildPatqValidator(), showTicket: buildCheckboxValidator() },\n        validateForm\n      ),\n    [validateForm]\n  );\n\n  // set our state on submission\n  const onSubmit = useCallback(\n    async values => {\n      await timeout(16); // allow the ui changes to flush before we lag it out\n\n      const _contracts = need.contracts(contracts);\n      const { seed } = await generateTemporaryOwnershipWallet(values.ticket);\n\n      const inviteWallet = walletFromMnemonic(seed, DEFAULT_HD_PATH);\n\n      const _inviteWallet = need.wallet(inviteWallet);\n\n      const owned = await azimuth.azimuth.getOwnedPoints(\n        _contracts,\n        _inviteWallet.address\n      );\n      const transferring = await azimuth.azimuth.getTransferringFor(\n        _contracts,\n        _inviteWallet.address\n      );\n      const incoming = [...owned, ...transferring];\n\n      if (incoming.length > 0) {\n        if (incoming.length > 1 && !didWarn.current) {\n          didWarn.current = true;\n          return {\n            [WARNING]:\n              'This invite code has multiple points available. ' +\n              \"Once you've activated this point, \" +\n              'activate the next with the same process.',\n          };\n        }\n\n        const point = convertToInt(incoming[0], 10);\n\n        setDerivedPoint(Just(point));\n        setInviteWallet(inviteWallet);\n        setDerivedWallet(Just(await generateWallet(point, true)));\n      } else {\n        return {\n          [FORM_ERROR]:\n            'Invite code has no claimable point.\\n' +\n            'Check your invite code and try again?',\n        };\n      }\n    },\n    [contracts, setDerivedPoint, setDerivedWallet, setInviteWallet]\n  );\n\n  const initialValues = useMemo(\n    () => ({ ticket: impliedTicket || '', showTicket: true }),\n    [impliedTicket]\n  );\n\n  return (\n    <View inset>\n      <Grid>\n        <Grid.Item\n          full\n          as={Passport}\n          point={derivedPoint}\n          address={Nothing()}\n        />\n        <Grid.Item full as={H4} className=\"mt3\">\n          Activate\n        </Grid.Item>\n        <Grid.Item full as={P} className=\"mb2\">\n          Someone has invited you to claim your Urbit identity and join the\n          network. {!impliedTicket && 'Enter your activation code to continue.'}\n        </Grid.Item>\n        <BridgeForm\n          validate={validate}\n          onSubmit={onSubmit}\n          afterSubmit={goToPassport}\n          initialValues={initialValues}>\n          {({ validating, values, submitting, handleSubmit }) => (\n            <>\n              {!impliedTicket && (\n                <>\n                  <Grid.Item\n                    full\n                    as={TicketInput}\n                    type={values.showTicket ? 'text' : 'password'}\n                    name=\"ticket\"\n                    label=\"Activation Code\"\n                    disabled={!activationAllowed}\n                  />\n\n                  <Grid.Item\n                    full\n                    as={CheckboxInput}\n                    name=\"showTicket\"\n                    label=\"Show\"\n                  />\n                </>\n              )}\n\n              <Grid.Item full as={FormError} />\n\n              <Grid.Item\n                full\n                as={SubmitButton}\n                className=\"mt4\"\n                handleSubmit={handleSubmit}>\n                {isWarning =>\n                  validating\n                    ? 'Deriving...'\n                    : submitting\n                    ? 'Generating...'\n                    : isWarning\n                    ? 'Continue Activation'\n                    : 'Go'\n                }\n              </Grid.Item>\n\n              {!activationAllowed && (\n                <Grid.Item full as={WarningBox} className=\"mt4\">\n                  For your security, please access Bridge on a desktop device.\n                </Grid.Item>\n              )}\n            </>\n          )}\n        </BridgeForm>\n      </Grid>\n\n      <FooterButton as={ForwardButton} onClick={goToLogin}>\n        Login\n      </FooterButton>\n    </View>\n  );\n}\n","import React from 'react';\nimport cn from 'classnames';\nimport { Flex, Breadcrumb } from 'indigo-react';\n\nexport default function Crumbs({ className, routes = [] }) {\n  const lastIndex = routes.length - 1;\n  const textStyle = 'gray4 mono';\n  return (\n    <Flex className={className} row wrap>\n      {routes.map((route, i) => {\n        const disabled = !route.action;\n\n        return (\n          <React.Fragment key={route.text}>\n            <Flex.Item\n              as={Breadcrumb}\n              onClick={route.action}\n              disabled={disabled}\n              className={cn(textStyle, { 'pointer underline': !disabled })}>\n              {route.text}\n            </Flex.Item>\n            {i !== lastIndex && (\n              <Flex.Item as={Breadcrumb} className={cn(textStyle, 'mh2')}>\n                /\n              </Flex.Item>\n            )}\n          </React.Fragment>\n        );\n      })}\n    </Flex>\n  );\n}\n","import React, { useMemo, useEffect, useCallback, useState } from 'react';\nimport { Grid, Flex, Button } from 'indigo-react';\nimport * as ob from 'urbit-ob';\nimport { Just, Nothing } from 'folktale/maybe';\nimport cn from 'classnames';\n\nimport { usePointCursor } from 'store/pointCursor';\nimport { usePointCache } from 'store/pointCache';\nimport { useWallet } from 'store/wallet';\n\nimport View from 'components/View';\nimport Tabs from 'components/Tabs';\nimport BarGraph from 'components/BarGraph';\nimport MaybeSigil from 'components/MaybeSigil';\nimport { matchBlinky } from 'components/Blinky';\nimport Chip from 'components/Chip';\nimport Crumbs from 'components/Crumbs';\n\nimport { useLocalRouter } from 'lib/LocalRouter';\nimport useInvites from 'lib/useInvites';\nimport * as need from 'lib/need';\nimport * as wg from 'lib/walletgen';\n\nimport Inviter from 'views/Invite/Inviter';\n\nimport { ReactComponent as SearchIcon } from 'assets/search.svg';\nimport CopyButton from 'components/CopyButton';\nimport { useSyncDetails } from 'lib/useSyncPoints';\nimport { useNetwork } from 'store/network';\nimport NavHeader from 'components/NavHeader';\n\nfunction SearchInput({ className, value, onChange }) {\n  return (\n    <Flex align=\"center\" full className={cn('b b-gray2 b1', className)}>\n      <Flex.Item className=\"p2\">\n        <SearchIcon />\n      </Flex.Item>\n\n      <Flex.Item\n        flex={1}\n        as={'input'}\n        value={value}\n        onChange={onChange}\n        className=\"b-none h7\"\n      />\n    </Flex>\n  );\n}\n\nfunction CohortMember({ point, pending = false, className, ...rest }) {\n  const { sentInvites } = useInvites(point);\n  const patp = useMemo(() => ob.patp(point), [point]);\n  const colors = pending ? ['#ee892b', '#FFFFFF'] : ['#000000', '#FFFFFF'];\n\n  const DetailText = useCallback(\n    () =>\n      pending ? 'Pending' : <> {matchBlinky(sentInvites)} points invited </>,\n    [pending, sentInvites]\n  );\n\n  return (\n    <Flex justify=\"between\" className={cn('b1 b-gray2', className)} {...rest}>\n      <Flex.Item className=\"w9 h9\">\n        <MaybeSigil patp={Just(patp)} size={64} colors={colors} />\n      </Flex.Item>\n\n      <Flex.Item\n        flex={1}\n        justify=\"evenly\"\n        as={Flex}\n        col\n        className=\"mono f6 ph4\">\n        <Flex.Item>{patp}</Flex.Item>\n        <Flex.Item className=\"gray4\">\n          <DetailText />\n        </Flex.Item>\n      </Flex.Item>\n    </Flex>\n  );\n}\nfunction CohortList({\n  acceptedPoints,\n  pendingPoints,\n  className,\n  onlyPending,\n  onSelectInvite,\n}) {\n  const { syncInvites } = usePointCache();\n\n  const [query, setQuery] = useState('');\n\n  useEffect(() => {\n    acceptedPoints.map(syncInvites);\n  }, [acceptedPoints, syncInvites]);\n\n  const handleChange = useCallback(\n    e => {\n      setQuery(e.target.value);\n      e.preventDefault();\n    },\n    [setQuery]\n  );\n\n  const filterPoints = useCallback(\n    points =>\n      points.filter(p => {\n        const patp = ob.patp(p).slice(1);\n        return patp.startsWith(query);\n      }),\n    [query]\n  );\n  const selectInvite = useCallback(\n    point => () => {\n      onSelectInvite(point);\n    },\n    [onSelectInvite]\n  );\n  const _pendingPoints = filterPoints(pendingPoints);\n  const _acceptedPoints = filterPoints(acceptedPoints);\n\n  const offset = onlyPending ? 0 : _acceptedPoints.length;\n\n  return (\n    <Grid gap={3} className={cn('mt4', className)}>\n      <Grid.Item full as={SearchInput} value={query} onChange={handleChange} />\n      <>\n        {!onlyPending &&\n          _acceptedPoints.map((p, idx) => (\n            <Grid.Item\n              key={p}\n              half={(idx % 2) + 1}\n              as={CohortMember}\n              point={p}\n              onClick={selectInvite(p)}\n            />\n          ))}\n        {_pendingPoints.map((p, idx) => (\n          <Grid.Item\n            key={p}\n            half={((offset + idx) % 2) + 1}\n            as={CohortMember}\n            point={p}\n            pending\n            onClick={selectInvite(p)}\n          />\n        ))}\n      </>\n\n      {_pendingPoints.length === 0 &&\n        (_acceptedPoints.length === 0 || onlyPending) && (\n          <Grid.Item full className=\"p4 t-center\">\n            {' '}\n            No invites accepted yet.\n          </Grid.Item>\n        )}\n    </Grid>\n  );\n}\n\nfunction hideIf(hider, hidden) {\n  return hider ? '●●●●●●●' : hidden;\n}\n\nfunction CohortMemberExpanded({ point, className, ...rest }) {\n  const { sentInvites, acceptedInvites } = useInvites(point);\n  const { getDetails } = usePointCache();\n  const { authToken } = useWallet();\n  const { contracts } = useNetwork();\n  const details = getDetails(point);\n  const { active } = details.getOrElse({});\n  const patp = useMemo(() => ob.patp(point), [point]);\n  const colors = useMemo(\n    () => (!active ? ['#ee892b', '#FFFFFF'] : ['#000000', '#FFFFFF']),\n    [active]\n  );\n\n  const [code, setCode] = useState(Nothing());\n  const [codeVisible, setCodeVisible] = useState(false);\n\n  useEffect(() => {\n    const fetchWallet = async () => {\n      const _authToken = authToken.getOrElse(null);\n      const _details = details.getOrElse(null);\n      const _contracts = contracts.getOrElse(null);\n      if (\n        !_authToken ||\n        !_details ||\n        _details.active ||\n        !_contracts ||\n        !codeVisible\n      ) {\n        setCode(Nothing());\n        return;\n      }\n      const { ticket, owner } = await wg.generateTemporaryDeterministicWallet(\n        point,\n        _authToken\n      );\n\n      if (owner.keys.address !== _details.transferProxy) {\n        setCode(Just(null));\n      } else {\n        setCode(Just(ticket));\n      }\n    };\n    fetchWallet();\n  }, [authToken, codeVisible, contracts, details, point]);\n\n  useEffect(() => {\n    setCodeVisible(false);\n  }, [point]);\n\n  return (\n    <Grid justify=\"between\" className={cn('b1 b-gray2', className)} {...rest}>\n      <Grid.Item rows={[1, 4]} cols={[1, 4]} className=\"h10 w10\">\n        <MaybeSigil patp={Just(patp)} size={64} colors={colors} />\n      </Grid.Item>\n\n      <Grid.Item cols={[4, 13]} className=\"mono mt-auto \">\n        {patp}\n      </Grid.Item>\n\n      {!active && (\n        <>\n          <Grid.Item\n            cols={[4, 13]}\n            className=\"mt-auto mb1 f6 gray4\"\n            as={Flex}\n            col>\n            Invite Code\n          </Grid.Item>\n          <Grid.Item cols={[4, 10]} className=\"mb-auto mt1 f6 gray4\">\n            {(code.getOrElse(true) === null &&\n              'This invite code cannot be recovered') ||\n              hideIf(!codeVisible, matchBlinky(code))}\n          </Grid.Item>\n          {!codeVisible && (\n            <Grid.Item\n              cols={[10, 13]}\n              className=\"mh-auto f6 underline pointer\"\n              onClick={() => setCodeVisible(true)}>\n              Show\n            </Grid.Item>\n          )}\n          {codeVisible && code.getOrElse('') !== null && (\n            <Grid.Item\n              className=\"mh-auto f6 t-right\"\n              cols={[10, 13]}\n              as={CopyButton}\n              text={code.getOrElse('')}\n            />\n          )}\n        </>\n      )}\n\n      {active && (\n        <>\n          <Grid.Item\n            cols={[4, 13]}\n            className=\"mt-auto mb1 f6 gray4\"\n            as={Flex}\n            col>\n            {matchBlinky(sentInvites)} invites sent\n          </Grid.Item>\n          <Grid.Item\n            cols={[4, 13]}\n            className=\"mb-auto mt1 f6 gray4\"\n            as={Flex}\n            col>\n            {matchBlinky(acceptedInvites)} invites accepted\n          </Grid.Item>\n        </>\n      )}\n    </Grid>\n  );\n}\n\nexport default function InviteCohort() {\n  const { pop } = useLocalRouter();\n\n  const { pointCursor } = usePointCursor();\n  const point = need.point(pointCursor);\n\n  const {\n    acceptedInvites,\n    acceptedPoints,\n    pendingPoints,\n    availableInvites,\n    sentInvites,\n  } = useInvites(point);\n\n  const [showInviteForm, setShowInviteForm] = useState(false);\n  const [tab, setTab] = useState(NAMES.ALL);\n\n  const _acceptedPoints = acceptedPoints.getOrElse([]);\n  const _pendingPoints = pendingPoints.getOrElse([]);\n  const _pendingInvites = _pendingPoints.length;\n  const _acceptedInvites = _acceptedPoints.length;\n  const _totalInvites = availableInvites\n    .map(a => sentInvites.getOrElse(0) + a)\n    .getOrElse(0);\n\n  const [selectedInvite, _setSelectedInvite] = useState();\n\n  useSyncDetails([..._acceptedPoints, ..._pendingPoints]);\n\n  const setSelectedInvite = useCallback(\n    p => _setSelectedInvite(old => (old === p ? null : p)),\n    []\n  );\n\n  return (\n    <View pop={pop} inset>\n      <NavHeader>\n        <Crumbs\n          className=\"mb1\"\n          routes={[\n            { text: ob.patp(point), action: () => pop() },\n            { text: 'Invite Group' },\n          ]}\n        />\n      </NavHeader>\n      <Grid gap={3}>\n        <Grid.Item full>Invite Group</Grid.Item>\n        <Grid.Item full>\n          <Flex align=\"center\">\n            <Flex.Item>\n              {_acceptedInvites} / {_totalInvites}\n            </Flex.Item>\n            {_pendingInvites !== 0 && (\n              <Flex.Item as={Chip} className=\"bg-yellow4 white\">\n                {_pendingInvites} pending\n              </Flex.Item>\n            )}\n          </Flex>\n        </Grid.Item>\n        <Grid.Item\n          full\n          as={BarGraph}\n          available={availableInvites}\n          sent={sentInvites}\n          accepted={acceptedInvites}\n        />\n        {availableInvites.getOrElse(0) !== 0 && !showInviteForm && (\n          <Grid.Item\n            full\n            solid\n            center\n            as={Button}\n            onClick={() => setShowInviteForm(true)}>\n            Add Members\n          </Grid.Item>\n        )}\n        {showInviteForm && <Inviter />}\n\n        {true && (\n          <Grid.Item\n            full\n            center\n            as={Tabs}\n            views={VIEWS}\n            options={OPTIONS}\n            currentTab={tab}\n            onTabChange={setTab}\n            acceptedPoints={_acceptedPoints}\n            pendingPoints={_pendingPoints}\n            onlyPending={tab === NAMES.PENDING}\n            onSelectInvite={setSelectedInvite}\n          />\n        )}\n        {selectedInvite && (\n          <Grid.Item\n            full\n            center\n            as={CohortMemberExpanded}\n            pending\n            point={selectedInvite}\n            onBack={() => setSelectedInvite(null)}\n          />\n        )}\n      </Grid>\n    </View>\n  );\n}\nconst NAMES = {\n  ALL: 'ALL',\n  PENDING: 'PENDING',\n};\n\nconst VIEWS = {\n  [NAMES.PENDING]: CohortList,\n  [NAMES.ALL]: CohortList,\n};\n\nconst OPTIONS = [\n  { text: 'All', value: NAMES.ALL },\n  { text: 'Pending', value: NAMES.PENDING },\n];\n","import ob from 'urbit-ob';\n\nimport { usePointCursor } from 'store/pointCursor';\n\nexport default function useCurrentPointName() {\n  const { pointCursor } = usePointCursor();\n\n  return pointCursor.matchWith({\n    Nothing: () => null,\n    Just: p => ob.patp(p.value),\n  });\n}\n","import React, { useCallback } from 'react';\nimport cn from 'classnames';\nimport { Grid, Text } from 'indigo-react';\nimport * as azimuth from 'azimuth-js';\n\nimport { useNetwork } from 'store/network';\nimport { usePointCursor } from 'store/pointCursor';\nimport { usePointCache } from 'store/pointCache';\n\nimport * as need from 'lib/need';\nimport { useLocalRouter } from 'lib/LocalRouter';\nimport useCurrentPointName from 'lib/useCurrentPointName';\nimport useEthereumTransaction from 'lib/useEthereumTransaction';\nimport { ETH_ZERO_ADDR, GAS_LIMITS } from 'lib/constants';\nimport useLifecycle from 'lib/useLifecycle';\n\nimport ViewHeader from 'components/ViewHeader';\nimport InlineEthereumTransaction from 'components/InlineEthereumTransaction';\nimport View from 'components/ViewHeader';\n\nfunction useCancelTransfer() {\n  const { contracts } = useNetwork();\n  const { pointCursor } = usePointCursor();\n  const { syncDetails } = usePointCache();\n\n  const _contracts = need.contracts(contracts);\n  const _point = need.point(pointCursor);\n\n  const { construct, ...rest } = useEthereumTransaction(\n    useCallback(\n      () =>\n        azimuth.ecliptic.setTransferProxy(_contracts, _point, ETH_ZERO_ADDR),\n      [_contracts, _point]\n    ),\n    useCallback(() => syncDetails(_point), [_point, syncDetails]),\n    GAS_LIMITS.SET_PROXY\n  );\n\n  useLifecycle(() => {\n    construct();\n  });\n\n  return {\n    ...rest,\n  };\n}\n\nfunction AdminCancelTransfer() {\n  const { pop } = useLocalRouter();\n  const { getDetails } = usePointCache();\n  const { pointCursor } = usePointCursor();\n  const _point = need.point(pointCursor);\n\n  const name = useCurrentPointName();\n  const _details = need.details(getDetails(_point));\n\n  const { completed, bind } = useCancelTransfer();\n\n  return (\n    <Grid>\n      <Grid.Item full as={ViewHeader}>\n        Cancel Outgoing Transfer\n      </Grid.Item>\n\n      <Grid.Item\n        full\n        as={Text}\n        className={cn('f5 wrap', {\n          green3: completed,\n        })}>\n        {completed\n          ? `The outgoing transfer of ${name} has been cancelled.`\n          : `Cancel the outgoing transfer of ${name} to ${_details.transferProxy}.`}\n      </Grid.Item>\n\n      <Grid.Item\n        full\n        as={InlineEthereumTransaction}\n        {...bind}\n        onReturn={() => pop()}\n      />\n    </Grid>\n  );\n}\n\nexport default function CancelTransfer() {\n  const { pop } = useLocalRouter();\n\n  return (\n    <View pop={pop} inset>\n      <AdminCancelTransfer />\n    </View>\n  );\n}\n","import React from 'react';\nimport { Grid, Flex, H5, Text } from 'indigo-react';\nimport { Just, Nothing } from 'folktale/maybe';\n\nimport { formatDotsWithTime } from 'lib/dateFormat';\nimport { segmentNetworkKey, CURVE_ZERO_ADDR } from 'lib/keys';\n\nimport { usePointCache } from 'store/pointCache';\n\nconst chainKeyProp = name => d =>\n  d[name] === CURVE_ZERO_ADDR ? Nothing() : Just(d[name]);\n\nconst renderNetworkKey = key => {\n  const segments = segmentNetworkKey(key);\n\n  if (!segments) {\n    return 'Unset';\n  }\n\n  return segments.join('\\n');\n};\n\nexport default function NetworkingKeys({ point }) {\n  const { getDetails, getRekeyDate } = usePointCache();\n\n  const details = getDetails(point);\n\n  const hasKeys = details.matchWith({\n    Nothing: () => false,\n    Just: ({ value: details }) => parseInt(details.keyRevisionNumber, 10) > 0,\n    // we actually don't mind the default NaN behavior of parseInt here,\n    // since NaN > 0 === false and that's a reasonable result\n  });\n\n  const renderNetworkKeySection = (title, key) => (\n    <>\n      <Grid.Item full as={H5} className=\"mt3 gray4\">\n        {title}\n      </Grid.Item>\n      {key.matchWith({\n        Nothing: () => (\n          <Grid.Item full as=\"code\" className=\"f5 mono gray4\">\n            Unset\n          </Grid.Item>\n        ),\n        Just: ({ value: key }) => (\n          <>\n            <Grid.Item full as=\"code\" className=\"f5 mono wrap\">\n              0x\n            </Grid.Item>\n            <Grid.Item full as=\"code\" className=\"f5 mono wrap\">\n              {renderNetworkKey(key)}\n            </Grid.Item>\n          </>\n        ),\n      })}\n    </>\n  );\n\n  const renderDetail = (title, value) => (\n    <Flex.Item as={Flex} col>\n      <Flex.Item as={H5} className=\"gray4\">\n        {title}\n      </Flex.Item>\n      {value.matchWith({\n        Nothing: () => (\n          <Flex.Item as={Text} className=\"f5 gray4\">\n            Unset\n          </Flex.Item>\n        ),\n        Just: ({ value }) => <Flex.Item as={Text}>{value}</Flex.Item>,\n      })}\n    </Flex.Item>\n  );\n\n  return (\n    <>\n      {renderNetworkKeySection(\n        'Authentication',\n        details.chain(chainKeyProp('authenticationKey'))\n      )}\n      {renderNetworkKeySection(\n        'Encryption',\n        details.chain(chainKeyProp('encryptionKey'))\n      )}\n      <Grid.Item full as={Flex} row justify=\"between\" className=\"mt3\">\n        {renderDetail(\n          'Revision',\n          details.map(d => d.keyRevisionNumber)\n        )}\n        {renderDetail(\n          'Continuity Era',\n          details.map(d => d.continuityNumber)\n        )}\n        {renderDetail(\n          'Crypto Suite Ver.',\n          details.map(d => d.cryptoSuiteVersion)\n        )}\n      </Grid.Item>\n      {hasKeys && (\n        <Grid.Item full as={Flex} row justify=\"between\" className=\"mt3\">\n          {renderDetail(\n            'Last Set',\n            getRekeyDate(point).map(date =>\n              date.matchWith({\n                Ok: r => formatDotsWithTime(r.value),\n                Error: () => Nothing(),\n              })\n            )\n          )}\n        </Grid.Item>\n      )}\n    </>\n  );\n}\n","import React from 'react';\nimport cn from 'classnames';\nimport { Flex, Text } from 'indigo-react';\nimport { Icon } from '@tlon/indigo-react';\n\nexport default function AlertBox({ className, children }) {\n  return (\n    <Flex className={cn('bg-red5 pv3 ph4', className)} align=\"center\">\n      <span className=\"circular-icon-bg bg-red6\">\n        <Icon\n          display=\"inline-block\"\n          icon=\"ExclaimationMark\"\n          size=\"18px\"\n          color={'white'}\n        />\n      </span>\n      <Text className=\"f6 fw-bolder red5\">{children}</Text>\n    </Flex>\n  );\n}\n","import React from 'react';\nimport { B } from 'indigo-react';\n\nimport { DownloadButton } from 'components/Buttons';\n\nexport default function DownloadKeyfileButton({\n  // useKeyfileGenerator.bind\n  generating,\n  available,\n  downloaded,\n  download,\n  notice,\n\n  // from caller\n  className,\n  children = 'Download Arvo Keyfile',\n  ...rest\n}) {\n  return (\n    <DownloadButton\n      as=\"span\"\n      className={className}\n      disabled={!available}\n      disabledDetail={\n        !available && <B className=\"wrap ws-normal\">· {notice}</B>\n      }\n      loading={generating}\n      onClick={download}\n      {...rest}>\n      {children}\n    </DownloadButton>\n  );\n}\n","import { useCallback, useMemo, useEffect, useState } from 'react';\nimport { Just, Nothing } from 'folktale/maybe';\nimport saveAs from 'file-saver';\nimport ob from 'urbit-ob';\n\nimport { usePointCache } from 'store/pointCache';\nimport { useWallet } from 'store/wallet';\nimport { usePointCursor } from 'store/pointCursor';\n\nimport * as need from 'lib/need';\nimport { generateCode } from 'lib/networkCode';\n\nimport {\n  attemptNetworkSeedDerivation,\n  keysMatchChain,\n  deriveNetworkKeys,\n  compileNetworkingKey,\n} from './keys';\nimport useCurrentPermissions from './useCurrentPermissions';\nimport { convertToInt } from './convertToInt';\n\nexport default function useKeyfileGenerator(manualNetworkSeed) {\n  const { urbitWallet, wallet, authMnemonic, authToken } = useWallet();\n  const { pointCursor } = usePointCursor();\n  const { getDetails } = usePointCache();\n\n  const [notice, setNotice] = useState('Deriving networking keys...');\n  const [downloaded, setDownloaded] = useState(false);\n  const [generating, setGenerating] = useState(true);\n  const [keyfile, setKeyfile] = useState(false);\n\n  const [code, setCode] = useState(false);\n\n  const _point = need.point(pointCursor);\n  const details = getDetails(_point);\n\n  const networkRevision = details.matchWith({\n    Just: ({ value }) => convertToInt(value.keyRevisionNumber, 10),\n    Nothing: () => 0,\n  });\n  const { isOwner, isManagementProxy } = useCurrentPermissions();\n\n  const hasNetworkingKeys = networkRevision > 0;\n  const available =\n    (isOwner || isManagementProxy) && hasNetworkingKeys && !!keyfile;\n\n  const generate = useCallback(async () => {\n    if (!hasNetworkingKeys) {\n      setGenerating(false);\n      setNotice('Networking keys not yet set.');\n      console.log(\n        `no networking keys available for revision ${networkRevision}`\n      );\n      return;\n    }\n\n    const _details = need.details(details);\n\n    const networkSeed = manualNetworkSeed\n      ? Just(manualNetworkSeed)\n      : await attemptNetworkSeedDerivation({\n          urbitWallet,\n          wallet,\n          authMnemonic,\n          details: _details,\n          authToken,\n          point: _point,\n          revision: networkRevision,\n        });\n\n    if (Nothing.hasInstance(networkSeed)) {\n      setGenerating(false);\n      setNotice(\n        'Custom or nondeterministic networking keys cannot be re-downloaded.'\n      );\n      console.log(`seed is nondeterminable for revision ${networkRevision}`);\n      return;\n    }\n\n    const _networkSeed = networkSeed.value;\n\n    const pair = deriveNetworkKeys(_networkSeed);\n\n    if (!keysMatchChain(pair, _details)) {\n      setGenerating(false);\n      setNotice('Derived networking keys do not match on-chain details.');\n      console.log(`keys do not match details for revision ${networkRevision}`);\n      return;\n    }\n\n    setNotice();\n    setCode(generateCode(pair));\n    setKeyfile(compileNetworkingKey(pair, _point, networkRevision));\n    setGenerating(false);\n  }, [\n    networkRevision,\n    hasNetworkingKeys,\n    manualNetworkSeed,\n    urbitWallet,\n    wallet,\n    authMnemonic,\n    setCode,\n    details,\n    _point,\n    authToken,\n  ]);\n\n  const filename = useMemo(() => {\n    return `${ob.patp(_point).slice(1)}-${networkRevision}.key`;\n    // TODO: ^ unifiy \"remove tilde\" calls\n  }, [_point, networkRevision]);\n\n  const download = useCallback(() => {\n    saveAs(\n      new Blob([keyfile], {\n        type: 'text/plain;charset=utf-8',\n      }),\n      filename\n    );\n    setDownloaded(true);\n  }, [filename, keyfile]);\n\n  useEffect(() => {\n    generate();\n  }, [generate]);\n\n  const values = {\n    generating,\n    available,\n    downloaded,\n    download,\n    filename,\n    notice,\n    keyfile,\n    code,\n  };\n\n  return { ...values, bind: values };\n}\n","import React from 'react';\nimport { CopyButton as BaseCopyButton } from 'components/Buttons';\nimport useCopiable from 'lib/useCopiable';\nimport WithTooltip, { TooltipPosition } from './WithTooltip';\n\nexport function CopyButtonWide({ text, children, ...rest }) {\n  const [doCopy, didCopy] = useCopiable(text);\n  return (\n    <WithTooltip\n      content={didCopy ? 'Copied!' : 'Copy'}\n      className={'rel full nowrap copy-button-wide'}\n      position={TooltipPosition.TopRight}>\n      <BaseCopyButton as=\"span\" onClick={doCopy} text={text} {...rest}>\n        {children}\n      </BaseCopyButton>\n    </WithTooltip>\n  );\n}\n","import { CopyButtonWide } from 'components/CopyButtonWide';\nimport { Grid } from 'indigo-react';\n\ntype AccessCodeArgs = {\n  code: boolean | string;\n};\n\nconst AccessCode = ({ code }: AccessCodeArgs) => {\n  return code ? (\n    <>\n      <Grid.Divider />\n      <Grid.Item\n        full\n        detail=\"This is your code to access Urbit OS\"\n        as={CopyButtonWide}\n        text={code}\n        data-testid=\"access-code\">\n        Access Key\n      </Grid.Item>\n    </>\n  ) : null;\n};\n\nexport default AccessCode;\n","import React, { useState, useMemo, useCallback, useEffect } from 'react';\nimport { Grid } from 'indigo-react';\nimport * as ob from 'urbit-ob';\nimport { azimuth, ecliptic } from 'azimuth-js';\n\nimport { useNetwork } from 'store/network';\nimport { usePointCache } from 'store/pointCache';\n\nimport { PointInput } from 'form/Inputs';\nimport FormError from 'form/FormError';\nimport BridgeForm from 'form/BridgeForm';\n\nimport InlineEthereumTransaction from 'components/InlineEthereumTransaction';\nimport ViewHeader from 'components/ViewHeader';\nimport {\n  composeValidator,\n  buildPointValidator,\n  hasErrors,\n} from 'form/validators';\n\nimport * as need from 'lib/need';\nimport { validateMinimumPatpByteLength } from 'lib/validators';\nimport { usePointCursor } from 'store/pointCursor';\nimport useEthereumTransaction from 'lib/useEthereumTransaction';\n\nfunction useChangeSponsor() {\n  const { contracts } = useNetwork();\n  const { pointCursor } = usePointCursor();\n  const { syncExtras } = usePointCache();\n\n  const _contracts = need.contracts(contracts);\n  const point = need.point(pointCursor);\n\n  return useEthereumTransaction(\n    useCallback(sponsor => ecliptic.escape(_contracts, point, sponsor), [\n      point,\n      _contracts,\n    ]),\n    useCallback(() => {\n      syncExtras(point);\n    }, [syncExtras, point])\n  );\n}\n\nfunction ChangeSponsor({ onDone }) {\n  const { contracts } = useNetwork();\n  const { pointCursor } = usePointCursor();\n\n  const _contracts = need.contracts(contracts);\n  const point = need.point(pointCursor);\n  const { construct, unconstruct, inputsLocked, bind } = useChangeSponsor();\n\n  const validateFormAsync = useCallback(\n    async values => {\n      const sponsor = ob.patp2dec(values.sponsor);\n      const details = await azimuth.getPoint(_contracts, sponsor);\n\n      if (details.keyRevisionNumber === 0) {\n        return { sponsor: 'Sponsor is not online' };\n      }\n    },\n    [_contracts]\n  );\n\n  const validateForm = useCallback(\n    (values, errors) => {\n      if (hasErrors(errors)) {\n        return errors;\n      }\n      return validateFormAsync(values);\n    },\n    [validateFormAsync]\n  );\n\n  const validate = useMemo(() => {\n    const sponsorSize =\n      azimuth.getPointSize(point) === azimuth.PointSize.Star ? 1 : 2;\n    return composeValidator(\n      {\n        sponsor: buildPointValidator(sponsorSize, [\n          validateMinimumPatpByteLength(sponsorSize),\n        ]),\n      },\n      validateForm\n    );\n  }, [validateForm, point]);\n\n  const onValues = useCallback(\n    ({ valid, values }) => {\n      if (valid) {\n        construct(ob.patp2dec(values.sponsor));\n      } else {\n        unconstruct();\n      }\n    },\n    [construct, unconstruct]\n  );\n  return (\n    <Grid>\n      <Grid.Item full as={ViewHeader}>\n        Change Sponsor\n      </Grid.Item>\n      <BridgeForm validate={validate} onValues={onValues}>\n        {() => (\n          <>\n            <Grid.Item\n              full\n              as={PointInput}\n              name=\"sponsor\"\n              disabled={inputsLocked}\n              label=\"New sponsor\"\n            />\n            <Grid.Item full as={FormError} />\n            <Grid.Item\n              full\n              as={InlineEthereumTransaction}\n              {...bind}\n              onReturn={onDone}\n              label=\"Request\"\n            />\n          </>\n        )}\n      </BridgeForm>\n    </Grid>\n  );\n}\n\nfunction useCancelEscape() {\n  const { contracts } = useNetwork();\n  const { pointCursor } = usePointCursor();\n  const { syncExtras } = usePointCache();\n\n  const _contracts = need.contracts(contracts);\n  const point = need.point(pointCursor);\n\n  return useEthereumTransaction(\n    useCallback(() => ecliptic.cancelEscape(_contracts, point), [\n      point,\n      _contracts,\n    ]),\n    useCallback(() => syncExtras(point), [point, syncExtras])\n  );\n}\n\nfunction CurrentEscape({ onDone }) {\n  const { construct, bind } = useCancelEscape();\n\n  const { pointCursor } = usePointCursor();\n  const { getDetails } = usePointCache();\n\n  const point = need.point(pointCursor);\n\n  const details = need.details(getDetails(point));\n\n  const newSponsor = useMemo(() => ob.patp(details.escapeRequestedTo), [\n    details,\n  ]);\n\n  useEffect(() => {\n    construct();\n  }, [construct]);\n  return (\n    <Grid>\n      <Grid.Item full as={ViewHeader}>\n        Currently requesting <span className=\"mono\">{newSponsor}</span> as a new\n        sponsor\n      </Grid.Item>\n      <Grid.Item\n        full\n        as={InlineEthereumTransaction}\n        label=\"Cancel Request\"\n        {...bind}\n        onReturn={onDone}\n      />\n    </Grid>\n  );\n}\n\nexport default function UrbitOSChangeSponsor() {\n  const { pointCursor } = usePointCursor();\n\n  const point = need.point(pointCursor);\n\n  const { getDetails } = usePointCache();\n\n  const details = need.details(getDetails(point));\n\n  const [requested, setRequested] = useState(details.escapeRequested);\n\n  const onDone = useCallback(() => {\n    setRequested(details.escapeRequested);\n  }, [details, setRequested]);\n\n  return requested ? (\n    <CurrentEscape onDone={onDone} />\n  ) : (\n    <ChangeSponsor onDone={onDone} />\n  );\n}\n","import React, { useState } from 'react';\nimport { Grid } from 'indigo-react';\n\nimport { useHistory } from 'store/history';\n\nimport useCurrentPointName from 'lib/useCurrentPointName';\nimport useRouter from 'lib/useRouter';\nimport { LocalRouterProvider } from 'lib/LocalRouter';\n\nimport View from 'components/View';\nimport Crumbs from 'components/Crumbs';\nimport NavHeader from 'components/NavHeader';\n\nimport UrbitOSHome from './UrbitOS/Home';\nimport UrbitOSNetworkingKeys from './UrbitOS/NetworkingKeys';\nimport UrbitOSChangeSponsor from './UrbitOS/ChangeSponsor';\n\nconst NAMES = {\n  HOME: 'HOME',\n  CHANGE_SPONSOR: 'CHANGE_SPONSOR',\n  NETWORKING_KEYS: 'NETWORKING_KEYS',\n};\n\nconst VIEWS = {\n  [NAMES.HOME]: UrbitOSHome,\n  [NAMES.CHANGE_SPONSOR]: UrbitOSChangeSponsor,\n  [NAMES.NETWORKING_KEYS]: UrbitOSNetworkingKeys,\n};\n\nexport default function UrbitOS() {\n  const history = useHistory();\n  const name = useCurrentPointName();\n\n  const { Route, ...router } = useRouter({\n    names: NAMES,\n    views: VIEWS,\n    initialRoutes: [{ key: NAMES.HOME }],\n  });\n\n  const [manualNetworkSeed, setManualNetworkSeed] = useState();\n\n  return (\n    <View\n      pop={() =>\n        router.peek().key === NAMES.HOME ? history.pop() : router.pop()\n      }\n      inset>\n      <NavHeader>\n        <Crumbs\n          routes={[\n            { text: name, action: () => history.pop() },\n            { text: 'Urbit OS' },\n          ]}\n        />\n      </NavHeader>\n      <LocalRouterProvider value={router}>\n        <Grid className=\"mb4\"></Grid>\n        <Route\n          manualNetworkSeed={manualNetworkSeed}\n          setManualNetworkSeed={setManualNetworkSeed}\n        />\n      </LocalRouterProvider>\n    </View>\n  );\n}\n","import React, { useCallback, useState } from 'react';\nimport { Grid } from 'indigo-react';\nimport * as ob from 'urbit-ob';\nimport { azimuth } from 'azimuth-js';\n\nimport { usePointCursor } from 'store/pointCursor';\nimport { usePointCache } from 'store/pointCache';\n\nimport * as need from 'lib/need';\n\nimport { ForwardButton } from 'components/Buttons';\nimport NetworkingKeys from 'components/NetworkingKeys';\n\nimport { useLocalRouter } from 'lib/LocalRouter';\nimport { L1Point } from 'types/L1Point';\nimport AlertBox from 'components/AlertBox';\nimport DownloadKeyfileButton from 'components/DownloadKeyfileButton';\nimport useKeyfileGenerator from 'lib/useKeyfileGenerator';\nimport AccessCode from './AccessCode';\n\nexport default function UrbitOSHome({ manualNetworkSeed }) {\n  const { pointCursor } = usePointCursor();\n  const { getDetails } = usePointCache();\n\n  const { push, names } = useLocalRouter();\n\n  const point = need.point(pointCursor);\n  const details: L1Point = need.details(getDetails(point));\n\n  const sponsor = ob.patp(details.sponsor);\n\n  const [showKeys, setShowKeys] = useState(false);\n\n  const showSponsor = azimuth.getPointSize(point) !== azimuth.PointSize.Galaxy;\n  const toggleShowKeys = useCallback(() => setShowKeys(s => !s), [setShowKeys]);\n\n  // The initial key revision number is 0, and increments when set\n  const hasSetNetworkingKeys = details.keyRevisionNumber !== '0';\n  const networkKeysAction = hasSetNetworkingKeys ? 'Reset' : 'Initialize';\n\n  const goNetworkingKeys = useCallback(() => push(names.NETWORKING_KEYS), [\n    names,\n    push,\n  ]);\n\n  const goChangeSponsor = useCallback(() => push(names.CHANGE_SPONSOR), [\n    push,\n    names,\n  ]);\n\n  const { bind: keyBind, code } = useKeyfileGenerator();\n\n  return (\n    <>\n      <Grid>\n        <Grid.Item full className=\"mv7 f5\">\n          Urbit OS\n        </Grid.Item>\n        {showSponsor && (\n          <>\n            <Grid.Divider />\n            <Grid.Item\n              full\n              as={ForwardButton}\n              detail=\"A sponsor finds new peers in your network\"\n              accessory=\"Change\"\n              onClick={goChangeSponsor}>\n              <span className=\"mono\">{sponsor}</span>\n              <span className=\"f7 bg-black white p1 mb2 ml2 r4\">SPONSOR</span>\n            </Grid.Item>\n          </>\n        )}\n        {hasSetNetworkingKeys && (\n          <>\n            <Grid.Divider />\n            <Grid.Item\n              full\n              detail=\"A keyfile is used to boot your Urbit OS\"\n              as={DownloadKeyfileButton}\n              {...keyBind}\n            />\n          </>\n        )}\n        <AccessCode code={code} />\n        <Grid.Divider />\n        <Grid.Item full as={ForwardButton} onClick={goNetworkingKeys}>\n          {networkKeysAction} Networking Keys\n        </Grid.Item>\n        {hasSetNetworkingKeys && (\n          <>\n            <Grid.Divider />\n            <Grid.Item\n              full\n              as={ForwardButton}\n              accessory={showKeys ? '▲' : '▼'}\n              onClick={toggleShowKeys}>\n              View Networking Keys\n            </Grid.Item>\n            {showKeys && <Grid.Item full as={NetworkingKeys} point={point} />}\n          </>\n        )}\n        {!hasSetNetworkingKeys && (\n          <>\n            <Grid.Item full as={AlertBox} className=\"mt4\">\n              Networking Keys are required to generate a keyfile\n            </Grid.Item>\n          </>\n        )}\n      </Grid>\n    </>\n  );\n}\n","import React, { useCallback, useMemo, useRef } from 'react';\nimport { Just } from 'folktale/maybe';\nimport { Grid, ToggleInput, CheckboxInput } from 'indigo-react';\nimport * as azimuth from 'azimuth-js';\nimport { randomHex } from 'web3-utils';\n\nimport { usePointCursor } from 'store/pointCursor';\nimport { usePointCache } from 'store/pointCache';\nimport { useNetwork } from 'store/network';\nimport { useWallet } from 'store/wallet';\n\nimport { useLocalRouter } from 'lib/LocalRouter';\nimport * as need from 'lib/need';\nimport {\n  attemptNetworkSeedDerivation,\n  deriveNetworkKeys,\n  CRYPTO_SUITE_VERSION,\n} from 'lib/keys';\nimport useEthereumTransaction from 'lib/useEthereumTransaction';\nimport { GAS_LIMITS } from 'lib/constants';\nimport { addHexPrefix } from 'lib/utils/address';\nimport useKeyfileGenerator from 'lib/useKeyfileGenerator';\n\nimport ViewHeader from 'components/ViewHeader';\nimport DownloadKeyfileButton from 'components/DownloadKeyfileButton';\nimport InlineEthereumTransaction from 'components/InlineEthereumTransaction';\nimport NoticeBox from 'components/NoticeBox';\nimport AlertBox from 'components/AlertBox';\n\nimport { HexInput } from 'form/Inputs';\nimport {\n  composeValidator,\n  buildCheckboxValidator,\n  buildHexValidator,\n} from 'form/validators';\nimport BridgeForm from 'form/BridgeForm';\nimport Condition from 'form/Condition';\nimport FormError from 'form/FormError';\nimport { convertToInt } from 'lib/convertToInt';\n\nfunction useSetKeys(manualNetworkSeed, setManualNetworkSeed) {\n  const { urbitWallet, wallet, authMnemonic, authToken } = useWallet();\n  const { pointCursor } = usePointCursor();\n  const { syncDetails, syncRekeyDate, getDetails } = usePointCache();\n  const { contracts } = useNetwork();\n\n  const _point = need.point(pointCursor);\n  const _contracts = need.contracts(contracts);\n  const _details = need.details(getDetails(_point));\n\n  const networkRevision = convertToInt(_details.keyRevisionNumber, 10);\n  const randomSeed = useRef();\n\n  const {\n    available: keyfileAvailable,\n    generating: keyfileGenerating,\n    filename,\n    bind: keyfileBind,\n  } = useKeyfileGenerator(manualNetworkSeed);\n\n  const buildNetworkSeed = useCallback(\n    async manualSeed => {\n      if (manualSeed !== undefined) {\n        setManualNetworkSeed(manualSeed);\n        return manualSeed;\n      } else {\n        const newNetworkRevision = networkRevision + 1;\n        console.log(`deriving seed with revision ${newNetworkRevision}`);\n\n        const networkSeed = await attemptNetworkSeedDerivation({\n          urbitWallet,\n          wallet,\n          authMnemonic,\n          details: _details,\n          point: _point,\n          authToken,\n          revision: newNetworkRevision,\n        });\n\n        if (Just.hasInstance(networkSeed)) {\n          return networkSeed.value;\n        }\n\n        randomSeed.current = randomSeed.current || randomHex(32); // 32 bytes\n        setManualNetworkSeed(randomSeed.current);\n\n        return randomSeed.current;\n      }\n    },\n    [\n      _details,\n      authMnemonic,\n      setManualNetworkSeed,\n      networkRevision,\n      urbitWallet,\n      wallet,\n      _point,\n      authToken,\n    ]\n  );\n\n  const { completed: _completed, ...rest } = useEthereumTransaction(\n    useCallback(\n      async (manualSeed, isDiscontinuity) => {\n        const seed = await buildNetworkSeed(manualSeed);\n        const pair = deriveNetworkKeys(seed);\n\n        return azimuth.ecliptic.configureKeys(\n          _contracts,\n          _point,\n          addHexPrefix(pair.crypt.public),\n          addHexPrefix(pair.auth.public),\n          CRYPTO_SUITE_VERSION,\n          isDiscontinuity\n        );\n      },\n      [_contracts, _point, buildNetworkSeed]\n    ),\n    useCallback(\n      () => Promise.all([syncDetails(_point), syncRekeyDate(_point)]),\n      [_point, syncDetails, syncRekeyDate]\n    ),\n    GAS_LIMITS.CONFIGURE_KEYS\n  );\n\n  // only treat the transaction as completed once we also have keys to download\n  const completed = _completed && keyfileAvailable && !keyfileGenerating;\n\n  return {\n    completed,\n    filename,\n    keyfileBind,\n    ...rest,\n  };\n}\n\nexport default function UrbitOSNetworkingKeys({\n  manualNetworkSeed,\n  setManualNetworkSeed,\n}) {\n  const { pop } = useLocalRouter();\n  const { pointCursor } = usePointCursor();\n  const { getDetails } = usePointCache();\n\n  const point = need.point(pointCursor);\n  const details = getDetails(point);\n\n  const hasKeys = details.matchWith({\n    Nothing: () => false,\n    Just: ({ value: details }) => parseInt(details.keyRevisionNumber, 10) > 0,\n    // we actually don't mind the default NaN behavior of parseInt here,\n    // since NaN > 0 === false and that's a reasonable result\n  });\n\n  const {\n    construct,\n    unconstruct,\n    completed,\n    inputsLocked,\n    bind,\n    keyfileBind,\n  } = useSetKeys(manualNetworkSeed, setManualNetworkSeed);\n\n  const validateForm = useCallback((values, errors) => {\n    if (values.useNetworkSeed && errors.networkSeed) {\n      return errors;\n    }\n  }, []);\n\n  const validate = useMemo(\n    () =>\n      composeValidator(\n        {\n          useNetworkSeed: buildCheckboxValidator(),\n          networkSeed: buildHexValidator(64), // 64 chars\n          useDiscontinuity: buildCheckboxValidator(),\n        },\n        validateForm\n      ),\n    [validateForm]\n  );\n\n  const onValues = useCallback(\n    ({ valid, values, form }) => {\n      if (valid) {\n        construct(\n          values.useNetworkSeed ? values.networkSeed : undefined,\n          values.useDiscontinuity\n        );\n      } else {\n        unconstruct();\n      }\n\n      if (!values.useNetworkSeed && values.networkSeed) {\n        form.change('networkSeed', '');\n      }\n    },\n    [construct, unconstruct]\n  );\n\n  const initialValues = useMemo(\n    () => ({\n      useNetworkSeed: false,\n      useDiscontinuity: false,\n    }),\n    []\n  );\n\n  const viewTitle = completed\n    ? 'Network Keys are now set'\n    : 'Set Networking Keys';\n\n  const usageMessage =\n    'You need this keyfile to authenticate with your OS. Please Download.';\n\n  return (\n    <>\n      <Grid>\n        <Grid.Item full as={ViewHeader}>\n          {viewTitle}\n        </Grid.Item>\n        {!completed && (\n          <Grid.Item className=\"gray4 f5\" full>\n            Network Keys authenticate Urbit ID with Urbit OS.\n          </Grid.Item>\n        )}\n        {completed && (\n          <>\n            <Grid.Item\n              full\n              className=\"mb3\"\n              as={DownloadKeyfileButton}\n              solid\n              {...keyfileBind}\n            />\n            <Grid.Item full as={AlertBox} className=\"mb8\">\n              {usageMessage}\n            </Grid.Item>\n          </>\n        )}\n        <BridgeForm\n          validate={validate}\n          onValues={onValues}\n          initialValues={initialValues}>\n          {() => (\n            <>\n              {!completed && (\n                <>\n                  <Grid.Item\n                    full\n                    as={ToggleInput}\n                    name=\"useNetworkSeed\"\n                    label=\"Use Custom Network Seed\"\n                    inverseLabel=\"Back to Derived Network Seed\"\n                    disabled={inputsLocked}\n                  />\n                  <Condition when=\"useNetworkSeed\" is={true}>\n                    <Grid.Item full as={NoticeBox} className=\"mb2\">\n                      When using a custom network seed, you'll need to download\n                      your Arvo keyfile immediately after this transaction as\n                      Bridge does not store your seed.\n                    </Grid.Item>\n                    <Grid.Item\n                      full\n                      as={HexInput}\n                      name=\"networkSeed\"\n                      label=\"Network Seed (32 bytes)\"\n                      disabled={inputsLocked}\n                    />\n                  </Condition>\n                  <Grid.Item\n                    full\n                    as={CheckboxInput}\n                    name=\"useDiscontinuity\"\n                    label=\"Breach Continuity\"\n                    disabled={inputsLocked}\n                  />\n\n                  <Grid.Item full as={FormError} />\n                </>\n              )}\n\n              <Grid.Item\n                full\n                as={InlineEthereumTransaction}\n                {...bind}\n                label={`${hasKeys ? 'Reset' : 'Set'} Networking Keys`}\n                onReturn={() => pop()}\n              />\n            </>\n          )}\n        </BridgeForm>\n      </Grid>\n    </>\n  );\n}\n","export const PROXY_TYPE = {\n  MANAGEMENT: 'MANAGEMENT',\n  SPAWN: 'SPAWN',\n  TRANSFER: 'TRANSFER',\n  VOTING: 'VOTING',\n};\n\nexport const proxyTypeToHuman = proxyType => {\n  switch (proxyType) {\n    case PROXY_TYPE.MANAGEMENT:\n      return 'management';\n    case PROXY_TYPE.SPAWN:\n      return 'spawn';\n    case PROXY_TYPE.TRANSFER:\n      return 'transfer';\n    case PROXY_TYPE.VOTING:\n      return 'voting';\n    default:\n      throw new Error(`Unknown proxyType: ${proxyType}`);\n  }\n};\n\nexport const proxyTypeToHumanDescription = proxyType => {\n  switch (proxyType) {\n    case PROXY_TYPE.MANAGEMENT:\n      return 'Your management key can configure networking settings (network keys and sponsorship)';\n    case PROXY_TYPE.SPAWN:\n      return 'Your spawn key can spawn points.';\n    case PROXY_TYPE.TRANSFER:\n      return 'Your transfer key can transfer this point.';\n    case PROXY_TYPE.VOTING:\n      return \"Your voting key can vote on this point's behalf.\";\n    default:\n      throw new Error(`Unknown proxyType: ${proxyType}`);\n  }\n};\n","export const capitalize = str => str.charAt(0).toUpperCase() + str.slice(1);\n","import { useCallback } from 'react';\nimport { saveAs } from 'file-saver';\nimport { sigil, stringRenderer } from 'urbit-sigil-js';\nimport * as ob from 'urbit-ob';\n\nimport {\n  dataURItoBlob,\n  loadImg,\n  initCanvas,\n  cleanupCanvas,\n} from 'lib/SigilDownloader';\n\nexport default function useSigilDownloader(canvasRef) {\n  const downloadSigil = useCallback(\n    (point, colors, size) => {\n      const patp = ob.patp(point);\n\n      const _size = size / window.devicePixelRatio;\n\n      const DATA_URI_PREFIX = 'data:image/svg+xml;base64,';\n\n      // initialize canvas element\n      const canvas = initCanvas(canvasRef.current, { x: _size, y: _size });\n      const ctx = canvas.getContext('2d');\n\n      // make sigil svg and encoded into base64\n      const svg = sigil({\n        patp,\n        renderer: stringRenderer,\n        size: _size,\n        colors,\n        margin: (54 / 256) * _size,\n      });\n\n      // FF rendering hack\n      const svgDocument = new DOMParser().parseFromString(svg, 'image/svg+xml');\n      svgDocument.documentElement.width.baseVal.valueAsString = `${size}px`;\n      svgDocument.documentElement.height.baseVal.valueAsString = `${size}px`;\n      const svgText = new XMLSerializer().serializeToString(svgDocument);\n      const svg64 = btoa(svgText);\n\n      return loadImg(DATA_URI_PREFIX + svg64, _size, _size)\n        .then(img => {\n          ctx.drawImage(img, 0, 0, _size, _size);\n          const png = dataURItoBlob(canvas.toDataURL('image/png'));\n          saveAs(png, `${patp.slice(1)}-sigil.png`);\n          ctx.clearRect(0, 0, _size, _size);\n        })\n        .catch(() => 'Error generating sigil')\n        .then(r => {\n          cleanupCanvas(canvasRef.current);\n          return r;\n        });\n    },\n    [canvasRef]\n  );\n  return { downloadSigil };\n}\n","export const initCanvas = (canvas, size) => {\n  const { x, y } = size;\n  const ctx = canvas.getContext('2d');\n\n  let ratio = window.devicePixelRatio || 1;\n\n  canvas.width = x * ratio;\n  canvas.height = y * ratio;\n  canvas.style.width = x + 'px';\n  canvas.style.height = y + 'px';\n\n  ctx.scale(ratio, ratio);\n\n  return canvas;\n};\n\nexport const cleanupCanvas = canvas => {\n  canvas.width = 0;\n  canvas.height = 0;\n};\n\nexport const loadImg = src =>\n  new Promise((resolve, reject) => {\n    const img = new Image();\n    img.onload = () => resolve(img);\n    img.onerror = () => reject(`Error loading image. src: ${src}`);\n    img.src = src;\n  });\n\nexport const dataURItoBlob = dataURI => {\n  // convert base64 to raw binary data held in a string\n  // doesn't handle URLEncoded DataURIs\n  const byteString = atob(dataURI.split(',')[1]);\n  // separate out the mime component\n  const mimeString = dataURI\n    .split(',')[0]\n    .split(':')[1]\n    .split(';')[0];\n  // write the bytes of the string to an ArrayBuffer\n  const ab = new ArrayBuffer(byteString.length);\n  // create a view into the buffer\n  let ia = new Uint8Array(ab);\n  // set the bytes of the buffer to the correct values\n  for (var i = 0; i < byteString.length; i++) {\n    ia[i] = byteString.charCodeAt(i);\n  }\n  // write the ArrayBuffer to a blob, and you're done\n  const blob = new Blob([ab], { type: mimeString });\n  return blob;\n};\n","import React from 'react';\nimport { useField } from 'react-final-form';\nimport cn from 'classnames';\nimport { Flex } from 'indigo-react';\n\nconst ColorInput = ({ name, colors, disabled = false, label, className }) => {\n  const { input } = useField(name, { subscription: { value: true } });\n\n  const isWhite = c => c.toUpperCase() === '#FFFFFF';\n\n  return (\n    <Flex col className={cn(className, 'flex-wrap mb1')}>\n      <Flex.Item\n        as=\"label\"\n        className={cn('f6 lh-tall', {\n          black: !disabled,\n          gray4: disabled,\n        })}\n        htmlFor={name}>\n        {label}\n      </Flex.Item>\n      <Flex.Item as={Flex} wrap>\n        {colors.map(c => (\n          <Flex.Item\n            as=\"button\"\n            type=\"button\"\n            key={c}\n            className={cn('m0 p0 h7 w7 p2 flex flex-center', {\n              'b b-black': isWhite(c),\n            })}\n            style={{ backgroundColor: c }}\n            onClick={() => input.onChange(c)}>\n            {c === input.value ? (\n              <div\n                className={cn(\n                  { 'bg-black': isWhite(c), 'bg-white': !isWhite(c) },\n                  'w2 h2 r-full'\n                )}\n              />\n            ) : (\n              <div />\n            )}\n          </Flex.Item>\n        ))}\n      </Flex.Item>\n    </Flex>\n  );\n};\n\nexport default ColorInput;\n","import React, { useRef, useCallback } from 'react';\nimport { Grid, Flex } from 'indigo-react';\nimport * as ob from 'urbit-ob';\nimport { FORM_ERROR } from 'final-form';\nimport { colors } from 'indigo-tokens';\n\nimport { usePointCursor } from 'store/pointCursor';\n\nimport Sigil from 'components/Sigil';\n\nimport * as need from 'lib/need';\nimport useSigilDownloader from 'lib/useSigilDownloader';\n\nimport { composeValidator, buildNumberValidator } from 'form/validators';\nimport BridgeForm from 'form/BridgeForm';\nimport FormError from 'form/FormError';\nimport SubmitButton from 'form/SubmitButton';\nimport { NumberInput } from 'form/Inputs';\nimport ColorInput from 'form/ColorInput';\n\nconst BG_COLORS = [\n  colors.black,\n  colors.white,\n  colors.blue,\n  colors.blueLight,\n  colors.blueDark,\n  colors.redLight,\n  colors.red,\n  colors.redDark,\n  colors.greenLight,\n  colors.green,\n  colors.greenDark,\n  colors.yellowLight,\n  colors.yellow,\n  colors.yellowDark,\n];\n\nconst FG_COLORS = [colors.black, colors.white];\n\nexport default function SigilGenerator() {\n  const { pointCursor } = usePointCursor();\n\n  const validate = composeValidator({ size: buildNumberValidator(16) });\n  const point = need.point(pointCursor);\n\n  const canvasRef = useRef(null);\n\n  const { downloadSigil } = useSigilDownloader(canvasRef);\n  const onSubmit = useCallback(\n    async (values, form) => {\n      const colors = [values.bgColor, values.fgColor];\n      const error = await downloadSigil(point, colors, values.size);\n      if (error) {\n        return { [FORM_ERROR]: error };\n      }\n      // reset on next tick\n      setTimeout(() => form.reset(values));\n    },\n    [point, downloadSigil]\n  );\n  return (\n    <>\n      <BridgeForm\n        validate={validate}\n        initialValues={{\n          size: 256,\n          fgColor: '#FFFFFF',\n          bgColor: '#000000',\n        }}\n        onSubmit={onSubmit}>\n        {({ handleSubmit, values }) => (\n          <Grid gap={6}>\n            <Grid.Item full className=\"f5\">\n              Sigil\n            </Grid.Item>\n            <Grid.Item fourth={1}>\n              <Sigil\n                size={50}\n                patp={ob.patp(point)}\n                colors={[values.bgColor, values.fgColor]}\n              />\n            </Grid.Item>\n\n            <Grid.Item full as={Flex} col>\n              <Flex.Item className=\"mb1\">Urbit ID</Flex.Item>\n              <Flex.Item className=\"mono\">{ob.patp(point)}</Flex.Item>\n            </Grid.Item>\n            <Grid.Item\n              fourth={1}\n              as={NumberInput}\n              name=\"size\"\n              label=\"Size (px)\"\n            />\n            <Grid.Item\n              full\n              as={ColorInput}\n              name=\"bgColor\"\n              label=\"Background Color\"\n              colors={BG_COLORS}\n            />\n            <Grid.Item\n              full\n              as={ColorInput}\n              name=\"fgColor\"\n              label=\"Foreground Color\"\n              colors={FG_COLORS}\n            />\n            <Grid.Item\n              full\n              as={SubmitButton}\n              handleSubmit={handleSubmit}\n              accessory=\"↓\">\n              Download Sigil\n            </Grid.Item>\n            <Grid.Item full as={FormError} />\n          </Grid>\n        )}\n      </BridgeForm>\n\n      <canvas style={{ display: 'none' }} ref={canvasRef} />\n    </>\n  );\n}\n","import React, { useCallback, useMemo } from 'react';\nimport { Text, Grid, CheckboxInput } from 'indigo-react';\n\nimport { useLocalRouter } from 'lib/LocalRouter';\nimport { validateExactly } from 'lib/validators';\nimport { isDevelopment } from 'lib/flags';\n\nimport BridgeForm from 'form/BridgeForm';\nimport { TicketInput } from 'form/Inputs';\nimport { composeValidator, buildPatqValidator } from 'form/validators';\nimport SubmitButton from 'form/SubmitButton';\nimport FormError from 'form/FormError';\n\nconst STUB_VERIFY_TICKET = isDevelopment;\n\nexport default function ResetVerify({ newWallet }) {\n  const { push, names } = useLocalRouter();\n\n  const ticket = newWallet.value.wallet.ticket;\n  const validate = useMemo(\n    () =>\n      composeValidator({\n        ticket: buildPatqValidator([\n          validateExactly(ticket, 'Does not match expected master ticket.'),\n        ]),\n      }),\n    [ticket]\n  );\n\n  const initialValues = useMemo(\n    () => ({\n      ticket: STUB_VERIFY_TICKET ? ticket : undefined,\n    }),\n    [ticket]\n  );\n\n  const goExecute = useCallback(() => push(names.EXECUTE), [push, names]);\n\n  return (\n    <Grid className=\"mt4\">\n      <Grid.Item full as={Text}>\n        Verify New Master Ticket\n      </Grid.Item>\n      <BridgeForm\n        validate={validate}\n        afterSubmit={goExecute}\n        initialValues={initialValues}>\n        {({ handleSubmit, values }) => (\n          <>\n            <Grid.Item\n              full\n              as={TicketInput}\n              className=\"mt4\"\n              type={values.showTicket ? 'text' : 'password'}\n              name=\"ticket\"\n              label=\"New master ticket\"\n            />\n\n            <Grid.Item full as={CheckboxInput} name=\"showTicket\" label=\"Show\" />\n\n            <Grid.Item full as={FormError} />\n\n            <Grid.Item full as={SubmitButton} handleSubmit={handleSubmit}>\n              Verify & Reticket\n            </Grid.Item>\n          </>\n        )}\n      </BridgeForm>\n    </Grid>\n  );\n}\n","import React, { useState, useCallback, useEffect } from 'react';\nimport { Just, Nothing } from 'folktale/maybe';\nimport { Grid, H4, Text, ErrorText } from 'indigo-react';\n\nimport {\n  reticketPointBetweenWallets,\n  TRANSACTION_PROGRESS,\n} from 'lib/reticket';\nimport * as need from 'lib/need';\nimport { WALLET_TYPES } from 'lib/constants';\nimport { convertToInt } from 'lib/convertToInt';\nimport useBlockWindowClose from 'lib/useBlockWindowClose';\n\nimport { useNetwork } from 'store/network';\nimport { useWallet } from 'store/wallet';\nimport { usePointCursor } from 'store/pointCursor';\nimport { usePointCache } from 'store/pointCache';\nimport { useHistory } from 'store/history';\n\nimport { useWalletConnect } from 'lib/useWalletConnect';\n\nimport { RestartButton, ForwardButton } from 'components/Buttons';\nimport WarningBox from 'components/WarningBox';\nimport LoadingBar from 'components/LoadingBar';\nimport NeedFundsNotice from 'components/NeedFundsNotice';\n\nconst labelForProgress = progress => {\n  if (progress <= 0) {\n    return 'Starting...';\n  } else if (progress <= TRANSACTION_PROGRESS.GENERATING) {\n    return 'Generating Ethereum Transactions...';\n  } else if (progress <= TRANSACTION_PROGRESS.SIGNING) {\n    return 'Signing Ethereum Transactions...';\n  } else if (progress <= TRANSACTION_PROGRESS.FUNDING) {\n    return 'Funding Ethereum Transactions...';\n  } else if (progress <= TRANSACTION_PROGRESS.TRANSFERRING) {\n    return 'Transferring ID...';\n  } else if (progress <= TRANSACTION_PROGRESS.CLEANING) {\n    return 'Cleaning Up...';\n  } else if (progress <= TRANSACTION_PROGRESS.DONE) {\n    return 'Done';\n  }\n};\n\nexport default function ResetExecute({ newWallet, setNewWallet }) {\n  const { popTo, names, reset } = useHistory();\n  const { web3, contracts, networkType } = useNetwork();\n  const {\n    wallet,\n    setWalletType,\n    resetWallet,\n    setUrbitWallet,\n    walletType,\n    walletHdPath,\n  } = useWallet();\n  const { pointCursor } = usePointCursor();\n  const { getDetails } = usePointCache();\n  const {\n    signTransaction: wcSign,\n    sendTransaction: wcSend,\n    connector,\n  } = useWalletConnect();\n\n  const [generalError, setGeneralError] = useState();\n  const [progress, setProgress] = useState(0);\n  const [needFunds, setNeedFunds] = useState();\n  const isDone = progress >= 1.0;\n\n  useBlockWindowClose();\n\n  // start reticketing transactions on mount\n  useEffect(() => {\n    (async () => {\n      // due to react shenanigans we may need to wait for the connector\n      if (\n        walletType === WALLET_TYPES.WALLET_CONNECT &&\n        (!connector || !connector.connected)\n      ) {\n        setGeneralError(new Error('Awaiting WalletConnect connection...'));\n        return;\n      }\n      setGeneralError();\n\n      const point = need.point(pointCursor);\n      const details = need.details(getDetails(point));\n      const networkRevision = convertToInt(details.keyRevisionNumber, 10);\n\n      // see also comment in useEthereumTransaction\n      const txnSigner =\n        walletType === WALLET_TYPES.WALLET_CONNECT ? wcSign : undefined;\n      const txnSender =\n        walletType === WALLET_TYPES.WALLET_CONNECT ? wcSend : undefined;\n\n      try {\n        await reticketPointBetweenWallets({\n          fromWallet: need.wallet(wallet),\n          fromWalletType: walletType,\n          fromWalletHdPath: walletHdPath,\n          toWallet: newWallet.value.wallet,\n          point: point,\n          web3: need.web3(web3),\n          contracts: need.contracts(contracts),\n          networkType,\n          onUpdate: handleUpdate,\n          nextRevision: networkRevision + 1,\n          txnSigner,\n          txnSender,\n        });\n      } catch (err) {\n        console.error(err);\n        setGeneralError(err);\n      }\n    })();\n    //NOTE  this was using useLifecycle previously (which is useEffect without\n    //      dependencies) and worked fine, but in the wc case we might need to\n    //      wait for the connector to get set due to react state shenanigans.\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [connector]);\n\n  const goToRestart = useCallback(() => {\n    reset();\n    setNewWallet(Nothing());\n  }, [reset, setNewWallet]);\n\n  const loginAndGoHome = useCallback(() => {\n    // set wallet state\n    resetWallet();\n    setWalletType(WALLET_TYPES.TICKET);\n    setUrbitWallet(Just(newWallet.value.wallet));\n    // (implicit) pointCursor stays the same\n    // redirect to point\n    popTo(names.POINT);\n  }, [resetWallet, setWalletType, setUrbitWallet, newWallet, popTo, names]);\n\n  const handleUpdate = useCallback(\n    ({ type, state, value }) => {\n      switch (type) {\n        case 'progress':\n          return setProgress(state);\n        case 'askFunding':\n          return setNeedFunds(value);\n        case 'gotFunding':\n          return setNeedFunds(false);\n        default:\n          console.error(`Unknown update: ${type}`);\n      }\n    },\n    [setProgress, setNeedFunds]\n  );\n\n  const renderAdditionalInfo = () => {\n    if (generalError) {\n      console.log(generalError);\n      generalError.message = generalError.message || 'Something went wrong!';\n      return (\n        <>\n          <Grid.Item full className=\"mt4\">\n            <ErrorText>{generalError.message.toString()}</ErrorText>\n          </Grid.Item>\n          <Grid.Item\n            full\n            className=\"mt4\"\n            as={RestartButton}\n            solid\n            onClick={goToRestart}>\n            Restart\n          </Grid.Item>\n        </>\n      );\n    }\n\n    if (needFunds) {\n      return (\n        <Grid.Item full as={NeedFundsNotice} className=\"mt4\" {...needFunds} />\n      );\n    }\n\n    return (\n      <Grid.Item full as={WarningBox} className=\"mt4\">\n        Never give your Master Key to anyone\n      </Grid.Item>\n    );\n  };\n\n  return (\n    <Grid className=\"mt4\">\n      <Grid.Item full as={H4}>\n        {labelForProgress(progress)}\n      </Grid.Item>\n\n      {isDone ? (\n        <>\n          <Grid.Item full as={Text} className=\"mt4\">\n            Your changes are now reflected on-chain and you can use the new\n            ticket to manage your point.\n          </Grid.Item>\n          <Grid.Item\n            full\n            as={ForwardButton}\n            solid\n            className=\"mt4\"\n            accessory=\"↺\"\n            onClick={loginAndGoHome}>\n            Login with New Master Key\n          </Grid.Item>\n        </>\n      ) : (\n        <>\n          <Grid.Item full as={Grid} className=\"mt4\" gap={3}>\n            <Grid.Item full as={LoadingBar} progress={progress} />\n            <Grid.Item full as={Text} className=\"f5 green4\">\n              This process can take up to 5 minutes to complete. Don't close\n              this page until the process is complete.\n            </Grid.Item>\n          </Grid.Item>\n\n          {renderAdditionalInfo()}\n        </>\n      )}\n    </Grid>\n  );\n}\n","import React, { useCallback, useState } from 'react';\nimport { Just, Nothing } from 'folktale/maybe';\nimport { Grid, Flex } from 'indigo-react';\n\nimport { LocalRouterProvider } from 'lib/LocalRouter';\nimport useRouter from 'lib/useRouter';\n\nimport Steps from 'components/Steps';\n\nimport ResetConfirm from './ResetKeys/ResetConfirm';\nimport ResetDownload from './ResetKeys/ResetDownload';\nimport ResetVerify from './ResetKeys/ResetVerify';\nimport ResetExecute from './ResetKeys/ResetExecute';\n\nconst NAMES = {\n  CONFIRM: 'CONFIRM',\n  DOWNLOAD: 'DOWNLOAD',\n  VERIFY: 'VERIFY',\n  EXECUTE: 'EXECUTE',\n};\n\nconst VIEWS = {\n  CONFIRM: ResetConfirm,\n  DOWNLOAD: ResetDownload,\n  VERIFY: ResetVerify,\n  EXECUTE: ResetExecute,\n};\n\nconst STEPS = [NAMES.CONFIRM, NAMES.DOWNLOAD, NAMES.VERIFY, NAMES.EXECUTE];\n\nexport default function ResetKeys() {\n  const { Route, ...router } = useRouter({\n    names: NAMES,\n    views: VIEWS,\n    initialRoutes: [{ key: NAMES.CONFIRM }],\n  });\n\n  const [newWallet, _setNewWallet] = useState(Nothing());\n\n  const setNewWallet = useCallback(\n    (wallet, paper) => {\n      _setNewWallet(\n        Just({\n          wallet,\n          paper,\n        })\n      );\n    },\n    [_setNewWallet]\n  );\n\n  return (\n    <LocalRouterProvider value={router}>\n      <Grid>\n        <Grid.Item full as={Flex} row align=\"center\">\n          <Flex.Item as={Steps} num={router.size} total={STEPS.length} />\n        </Grid.Item>\n      </Grid>\n      <Route newWallet={newWallet} setNewWallet={setNewWallet} />\n    </LocalRouterProvider>\n  );\n}\n","import React, { useState, useCallback } from 'react';\nimport { Just, Nothing } from 'folktale/maybe';\nimport { Grid, Text } from 'indigo-react';\nimport * as need from 'lib/need';\n\nimport { usePointCursor } from 'store/pointCursor';\n\nimport useLifecycle from 'lib/useLifecycle';\nimport { generateWallet } from 'lib/invite';\nimport { useLocalRouter } from 'lib/LocalRouter';\nimport { isDevelopment } from 'lib/flags';\n\nimport { ForwardButton } from 'components/Buttons';\nimport PaperBuilder from 'components/PaperBuilder';\nimport WarningBox from 'components/WarningBox';\nimport { blinkIf } from 'components/Blinky';\nimport useCurrentPointName from 'lib/useCurrentPointName';\n\nexport default function ResetConfirm({ newWallet, setNewWallet }) {\n  const { push, names } = useLocalRouter();\n  const { pointCursor } = usePointCursor();\n  const point = need.point(pointCursor);\n  const name = useCurrentPointName();\n\n  const [generatedWallet, setGeneratedWallet] = useState(Nothing());\n\n  // generating new wallet on mount, conveniently using it to 'force' users\n  // to read the disclaimer text\n  //TODO also check we can pay for the transactions?\n  useLifecycle(() => {\n    let mounted = true;\n    (async () => {\n      if (Just.hasInstance(newWallet)) {\n        // skip if already computed (hitting the back button for example)\n        return;\n      }\n\n      const wal = await generateWallet(point);\n      if (isDevelopment) {\n        console.log(`The new ticket for ${name} is ${wal.ticket}`);\n      }\n      if (!mounted) {\n        return;\n      }\n\n      setGeneratedWallet(Just(wal));\n    })();\n\n    return () => (mounted = false);\n  });\n\n  const goDownload = useCallback(() => push(names.DOWNLOAD), [push, names]);\n\n  const paperRenderer = generatedWallet.matchWith({\n    Nothing: () => null,\n    Just: ({ value: wallet }) => (\n      <PaperBuilder\n        point={point}\n        wallets={[wallet]}\n        callback={paper => {\n          setNewWallet(wallet, paper);\n        }}\n      />\n    ),\n  });\n\n  return (\n    <Grid className=\"mt4\">\n      <Grid.Item full as={Text}>\n        Reticketing is the process of generating a completely fresh wallet and\n        transferring ownership of your point to that wallet.\n      </Grid.Item>\n      <Grid.Item full as={WarningBox} className=\"mt4\">\n        Beware, this resets your proxy addresses; if you're using smart\n        contracts, this might break them! It will also change your networking\n        keys!\n      </Grid.Item>\n      <Grid.Item\n        full\n        as={ForwardButton}\n        solid\n        className=\"mt4\"\n        accessory={blinkIf(Nothing.hasInstance(newWallet))}\n        disabled={Nothing.hasInstance(newWallet)}\n        onClick={goDownload}>\n        I understand, continue\n      </Grid.Item>\n      {paperRenderer}\n    </Grid>\n  );\n}\n","import React, { useState, useCallback } from 'react';\nimport { Nothing } from 'folktale/maybe';\nimport { Grid, Text } from 'indigo-react';\n\nimport { useLocalRouter } from 'lib/LocalRouter';\nimport { downloadWallet } from 'lib/invite';\n\nimport { ForwardButton, DownloadButton } from 'components/Buttons';\n\nexport default function ReticketDownload({ newWallet }) {\n  const { push, names } = useLocalRouter();\n\n  const [downloaded, setDownloaded] = useState(false);\n\n  const download = () => {\n    downloadWallet(newWallet.value.paper);\n    setDownloaded(true);\n  };\n\n  const goVerify = useCallback(() => push(names.VERIFY), [push, names]);\n\n  return (\n    <Grid className=\"mt4\">\n      <Grid.Item full as={Text}>\n        Download the new passport, and keep it somewhere safe!\n      </Grid.Item>\n      <Grid.Item\n        full\n        as={!downloaded ? DownloadButton : ForwardButton}\n        className=\"mt4\"\n        disabled={Nothing.hasInstance(newWallet)}\n        onClick={!downloaded ? download : goVerify}\n        success={downloaded}\n        solid>\n        {!downloaded ? 'Download Passport' : 'Continue'}\n      </Grid.Item>\n    </Grid>\n  );\n}\n","import React from 'react';\nimport { Grid } from 'indigo-react';\n\nimport { useHistory } from 'store/history';\n\nimport useCurrentPointName from 'lib/useCurrentPointName';\nimport useRouter from 'lib/useRouter';\nimport { LocalRouterProvider } from 'lib/LocalRouter';\n\nimport View from 'components/View';\nimport Crumbs from 'components/Crumbs';\nimport NavHeader from 'components/NavHeader';\n\nimport UrbitIDHome from './UrbitID/Home';\nimport SigilGenerator from './UrbitID/SigilGenerator';\nimport DownloadKeys from './UrbitID/DownloadKeys';\nimport SetProxy from './UrbitID/SetProxy';\nimport ResetKeys from './UrbitID/ResetKeys';\nimport Transfer from './UrbitID/Transfer';\n\nconst NAMES = {\n  HOME: 'HOME',\n  SIGIL_GENERATOR: 'SIGIL_GENERATOR',\n  DOWNLOAD_KEYS: 'DOWNLOAD_KEYS',\n  SET_PROXY: 'SET_PROXY',\n  RESET_KEYS: 'RESET_KEYS',\n  TRANSFER: 'TRANSFER',\n};\n\nconst VIEWS = {\n  [NAMES.HOME]: UrbitIDHome,\n  [NAMES.SIGIL_GENERATOR]: SigilGenerator,\n  [NAMES.DOWNLOAD_KEYS]: DownloadKeys,\n  [NAMES.RESET_KEYS]: ResetKeys,\n  [NAMES.SET_PROXY]: SetProxy,\n  [NAMES.TRANSFER]: Transfer,\n};\n\nconst humanizeName = name => {\n  switch (name) {\n    case NAMES.SIGIL_GENERATOR:\n      return 'Sigil';\n    case NAMES.DOWNLOAD_KEYS:\n      return 'Download Keys';\n    case NAMES.SET_PROXY:\n      return 'Set Key';\n    case NAMES.RESET_KEYS:\n      return 'Reset Keys';\n    case NAMES.TRANSFER:\n      return 'Transfer';\n    default:\n      return undefined;\n  }\n};\n\nexport default function UrbitID() {\n  const history = useHistory();\n  const name = useCurrentPointName();\n\n  const { Route, ...router } = useRouter({\n    names: NAMES,\n    views: VIEWS,\n    initialRoutes: [{ key: NAMES.HOME }],\n  });\n\n  const last = router.peek().key;\n  const homeAction = last === NAMES.HOME ? undefined : () => history.pop();\n  const lastCrumb = homeAction ? [{ text: humanizeName(last) }] : [];\n\n  return (\n    <View\n      pop={() =>\n        router.peek().key === NAMES.HOME ? history.pop() : router.pop()\n      }\n      inset>\n      <NavHeader>\n        <Crumbs\n          routes={[\n            { text: name, action: () => history.pop() },\n            { text: 'Urbit ID', action: homeAction },\n            ...lastCrumb,\n          ]}\n        />\n      </NavHeader>\n\n      <LocalRouterProvider value={router}>\n        <Grid className=\"mb4\"></Grid>\n        <Route />\n      </LocalRouterProvider>\n    </View>\n  );\n}\n","import React, { useCallback } from 'react';\nimport { Grid, B } from 'indigo-react';\nimport { azimuth } from 'azimuth-js';\nimport { Just } from 'folktale/maybe';\n\nimport { ForwardButton } from 'components/Buttons';\nimport CopyButton from 'components/CopyButton';\n\nimport { useLocalRouter } from 'lib/LocalRouter';\nimport { PROXY_TYPE, proxyTypeToHuman } from 'lib/proxy';\nimport * as need from 'lib/need';\nimport { capitalize } from 'lib/capitalize';\nimport useCurrentPermissions from 'lib/useCurrentPermissions';\nimport { convertToInt } from 'lib/convertToInt';\n\nimport { usePointCursor } from 'store/pointCursor';\nimport { usePointCache } from 'store/pointCache';\nimport { useWallet } from 'store/wallet';\n\nexport default function UrbitIDHome() {\n  const { push, names } = useLocalRouter();\n  const { pointCursor } = usePointCursor();\n  const { getDetails } = usePointCache();\n  const { urbitWallet } = useWallet();\n\n  const goSigil = useCallback(() => push(names.SIGIL_GENERATOR), [push, names]);\n\n  const goDownloadKeys = useCallback(() => push(names.DOWNLOAD_KEYS), [\n    push,\n    names,\n  ]);\n\n  const goResetKeys = useCallback(() => push(names.RESET_KEYS), [push, names]);\n\n  const isMasterTicket = Just.hasInstance(urbitWallet);\n  const point = need.point(pointCursor);\n  const details = need.details(getDetails(point));\n  const { isOwner } = useCurrentPermissions();\n  const networkRevision = convertToInt(details.keyRevisionNumber, 10);\n\n  const pointSize = azimuth.getPointSize(point);\n  const isParent = pointSize !== azimuth.PointSize.Planet;\n  const isSenate = pointSize === azimuth.PointSize.Galaxy;\n\n  const goSetProxy = useCallback(\n    proxyType => push(names.SET_PROXY, { proxyType }),\n    [push, names]\n  );\n\n  const goTransfer = useCallback(() => push(names.TRANSFER), [names, push]);\n\n  const renderProxyAction = useCallback(\n    (proxyType, address) => {\n      const disabled =\n        !isOwner ||\n        (proxyType === PROXY_TYPE.SPAWN ? networkRevision === 0 : false);\n      return (\n        <>\n          <Grid.Item\n            full\n            as={ForwardButton}\n            disabled={disabled}\n            onClick={() => goSetProxy(proxyType)}>\n            Edit {capitalize(proxyTypeToHuman(proxyType))} Key\n          </Grid.Item>\n        </>\n      );\n    },\n    [goSetProxy, isOwner, networkRevision]\n  );\n  return (\n    <Grid>\n      <Grid.Item full className=\"mb7 f5\">\n        Urbit ID\n      </Grid.Item>\n      <Grid.Divider />\n      <Grid.Item full as={ForwardButton} onClick={goSigil}>\n        Sigil\n      </Grid.Item>\n      <Grid.Divider />\n      <Grid.Item\n        full\n        as={ForwardButton}\n        onClick={goDownloadKeys}\n        disabled={!isMasterTicket}\n        disabledDetail={\n          <B className=\"wrap ws-normal\">\n            · Master Key Authentication required.\n          </B>\n        }>\n        Download Keys\n      </Grid.Item>\n      <Grid.Divider />\n      <Grid.Item\n        full\n        as={ForwardButton}\n        onClick={goResetKeys}\n        disabled={!isOwner}\n        disabledDetail={\n          <B className=\"wrap ws-normal\"> · Ownership key required</B>\n        }\n        detail={\n          isMasterTicket\n            ? 'Reset Master Key and all other keys'\n            : 'Transfer to Master Ticket, resetting all keys'\n        }>\n        {isMasterTicket ? 'Reset Keys' : 'Transfer to Master Ticket'}\n      </Grid.Item>\n\n      <Grid.Divider />\n\n      <Grid.Item full className=\"mv7 f5 gray4\">\n        Advanced\n      </Grid.Item>\n      <Grid.Divider />\n      <Grid.Item\n        full\n        as={ForwardButton}\n        accessory={<CopyButton text={details.owner} />}\n        detail={<div className=\"mt1 mono black\">{details.owner}</div>}\n        disabled={!details.owner}>\n        Ownership Address\n      </Grid.Item>\n      <Grid.Divider />\n\n      {renderProxyAction(PROXY_TYPE.MANAGEMENT, details.managementProxy)}\n      <Grid.Divider />\n\n      {isParent && renderProxyAction(PROXY_TYPE.SPAWN, details.spawnProxy)}\n\n      {isParent && networkRevision !== 0 && <Grid.Divider />}\n\n      {isParent && networkRevision === 0 && (\n        <>\n          <Grid.Item\n            full\n            as={ForwardButton}\n            className=\"f6\"\n            accessory={<span className=\"underline pointer\">Set Keys</span>}>\n            Network Keys Required\n          </Grid.Item>\n          <Grid.Divider />\n        </>\n      )}\n\n      {isSenate && (\n        <>\n          {renderProxyAction(PROXY_TYPE.VOTING, details.votingProxy)}{' '}\n          <Grid.Divider />\n        </>\n      )}\n      <Grid.Item\n        full\n        as={ForwardButton}\n        onClick={goTransfer}\n        disabled={!isOwner}\n        disabledDetail={\n          <B className=\"wrap ws-normal\"> · Ownership key required</B>\n        }>\n        Transfer this point\n      </Grid.Item>\n    </Grid>\n  );\n}\n","import React, { useCallback, useState } from 'react';\nimport { Just, Nothing } from 'folktale/maybe';\nimport * as need from 'lib/need';\n\nimport { usePointCursor } from 'store/pointCursor';\n\nimport { DownloadButton, RestartButton } from 'components/Buttons';\nimport PaperBuilder from 'components/PaperBuilder';\n\nimport { downloadWallet } from 'lib/invite';\nimport useKeyfileGenerator from 'lib/useKeyfileGenerator';\n\nimport { useWallet } from 'store/wallet';\nimport { Grid, P } from 'indigo-react';\nimport ViewHeader from 'components/ViewHeader';\nimport { useLocalRouter } from 'lib/LocalRouter';\n\nexport default function AdminRedownload() {\n  const { urbitWallet } = useWallet();\n  const { pointCursor } = usePointCursor();\n  const { pop } = useLocalRouter();\n\n  const _urbitWallet = need.wallet(urbitWallet);\n  const point = need.point(pointCursor);\n\n  const { keyfile, filename } = useKeyfileGenerator();\n\n  const [paper, setPaper] = useState(Nothing());\n  const [downloaded, setDownloaded] = useState(false);\n\n  const doDownload = useCallback(() => {\n    downloadWallet(paper.value, keyfile, filename);\n    setDownloaded(true);\n  }, [paper, keyfile, filename, setDownloaded]);\n\n  const goBack = useCallback(() => pop(), [pop]);\n\n  return (\n    <>\n      <Grid>\n        <Grid.Item full as={ViewHeader}>\n          Download Passport\n        </Grid.Item>\n        <Grid.Item full as={P}>\n          After you’ve downloaded your passport, back up the ticket manually or\n          store on a trusted device.\n        </Grid.Item>\n        {downloaded ? (\n          <Grid.Item full as={RestartButton} solid onClick={goBack}>\n            Done\n          </Grid.Item>\n        ) : (\n          <Grid.Item\n            full\n            as={DownloadButton}\n            solid\n            disabled={Nothing.hasInstance(paper)}\n            onClick={doDownload}>\n            {paper.matchWith({\n              Nothing: () => 'Printing and folding...',\n              Just: _ => 'Download paper wallet',\n            })}\n          </Grid.Item>\n        )}\n      </Grid>\n      <PaperBuilder\n        point={point}\n        wallets={[_urbitWallet]}\n        callback={paper => {\n          setPaper(Just(paper));\n        }}\n      />\n    </>\n  );\n}\n","import React, { useCallback, useMemo } from 'react';\nimport cn from 'classnames';\nimport { Grid, Text, Flex } from 'indigo-react';\nimport * as azimuth from 'azimuth-js';\n\nimport { useNetwork } from 'store/network';\nimport { usePointCache } from 'store/pointCache';\nimport { usePointCursor } from 'store/pointCursor';\n\nimport {\n  PROXY_TYPE,\n  proxyTypeToHuman,\n  proxyTypeToHumanDescription,\n} from 'lib/proxy';\nimport * as need from 'lib/need';\nimport { useLocalRouter } from 'lib/LocalRouter';\nimport { eqAddr, isZeroAddress } from 'lib/utils/address';\nimport { capitalize } from 'lib/capitalize';\nimport useEthereumTransaction from 'lib/useEthereumTransaction';\n\nimport InlineEthereumTransaction from 'components/InlineEthereumTransaction';\nimport { ETH_ZERO_ADDR, GAS_LIMITS } from 'lib/constants';\nimport { AddressInput } from 'form/Inputs';\nimport {\n  composeValidator,\n  buildCheckboxValidator,\n  buildAddressValidator,\n} from 'form/validators';\nimport BridgeForm from 'form/BridgeForm';\nimport FormError from 'form/FormError';\n\nconst proxyFromDetails = (details, contracts, proxyType) => {\n  switch (proxyType) {\n    case PROXY_TYPE.MANAGEMENT:\n      return details.managementProxy;\n    case PROXY_TYPE.SPAWN:\n      return details.spawnProxy;\n    case PROXY_TYPE.TRANSFER:\n      return details.transferProxy;\n    case PROXY_TYPE.VOTING:\n      if (eqAddr(details.votingProxy, contracts.delegatedSending.address)) {\n        return `${details.votingProxy} (invites contract)`;\n      } else {\n        return details.votingProxy;\n      }\n    default:\n      throw new Error(`Unknown proxyType: ${proxyType}`);\n  }\n};\n\nfunction useSetProxy(proxyType) {\n  const { contracts } = useNetwork();\n  const { pointCursor } = usePointCursor();\n  const { syncDetails } = usePointCache();\n\n  const _contracts = need.contracts(contracts);\n  const _point = need.point(pointCursor);\n\n  const { construct, ...rest } = useEthereumTransaction(\n    useCallback(\n      address => {\n        const txArgs = [_contracts, _point, address];\n\n        switch (proxyType) {\n          case PROXY_TYPE.MANAGEMENT:\n            return azimuth.ecliptic.setManagementProxy(...txArgs);\n          case PROXY_TYPE.SPAWN:\n            return azimuth.ecliptic.setSpawnProxy(...txArgs);\n          case PROXY_TYPE.TRANSFER:\n            return azimuth.ecliptic.setTransferProxy(...txArgs);\n          case PROXY_TYPE.VOTING:\n            return azimuth.ecliptic.setVotingProxy(...txArgs);\n          default:\n            throw new Error(`Unknown proxyType ${proxyType}`);\n        }\n      },\n      [_contracts, _point, proxyType]\n    ),\n    useCallback(() => syncDetails(_point), [_point, syncDetails]),\n    GAS_LIMITS.SET_PROXY\n  );\n\n  // force-unset\n  const unset = useCallback(() => {\n    construct(ETH_ZERO_ADDR);\n  }, [construct]);\n\n  return {\n    construct,\n    unset,\n    ...rest,\n  };\n}\n\nexport default function SetProxy() {\n  const { data, pop } = useLocalRouter();\n  const { getDetails } = usePointCache();\n  const { pointCursor } = usePointCursor();\n  const { contracts } = useNetwork();\n\n  const _point = need.point(pointCursor);\n  const _details = need.details(getDetails(_point));\n  const _contracts = need.contracts(contracts);\n\n  const properProxyType = capitalize(proxyTypeToHuman(data.proxyType));\n\n  const {\n    construct,\n    unconstruct,\n    unset,\n    inputsLocked,\n    completed,\n    bind,\n  } = useSetProxy(data.proxyType);\n\n  const validateForm = useCallback((values, errors) => {\n    if (!values.unset && errors.address) {\n      return errors;\n    }\n  }, []);\n\n  const validate = useMemo(\n    () =>\n      composeValidator(\n        {\n          unset: buildCheckboxValidator(),\n          address: buildAddressValidator(),\n        },\n        validateForm\n      ),\n    [validateForm]\n  );\n\n  const onValues = useCallback(\n    ({ valid, values, form }) => {\n      if (valid) {\n        if (values.unset) {\n          unset();\n          form.change('address', '');\n        } else {\n          construct(values.address);\n        }\n      } else {\n        unconstruct();\n      }\n    },\n    [construct, unconstruct, unset]\n  );\n\n  const initialValues = useMemo(() => ({ unset: false }), []);\n\n  const proxyAddress = proxyFromDetails(_details, _contracts, data.proxyType);\n  const isProxySet = !isZeroAddress(proxyAddress);\n\n  const header = useMemo(() => {\n    const pfix = completed ? 'New' : 'Edit';\n    return `${pfix} ${properProxyType} Key`;\n  }, [completed, properProxyType]);\n\n  return (\n    <Grid>\n      <Grid.Item full className=\"f5 mb2\">\n        {header}\n      </Grid.Item>\n\n      {!completed && (\n        <>\n          <Grid.Item full as={Text} className=\"mb4 f5 gray4\">\n            {proxyTypeToHumanDescription(data.proxyType)}\n          </Grid.Item>\n          <Grid.Item\n            full\n            as={Text}\n            className={cn('f6', {\n              green3: completed,\n            })}>\n            Current\n          </Grid.Item>\n        </>\n      )}\n\n      <BridgeForm\n        validate={validate}\n        onValues={onValues}\n        initialValues={initialValues}>\n        {({ handleSubmit, values }) => (\n          <>\n            <Grid.Item full as={Flex} row justify=\"between\" align=\"center\">\n              <Flex.Item\n                flex\n                as={Text}\n                className={cn('mono mv3 gray4', {\n                  black: !completed && isProxySet,\n                  gray4: !completed && !isProxySet,\n                  green3: completed,\n                })}>\n                {isProxySet ? proxyAddress : 'Unset'}\n              </Flex.Item>\n            </Grid.Item>\n\n            {completed ? (\n              <Grid.Item full className=\"mb4\" />\n            ) : (\n              <Grid.Item\n                full\n                as={AddressInput}\n                className=\"mv4\"\n                name=\"address\"\n                label={`New ${properProxyType} Address`}\n                disabled={inputsLocked || values.unset}\n              />\n            )}\n\n            <Grid.Item full as={FormError} />\n\n            <Grid.Item\n              full\n              as={InlineEthereumTransaction}\n              {...bind}\n              onReturn={() => pop()}\n            />\n          </>\n        )}\n      </BridgeForm>\n    </Grid>\n  );\n}\n","import React, { useCallback, useMemo } from 'react';\nimport cn from 'classnames';\nimport { Grid, Text } from 'indigo-react';\nimport * as azimuth from 'azimuth-js';\n\nimport { useNetwork } from 'store/network';\nimport { usePointCursor } from 'store/pointCursor';\nimport { usePointCache } from 'store/pointCache';\nimport { useStarReleaseCache } from 'store/starRelease';\n\nimport * as need from 'lib/need';\nimport { useLocalRouter } from 'lib/LocalRouter';\nimport useCurrentPointName from 'lib/useCurrentPointName';\nimport useEthereumTransaction from 'lib/useEthereumTransaction';\nimport { GAS_LIMITS } from 'lib/constants';\n\nimport ViewHeader from 'components/ViewHeader';\nimport NoticeBox from 'components/NoticeBox';\nimport InlineEthereumTransaction from 'components/InlineEthereumTransaction';\nimport { AddressInput } from 'form/Inputs';\nimport { composeValidator, buildAddressValidator } from 'form/validators';\nimport BridgeForm from 'form/BridgeForm';\nimport FormError from 'form/FormError';\n\nfunction useTransfer() {\n  const { contracts } = useNetwork();\n  const { pointCursor } = usePointCursor();\n  const { syncDetails } = usePointCache();\n\n  const _contracts = need.contracts(contracts);\n  const _point = need.point(pointCursor);\n\n  return useEthereumTransaction(\n    useCallback(\n      address => azimuth.ecliptic.setTransferProxy(_contracts, _point, address),\n      [_contracts, _point]\n    ),\n    useCallback(() => syncDetails(_point), [_point, syncDetails]),\n    GAS_LIMITS.SET_PROXY\n  );\n}\n\nexport default function AdminTransfer() {\n  const { pop } = useLocalRouter();\n  const name = useCurrentPointName();\n  const { pointCursor } = usePointCursor();\n  const { starReleaseDetails } = useStarReleaseCache();\n\n  const {\n    construct,\n    unconstruct,\n    completed,\n    inputsLocked,\n    bind,\n  } = useTransfer();\n\n  const needLockupWarning = useMemo(() => {\n    const point = need.point(pointCursor);\n    const az = azimuth.azimuth;\n    return (\n      az.getPointSize(point) === az.PointSize.Galaxy &&\n      starReleaseDetails.map(a => a.kind).getOrElse('none') !== 'none'\n    );\n  }, [pointCursor, starReleaseDetails]);\n\n  const validate = useMemo(\n    () => composeValidator({ address: buildAddressValidator() }),\n    []\n  );\n\n  const onValues = useCallback(\n    ({ valid, values }) => {\n      if (valid) {\n        construct(values.address);\n      } else {\n        unconstruct();\n      }\n    },\n    [construct, unconstruct]\n  );\n\n  return (\n    <Grid gap={1}>\n      <Grid.Item full as={ViewHeader}>\n        Transfer Point\n      </Grid.Item>\n\n      <BridgeForm validate={validate} onValues={onValues}>\n        {({ handleSubmit, values }) => (\n          <>\n            {!completed && (\n              <Grid.Item full as={Text} className={cn('f5 wrap')}>\n                Transfer {name} to a new owner.\n              </Grid.Item>\n            )}\n            {!completed && needLockupWarning && (\n              <Grid.Item full as={NoticeBox}>\n                You have stars in lockup. These will not transfer with the{' '}\n                galaxy. If you wish, you must transfer the lockup separately.\n              </Grid.Item>\n            )}\n            {completed && (\n              <>\n                <Grid.Item full as={Text} className=\"wrap\">\n                  Started transferring <span className=\"mono\">{name}</span> to{' '}\n                </Grid.Item>\n                <Grid.Item full as={Text}>\n                  <span className=\"mono gray4\">{values.address}</span>\n                </Grid.Item>\n                <Grid.Item full as={Text} className=\"mt6\">\n                  Until they accept the transfer, you still own{' '}\n                  <span className=\"mono\">{name}</span>\n                </Grid.Item>\n              </>\n            )}\n\n            {!completed && (\n              <Grid.Item\n                full\n                as={AddressInput}\n                className=\"mv4\"\n                name=\"address\"\n                label=\"Ethereum Address\"\n                disabled={inputsLocked}\n              />\n            )}\n\n            <Grid.Item full as={FormError} />\n\n            <Grid.Item\n              full\n              as={InlineEthereumTransaction}\n              {...bind}\n              onReturn={() => pop()}\n            />\n          </>\n        )}\n      </BridgeForm>\n    </Grid>\n  );\n}\n","import React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport cn from 'classnames';\nimport { Grid, H4, HelpText } from 'indigo-react';\nimport { Just, Nothing } from 'folktale/maybe';\nimport * as ob from 'urbit-ob';\n\nimport View from 'components/View';\nimport Tabs from 'components/Tabs';\nimport Crumbs from 'components/Crumbs';\nimport Sigil from 'components/Sigil';\nimport Blinky from 'components/Blinky';\nimport NavHeader from 'components/NavHeader';\n\nimport { useLocalRouter } from 'lib/LocalRouter';\nimport useCurrentPointName from 'lib/useCurrentPointName';\nimport * as need from 'lib/need';\n\nimport { usePointCursor } from 'store/pointCursor';\nimport { usePointCache } from 'store/pointCache';\nimport Footer from 'components/Footer';\n\nconst NAMES = {\n  REQUESTS: 'REQUESTS',\n  ALL: 'ALL',\n};\n\nconst OPTIONS = [\n  { text: 'Requests', value: NAMES.REQUESTS },\n  { text: 'All', value: NAMES.ALL },\n];\n\nconst VIEWS = {\n  [NAMES.REQUESTS]: Tab,\n  [NAMES.ALL]: Tab,\n};\n\nconst PAGE_SIZE = 10;\n\nfunction Tab({ className, points, onAccept, onDecline, page, setPage }) {\n  const start = page * PAGE_SIZE;\n  const end = page * PAGE_SIZE + PAGE_SIZE;\n  const pointsCount = points.map(ps => ps.length).getOrElse(0);\n  const maxPage = Math.ceil(pointsCount / PAGE_SIZE) - 1;\n  const hasNext = page < maxPage;\n  const hasPrev = page > 0;\n  const _points = points.map(ps => ps.slice(start, end)).getOrElse([]);\n\n  const onNext = useCallback(() => {\n    setPage(p => p + 1);\n  }, [setPage]);\n\n  const onPrev = useCallback(() => {\n    setPage(p => p - 1);\n  }, [setPage]);\n\n  if (Nothing.hasInstance(points)) {\n    return <Grid className={className}></Grid>;\n  }\n\n  return (\n    <Grid className={cn('mt2', className)}>\n      {_points.length === 0 && (\n        <Grid.Item full as={HelpText} className=\"mt8 t-center\">\n          {Just.hasInstance(points) ? (\n            'No points to display'\n          ) : (\n            <>\n              <Blinky /> Loading...\n            </>\n          )}\n        </Grid.Item>\n      )}\n\n      {_points.map(point => (\n        <Resident\n          key={point}\n          point={point}\n          onAccept={onAccept}\n          onDecline={onDecline}\n        />\n      ))}\n      <Grid.Item as={Footer}>\n        <Grid className=\"pb9\">\n          {hasPrev && (\n            <Grid.Item\n              className=\"pointer underline mt4\"\n              fourth={1}\n              onClick={onPrev}>\n              {'<-'}\n            </Grid.Item>\n          )}\n          {maxPage > 0 && (\n            <Grid.Item className=\"mt4 t-center gray3\" cols={[4, 10]}>\n              <span className=\"black\">Page {page + 1}</span> of {maxPage + 1}\n            </Grid.Item>\n          )}\n          {hasNext && (\n            <Grid.Item\n              className=\"pointer underline t-right mt4\"\n              fourth={4}\n              onClick={onNext}>\n              {'->'}\n            </Grid.Item>\n          )}\n        </Grid>\n      </Grid.Item>\n    </Grid>\n  );\n}\n\nfunction Resident({ point, onAccept, onDecline }) {\n  const patp = ob.patp(point);\n  const sigilSize = 50;\n\n  const isRequest = onAccept && onDecline;\n\n  return (\n    <>\n      <Grid.Item className=\"flex-row justify-center align-center\" cols={[1, 3]}>\n        <div\n          style={{\n            display: 'inline-block',\n            height: `${sigilSize}px`,\n            width: `${sigilSize}px`,\n          }}>\n          <Sigil patp={patp} size={25} colors={['#FFFFFF', '#000000']} />\n        </div>\n      </Grid.Item>\n      <Grid.Item className=\"flex-row align-center mono\" cols={[3, 7]}>\n        {patp}{' '}\n      </Grid.Item>\n      {isRequest && (\n        <>\n          <Grid.Item\n            className=\"flex-row-r align-center underline green3 pointer\"\n            cols={[7, 10]}\n            onClick={() => onAccept(point)}>\n            Accept\n          </Grid.Item>\n          <Grid.Item\n            className=\"flex-row-r align-center underline red4 pointer\"\n            cols={[10, 13]}\n            onClick={() => onDecline(point)}>\n            Decline\n          </Grid.Item>\n        </>\n      )}\n      <Grid.Divider />\n    </>\n  );\n}\n\nexport default function Residents() {\n  const { pop, push, names } = useLocalRouter();\n  const name = useCurrentPointName();\n\n  const { pointCursor } = usePointCursor();\n  const point = need.point(pointCursor);\n  const { getResidents, syncResidents } = usePointCache();\n\n  const goBack = useCallback(() => pop(), [pop]);\n  useEffect(() => {\n    syncResidents(point);\n  }, [syncResidents, point]);\n\n  const { residents, requests } = getResidents(point);\n\n  const [currentTab, _setCurrentTab] = useState(NAMES.ALL);\n  const [page, setPage] = useState(0);\n\n  const setCurrentTab = useCallback(\n    tab => {\n      setPage(0);\n      _setCurrentTab(tab);\n    },\n    [setPage, _setCurrentTab]\n  );\n\n  const isRequests = useMemo(() => currentTab === NAMES.REQUESTS, [currentTab]);\n\n  const _onAccept = useCallback(\n    adoptee =>\n      push(names.ADOPT, {\n        adoptee,\n        denied: false,\n      }),\n    [push, names]\n  );\n  const onAccept = isRequests && _onAccept;\n\n  const _onDecline = useCallback(\n    adoptee =>\n      push(names.ADOPT, {\n        adoptee,\n        denied: true,\n      }),\n    [push, names]\n  );\n  const onDecline = isRequests && _onDecline;\n\n  const points = isRequests ? requests : residents;\n\n  return (\n    <View pop={pop} inset>\n      <NavHeader>\n        <Crumbs\n          routes={[{ text: name, action: goBack }, { text: 'Residents' }]}\n        />\n      </NavHeader>\n      <Grid>\n        <Grid.Item full as={H4} className=\"mt4\">\n          Residents\n        </Grid.Item>\n        <Grid.Item\n          full\n          className=\"mt1\"\n          as={Tabs}\n          //  Tabs\n          views={VIEWS}\n          options={OPTIONS}\n          currentTab={currentTab}\n          onTabChange={setCurrentTab}\n          //  Props for tab\n          points={points}\n          onAccept={onAccept}\n          onDecline={onDecline}\n          page={page}\n          setPage={setPage}\n        />\n      </Grid>\n    </View>\n  );\n}\n","import React from 'react';\nimport cn from 'classnames';\n\nimport CopiableWithTooltip from './CopiableWithTooltip';\n\nexport default function CopiableAddressWrap({ className, ...rest }) {\n  return (\n    <CopiableWithTooltip className={cn(className, 'mono', 'wrap')} {...rest} />\n  );\n}\n","import React, { useState } from 'react';\nimport { Grid, Text } from 'indigo-react';\n\nimport { useLocalRouter } from 'lib/LocalRouter';\nimport { COMMANDS, useFlowCommand } from 'lib/flowCommand';\n\nimport View from 'components/View';\nimport Highlighted from 'components/Highlighted';\nimport CopiableAddressWrap from 'components/CopiableAddressWrap';\nimport ViewHeader from 'components/ViewHeader';\nimport SubmitButton from 'form/SubmitButton';\n\nimport { useWallet } from 'store/wallet';\n\nimport * as need from 'lib/need';\nimport * as bitcoin from 'bitcoinjs-lib';\n\nimport BridgeForm from 'form/BridgeForm';\nimport { PsbtInput } from 'form/Inputs';\n\nimport { composeValidator, buildPsbtValidator } from 'form/validators';\n\nconst BITCOIN_MAINNET_INFO = {\n  messagePrefix: '\\x18Bitcoin Signed Message:\\n',\n  bech32: 'bc',\n  bip32: {\n    public: 0x04b24746,\n    private: 0x04b2430c,\n  },\n  pubKeyHash: 0x00,\n  scriptHash: 0x05,\n  wif: 0x80,\n};\n\nconst BITCOIN_TESTNET_INFO = {\n  messagePrefix: '\\x18Bitcoin Signed Message:\\n',\n  bech32: 'tb',\n  bip32: {\n    public: 0x045f1cf6,\n    private: 0x045f18bc,\n  },\n  pubKeyHash: 0x6f,\n  scriptHash: 0xc4,\n  wif: 0xef,\n};\n\nexport default function SignTransaction() {\n  const { pop } = useLocalRouter();\n  const { urbitWallet } = useWallet();\n  const flow = useFlowCommand();\n\n  const [signedTx, setSignedTx] = useState('');\n  const [psbt, setPsbt] = useState({});\n\n  const { xprv: zprv } = need.urbitWallet(urbitWallet).bitcoinMainnet.keys;\n  const { xprv: vprv } = need.urbitWallet(urbitWallet).bitcoinTestnet.keys;\n\n  const validate = composeValidator({\n    unsignedTransaction: buildPsbtValidator(),\n  });\n\n  const onSubmit = values => {\n    const newPsbt = bitcoin.Psbt.fromBase64(values.unsignedTransaction);\n\n    const isTestnet = newPsbt.data.inputs[0].bip32Derivation[0].path.startsWith(\n      \"m/84'/1'/0'/\"\n    );\n\n    const derivationPrefix = isTestnet ? \"m/84'/1'/0'/\" : \"m/84'/0'/0'/\";\n\n    const btcWallet = isTestnet\n      ? bitcoin.bip32.fromBase58(vprv, BITCOIN_TESTNET_INFO)\n      : bitcoin.bip32.fromBase58(zprv, BITCOIN_MAINNET_INFO);\n\n    try {\n      const hex = newPsbt.data.inputs\n        .reduce((psbt, input, idx) => {\n          //  removing already derived part, eg m/84'/0'/0'/0/0 becomes 0/0\n          const path = input.bip32Derivation[0].path\n            .split(derivationPrefix)\n            .join('');\n          const prv = btcWallet.derivePath(path).privateKey;\n          return psbt.signInput(idx, bitcoin.ECPair.fromPrivateKey(prv));\n        }, newPsbt)\n        .finalizeAllInputs()\n        .extractTransaction()\n        .toHex();\n      setPsbt(newPsbt);\n      setSignedTx(hex);\n    } catch (error) {\n      return {\n        unsignedTransaction: 'Cannot sign transaction, mismatching keys.',\n      };\n    }\n  };\n\n  const initialValues = {};\n  if (flow && COMMANDS.BITCOIN === flow.kind) {\n    initialValues.unsignedTransaction = flow.utx;\n  }\n\n  return (\n    <View pop={pop} inset>\n      <Grid className=\"mt4\">\n        <Grid.Item full className=\"mt4\" as={Text}>\n          Paste unsigned transactions from Landscape here\n        </Grid.Item>\n        <BridgeForm\n          validate={validate}\n          initialValues={initialValues}\n          onSubmit={onSubmit}>\n          {({ handleSubmit }) => (\n            <>\n              <Grid.Item\n                full\n                as={PsbtInput}\n                name=\"unsignedTransaction\"\n                label=\"Unsigned transaction\"\n                className=\"mt4\"\n              />\n              <Grid.Item\n                full\n                solid\n                className=\"mt2\"\n                accessory=\"\"\n                handleSubmit={handleSubmit}\n                as={SubmitButton}>\n                Sign Transaction\n              </Grid.Item>\n            </>\n          )}\n        </BridgeForm>\n        {signedTx && (\n          <Grid.Item full className=\"mt4\" as={Text}>\n            Transaction outputs:\n          </Grid.Item>\n        )}\n        {signedTx &&\n          psbt.txOutputs.map(e => (\n            <Grid.Item full className=\"mt4\" key={e.address}>\n              <span>{e.address}</span>\n              <div className=\"mt1 mono black f6\">{e.value} sats</div>\n            </Grid.Item>\n          ))}\n        {signedTx && (\n          <>\n            <Grid.Item full className=\"mt4\" as={ViewHeader}>\n              Signed transaction:\n            </Grid.Item>\n            <Grid.Item full as={Text}>\n              <Highlighted>\n                <CopiableAddressWrap>{signedTx}</CopiableAddressWrap>\n              </Highlighted>\n            </Grid.Item>\n          </>\n        )}\n      </Grid>\n    </View>\n  );\n}\n","import Disclaimer from 'views/Disclaimer';\nimport Login from 'views/Login';\nimport Other from 'views/Login/Other.js';\nimport Senate from 'views/Senate';\nimport Documents from 'views/Senate/Documents';\nimport Upgrades from 'views/Senate/Upgrades';\nimport CreateGalaxy from 'views/CreateGalaxy';\nimport IssueChild from 'views/IssueChild';\nimport StarRelease from 'views/Release';\nimport AcceptLockup from 'views/AcceptLockup';\n\nimport Point from 'views/Point';\nimport Points from 'views/Points';\nimport Activate from 'views/Activate';\n\nimport PartySetPoolSize from 'views/Party/PartySetPoolSize';\nimport InviteCohort from 'views/Invite/Cohort';\nimport AcceptTransfer from 'views/AcceptTransfer';\nimport CancelTransfer from 'views/CancelTransfer';\nimport UrbitOS from 'views/UrbitOS';\nimport UrbitID from 'views/UrbitID';\nimport Residents from 'views/Residents';\nimport Adopt from 'views/Adopt';\nimport Bitcoin from 'views/Bitcoin/Bitcoin';\nimport Xpub from 'views/Bitcoin/Xpub';\nimport SignTransaction from 'views/Bitcoin/SignTransaction';\n\nimport { ROUTE_NAMES } from './routeNames';\n\nexport const ROUTES = {\n  [ROUTE_NAMES.DISCLAIMER]: Disclaimer,\n  [ROUTE_NAMES.ACTIVATE]: Activate,\n  [ROUTE_NAMES.LOGIN]: Login,\n  [ROUTE_NAMES.LOGIN_OTHER]: Other,\n  [ROUTE_NAMES.POINTS]: Points,\n  [ROUTE_NAMES.POINT]: Point,\n  [ROUTE_NAMES.CREATE_GALAXY]: CreateGalaxy,\n  [ROUTE_NAMES.ISSUE_CHILD]: IssueChild,\n  [ROUTE_NAMES.SENATE]: Senate,\n  [ROUTE_NAMES.DOCUMENTS]: Documents,\n  [ROUTE_NAMES.UPGRADES]: Upgrades,\n  // TODO: nest this route under the Party.js router\n  [ROUTE_NAMES.PARTY_SET_POOL_SIZE]: PartySetPoolSize,\n  [ROUTE_NAMES.ACCEPT_TRANSFER]: AcceptTransfer,\n  // TODO: replace this with deep link to AdminCancelTransfer\n  [ROUTE_NAMES.CANCEL_TRANSFER]: CancelTransfer,\n  [ROUTE_NAMES.INVITE_COHORT]: InviteCohort,\n  [ROUTE_NAMES.STAR_RELEASE]: StarRelease,\n  [ROUTE_NAMES.ACCEPT_LOCKUP]: AcceptLockup,\n  [ROUTE_NAMES.URBIT_OS]: UrbitOS,\n  [ROUTE_NAMES.URBIT_ID]: UrbitID,\n  [ROUTE_NAMES.RESIDENTS]: Residents,\n  [ROUTE_NAMES.ADOPT]: Adopt,\n  [ROUTE_NAMES.BITCOIN]: Bitcoin,\n  [ROUTE_NAMES.BITCOIN_XPUB]: Xpub,\n  [ROUTE_NAMES.BITCOIN_SIGN_TRANSACTION]: SignTransaction,\n};\n","import { useCallback, useState } from 'react';\nimport { Nothing } from 'folktale/maybe';\n\nexport default function useActivateFlowState() {\n  const [derivedWallet, setDerivedWallet] = useState(Nothing());\n  const [inviteWallet, setInviteWallet] = useState(Nothing());\n  const [derivedPoint, setDerivedPoint] = useState(Nothing());\n  const [generated, setGenerated] = useState(false);\n\n  const reset = useCallback(() => {\n    setDerivedWallet(Nothing());\n    setInviteWallet(Nothing());\n    setDerivedPoint(Nothing());\n    setGenerated(false);\n  }, [setDerivedWallet, setInviteWallet, setDerivedPoint, setGenerated]);\n\n  return {\n    derivedWallet,\n    setDerivedWallet,\n    inviteWallet,\n    setInviteWallet,\n    derivedPoint,\n    setDerivedPoint,\n    generated,\n    setGenerated,\n    reset,\n  };\n}\n","import React, { useCallback, useState } from 'react';\nimport { Grid, Text, Button, Flex, LinkButton } from 'indigo-react';\n\nimport { versionLabel } from 'lib/flags';\n\nimport { useHistory } from 'store/history';\n\nimport { COMMANDS, useFlowCommand } from 'lib/flowCommand';\n\nimport View from 'components/View';\nimport Footer from 'components/Footer';\n\nimport Ticket from './Login/Ticket';\nimport Other from './Login/Other';\n\nexport default function Login() {\n  // globals\n  const { push, names } = useHistory();\n  const flow = useFlowCommand();\n\n  // inputs\n  const [isOther, setisOther] = useState(false);\n\n  const goToActivate = useCallback(() => push(names.ACTIVATE), [\n    push,\n    names.ACTIVATE,\n  ]);\n\n  const goHome = useCallback(() => {\n    if (!flow) {\n      push(names.POINTS);\n    } else {\n      switch (flow.kind) {\n        case COMMANDS.TAKE_LOCKUP:\n          push(names.ACCEPT_LOCKUP);\n          break;\n        //\n        case COMMANDS.BITCOIN:\n          push(names.BITCOIN_SIGN_TRANSACTION);\n          break;\n        //\n        case COMMANDS.XPUB:\n          push(names.BITCOIN_XPUB);\n          break;\n        //\n        default:\n          throw new Error('unimplemented flow ' + flow.kind);\n      }\n    }\n  }, [flow, push, names]);\n\n  const flowDescription = command => {\n    switch (command.kind) {\n      case COMMANDS.TAKE_LOCKUP:\n        //TODO  kind of want \"sign in as 0xabc..\" here...\n        return <>To accept a star lockup batch, please sign in.</>;\n      //\n      case COMMANDS.BITCOIN:\n        return <>To sign a Bitcoin transaction, please sign in.</>;\n      //\n      case COMMANDS.XPUB:\n        return <>To view your Bitcoin extended public key, please sign in.</>;\n      //\n      default:\n        return <>Flow: {command.kind}</>;\n    }\n  };\n\n  return (\n    <View inset>\n      <Grid>\n        <Grid.Item full as={Text} className=\"flex justify-center mt9 mb7\">\n          <Grid.Item as={Text} className=\"gray3\">\n            Urbit ID /&nbsp;\n          </Grid.Item>\n          <Grid.Item as={Text}>Login</Grid.Item>\n        </Grid.Item>\n        {flow && (\n          <Grid.Item full as={Text} className=\"t-center mb4\">\n            {flowDescription(flow)}\n          </Grid.Item>\n        )}\n        <Grid.Item full as={isOther ? Other : Ticket} goHome={goHome} />\n        {!isOther && (\n          <>\n            <Grid.Item full className=\"t-center mv4 gray4\">\n              or\n            </Grid.Item>\n            <Grid.Item\n              full\n              as={Button}\n              className=\"b-solid b1 b-black\"\n              center\n              onClick={() => setisOther(true)}>\n              Metamask, Mnemonic, Hardware Wallet...\n            </Grid.Item>\n            {!flow && (\n              <Grid.Item\n                full\n                onClick={goToActivate}\n                className=\"mv10 t-center f6\">\n                <span className=\"gray4\">New Urbit ID? </span>\n                <LinkButton>Activate</LinkButton>\n              </Grid.Item>\n            )}\n          </>\n        )}\n        {isOther && (\n          <Grid.Item\n            as={LinkButton}\n            onClick={() => setisOther(false)}\n            full\n            className=\"t-center underline f6 mt8\">\n            Back\n          </Grid.Item>\n        )}\n      </Grid>\n\n      <Footer>\n        <Flex className=\"mb8 f6\" justify=\"between\">\n          <Flex.Item\n            as=\"a\"\n            href=\"https://github.com/urbit/bridge/releases\"\n            className=\"us-none pointer\">\n            <span className=\"underline\">Offline</span> ↗\n          </Flex.Item>\n          <Flex.Item className=\"gray4\">v{versionLabel}</Flex.Item>\n        </Flex>\n      </Footer>\n    </View>\n  );\n}\n","import { useWallet } from 'store/wallet';\nimport { usePointCache } from 'store/pointCache';\n\nimport { eqAddr } from 'lib/utils/address';\nimport useLifecycle from './useLifecycle';\n\nexport default function useIsEclipticOwner() {\n  const { wallet } = useWallet();\n  const { eclipticOwner, syncEclipticOwner } = usePointCache();\n\n  useLifecycle(() => {\n    syncEclipticOwner();\n  });\n\n  return wallet.matchWith({\n    Nothing: () => false,\n    Just: p => {\n      if (!eclipticOwner) {\n        return false;\n      }\n\n      return eqAddr(p.value.address, eclipticOwner);\n    },\n  });\n}\n","import { useCallback } from 'react';\n\nimport useLocalStorageState from './useLocalStorageState';\n\nconst REJECTED_POINTS_KEY = 'bridge:rejected-points';\n\nexport default function useRejectedIncomingPointTransfers() {\n  const [rejectedPoints, setRejectedPoints] = useLocalStorageState(\n    REJECTED_POINTS_KEY,\n    []\n  );\n\n  const addRejectedPoint = useCallback(\n    point => setRejectedPoints([...rejectedPoints, point]),\n    [rejectedPoints, setRejectedPoints]\n  );\n\n  return [rejectedPoints, addRejectedPoint];\n}\n","import React, { useCallback, useMemo, useState } from 'react';\nimport cn from 'classnames';\nimport { Grid, Text } from 'indigo-react';\nimport * as azimuth from 'azimuth-js';\n\nimport { useNetwork } from 'store/network';\nimport { usePointCache } from 'store/pointCache';\n\nimport * as need from 'lib/need';\nimport useEthereumTransaction from 'lib/useEthereumTransaction';\nimport { GAS_LIMITS } from 'lib/constants';\nimport { patp2dec } from 'lib/patp2dec';\nimport { isZeroAddress } from 'lib/utils/address';\nimport { useLocalRouter } from 'lib/LocalRouter';\n\nimport ViewHeader from 'components/ViewHeader';\nimport InlineEthereumTransaction from 'components/InlineEthereumTransaction';\nimport View from 'components/View';\nimport BridgeForm from 'form/BridgeForm';\nimport { PointInput, AddressInput } from 'form/Inputs';\nimport {\n  composeValidator,\n  buildPointValidator,\n  buildAddressValidator,\n  hasErrors,\n} from 'form/validators';\nimport FormError from 'form/FormError';\nimport CopiableAddress from 'components/CopiableAddress';\n\nfunction useCreateGalaxy() {\n  const { contracts } = useNetwork();\n  const { syncDates } = usePointCache();\n\n  const _contracts = need.contracts(contracts);\n\n  const [galaxy, setGalaxy] = useState();\n\n  return useEthereumTransaction(\n    useCallback(\n      (galaxy, owner) => {\n        setGalaxy(galaxy);\n        return azimuth.ecliptic.createGalaxy(_contracts, galaxy, owner);\n      },\n      [_contracts]\n    ),\n    useCallback(() => syncDates(galaxy), [galaxy, syncDates]),\n    GAS_LIMITS.DEFAULT\n  );\n}\n\nexport default function CreateGalaxy() {\n  const { pop } = useLocalRouter();\n  const { contracts } = useNetwork();\n  const _contracts = need.contracts(contracts);\n\n  const {\n    construct,\n    unconstruct,\n    completed,\n    inputsLocked,\n    bind,\n  } = useCreateGalaxy();\n\n  const validateFormAsync = useCallback(\n    async values => {\n      const currentOwner = await azimuth.azimuth.getOwner(\n        _contracts,\n        patp2dec(values.galaxyName)\n      );\n\n      const isAvailable = isZeroAddress(currentOwner);\n      if (!isAvailable) {\n        return { galaxyName: 'This galaxy is already spawned and owned.' };\n      }\n    },\n    [_contracts]\n  );\n\n  const validateForm = useCallback(\n    (values, errors) => {\n      if (hasErrors(errors)) {\n        return errors;\n      }\n\n      return validateFormAsync(values, errors);\n    },\n    [validateFormAsync]\n  );\n\n  const validate = useMemo(\n    () =>\n      composeValidator(\n        {\n          galaxyName: buildPointValidator(1),\n          owner: buildAddressValidator(),\n        },\n        validateForm\n      ),\n    [validateForm]\n  );\n\n  const onValues = useCallback(\n    ({ valid, values }) => {\n      if (valid) {\n        construct(patp2dec(values.galaxyName), values.owner);\n      } else {\n        unconstruct();\n      }\n    },\n    [construct, unconstruct]\n  );\n\n  return (\n    <View pop={pop} inset>\n      <Grid>\n        <Grid.Item full as={ViewHeader}>\n          Create a Galaxy\n        </Grid.Item>\n\n        <BridgeForm validate={validate} onValues={onValues}>\n          {({ handleSubmit, values }) => (\n            <>\n              {completed && (\n                <Grid.Item\n                  full\n                  as={Text}\n                  className={cn('f5 wrap', {\n                    green3: completed,\n                  })}>\n                  {values.galaxyName} has been created and can be claimed by{' '}\n                  <CopiableAddress>{values.owner}</CopiableAddress>.\n                </Grid.Item>\n              )}\n\n              <Grid.Item\n                full\n                as={PointInput}\n                className=\"mt4\"\n                name=\"galaxyName\"\n                label=\"Galaxy Name\"\n                disabled={inputsLocked}\n              />\n              <Grid.Item\n                full\n                as={AddressInput}\n                className=\"mb4\"\n                name=\"owner\"\n                label=\"Ethereum Address\"\n                disabled={inputsLocked}\n              />\n\n              <Grid.Item full as={FormError} />\n\n              <Grid.Item\n                full\n                as={InlineEthereumTransaction}\n                {...bind}\n                onReturn={() => pop()}\n              />\n            </>\n          )}\n        </BridgeForm>\n      </Grid>\n    </View>\n  );\n}\n","import React, { useCallback, useMemo, useState } from 'react';\nimport cn from 'classnames';\nimport { Grid, Text } from 'indigo-react';\nimport * as azimuth from 'azimuth-js';\nimport ob from 'urbit-ob';\n\nimport { useNetwork } from 'store/network';\nimport { usePointCache } from 'store/pointCache';\nimport { usePointCursor } from 'store/pointCursor';\n\nimport * as need from 'lib/need';\nimport useEthereumTransaction from 'lib/useEthereumTransaction';\nimport { GAS_LIMITS } from 'lib/constants';\nimport { patp2dec } from 'lib/patp2dec';\nimport { getSpawnCandidate } from 'lib/child';\nimport { useLocalRouter } from 'lib/LocalRouter';\nimport useConstant from 'lib/useConstant';\nimport { validateChild } from 'lib/validators';\n\nimport ViewHeader from 'components/ViewHeader';\nimport InlineEthereumTransaction from 'components/InlineEthereumTransaction';\nimport View from 'components/View';\nimport { PointInput, AddressInput } from 'form/Inputs';\nimport {\n  composeValidator,\n  buildPointValidator,\n  buildAddressValidator,\n  hasErrors,\n} from 'form/validators';\nimport BridgeForm from 'form/BridgeForm';\nimport FormError from 'form/FormError';\nimport CopiableAddress from 'components/CopiableAddress';\nimport { convertToInt } from 'lib/convertToInt';\n\nfunction useIssueChild() {\n  const { contracts } = useNetwork();\n  const { syncDates } = usePointCache();\n\n  const _contracts = need.contracts(contracts);\n\n  const [spawnedPoint, setSpawnedPoint] = useState();\n\n  return useEthereumTransaction(\n    useCallback(\n      (spawnedPoint, owner) => {\n        setSpawnedPoint(spawnedPoint);\n        return azimuth.ecliptic.spawn(_contracts, spawnedPoint, owner);\n      },\n      [_contracts]\n    ),\n    useCallback(() => syncDates(spawnedPoint), [spawnedPoint, syncDates]),\n    GAS_LIMITS.DEFAULT\n  );\n}\n\nexport default function IssueChild() {\n  const { pop } = useLocalRouter();\n  const { contracts } = useNetwork();\n  const { pointCursor } = usePointCursor();\n\n  const _contracts = need.contracts(contracts);\n  const _point = convertToInt(need.point(pointCursor), 10);\n\n  const availablePointsPromise = useConstant(() =>\n    azimuth.azimuth\n      .getUnspawnedChildren(_contracts, _point)\n      .then(points => new Set(points))\n  );\n\n  const candidates = useMemo(() => {\n    const getCandidate = () => ob.patp(getSpawnCandidate(_point));\n\n    return [getCandidate(), getCandidate(), getCandidate(), getCandidate()];\n  }, [_point]);\n\n  const {\n    isDefaultState,\n    construct,\n    unconstruct,\n    completed,\n    inputsLocked,\n    bind,\n  } = useIssueChild();\n\n  const validateFormAsync = useCallback(\n    async values => {\n      const point = patp2dec(values.point);\n      const hasPoint = (await availablePointsPromise).has(point);\n\n      if (!hasPoint) {\n        return { point: 'This point cannot be spawned.' };\n      }\n    },\n    [availablePointsPromise]\n  );\n\n  const validateForm = useCallback(\n    (values, errors) => {\n      if (hasErrors(errors)) {\n        return errors;\n      }\n\n      return validateFormAsync(values, errors);\n    },\n    [validateFormAsync]\n  );\n\n  const validate = useMemo(\n    () =>\n      composeValidator(\n        {\n          point: buildPointValidator(4, [validateChild(ob.patp(_point))]),\n          owner: buildAddressValidator(),\n        },\n        validateForm\n      ),\n    [_point, validateForm]\n  );\n\n  const onValues = useCallback(\n    ({ valid, values }) => {\n      if (valid) {\n        construct(patp2dec(values.point), values.owner);\n      } else {\n        unconstruct();\n      }\n    },\n    [construct, unconstruct]\n  );\n\n  return (\n    <View pop={pop} inset>\n      <Grid>\n        <Grid.Item full as={ViewHeader}>\n          Issue Child Point\n        </Grid.Item>\n\n        {isDefaultState && (\n          <Grid.Item full as={Text}>\n            Perhaps one of {candidates.slice(0, 3).join(', ')}, or{' '}\n            {candidates[candidates.length - 1]}?\n          </Grid.Item>\n        )}\n\n        <BridgeForm validate={validate} onValues={onValues}>\n          {({ handleSubmit, values }) => (\n            <>\n              {completed && (\n                <Grid.Item\n                  full\n                  as={Text}\n                  className={cn('f5 wrap', {\n                    green3: completed,\n                  })}>\n                  {values.point} has been spawned and can be claimed by{' '}\n                  <CopiableAddress>{values.owner}</CopiableAddress>.\n                </Grid.Item>\n              )}\n\n              {!completed && (\n                <>\n                  <Grid.Item\n                    full\n                    as={PointInput}\n                    name=\"point\"\n                    disabled={inputsLocked}\n                    className=\"mt4\"\n                  />\n                  <Grid.Item\n                    full\n                    as={AddressInput}\n                    className=\"mb4\"\n                    name=\"owner\"\n                    label=\"Ethereum Address\"\n                    disabled={inputsLocked}\n                  />\n                </>\n              )}\n\n              <Grid.Item full as={FormError} />\n\n              <Grid.Item\n                full\n                as={InlineEthereumTransaction}\n                {...bind}\n                onReturn={() => pop()}\n              />\n            </>\n          )}\n        </BridgeForm>\n      </Grid>\n    </View>\n  );\n}\n","import { useRef } from 'react';\n\n// inspired by, but simpler version of:\n// https://github.com/Andarist/use-constant/blob/master/src/index.ts\nexport default function useConstant(fn) {\n  const ref = useRef();\n\n  if (!ref.current) {\n    ref.current = fn();\n  }\n\n  return ref.current;\n}\n","import React, { useCallback } from 'react';\nimport { Grid } from 'indigo-react';\n\nimport View from 'components/View';\nimport ViewHeader from 'components/ViewHeader';\nimport { ForwardButton } from 'components/Buttons';\n\nimport { useLocalRouter } from 'lib/LocalRouter';\n\nexport default function Point() {\n  const { pop, push, names } = useLocalRouter();\n\n  //TODO  if we moved the poll fetching logic into a cache/store,\n  //      we could be cute here and display \"x ongoing\" under the buttons.\n\n  const goDocuments = useCallback(() => push(names.DOCUMENTS), [push, names]);\n\n  const goUpgrades = useCallback(() => push(names.UPGRADES), [push, names]);\n\n  return (\n    <View pop={pop} inset>\n      <Grid.Item full as={ViewHeader}>\n        Senate: Proposals\n      </Grid.Item>\n      <Grid className=\"pt2\">\n        <Grid.Item\n          full\n          as={ForwardButton}\n          className=\"mt1\"\n          onClick={goDocuments}>\n          Document Proposals\n        </Grid.Item>\n        <Grid.Divider />\n        <Grid.Item full as={ForwardButton} className=\"mt1\" onClick={goUpgrades}>\n          Upgrade Proposals\n        </Grid.Item>\n      </Grid>\n    </View>\n  );\n}\n","import React, { useCallback, useMemo, useEffect, useState } from 'react';\nimport { Grid, Text, P, LinkButton } from 'indigo-react';\nimport * as azimuth from 'azimuth-js';\n\nimport { useNetwork } from 'store/network';\nimport { usePointCursor } from 'store/pointCursor';\n\nimport * as need from 'lib/need';\nimport useEthereumTransaction from 'lib/useEthereumTransaction';\nimport { GAS_LIMITS } from 'lib/constants';\nimport { useLocalRouter } from 'lib/LocalRouter';\n\nimport ViewHeader from 'components/ViewHeader';\nimport InlineEthereumTransaction from 'components/InlineEthereumTransaction';\nimport View from 'components/View';\nimport BridgeForm from 'form/BridgeForm';\nimport { convertToInt } from 'lib/convertToInt';\n\nfunction useCastUpgradeVote() {\n  const { contracts } = useNetwork();\n  const { pointCursor } = usePointCursor();\n\n  const _contracts = need.contracts(contracts);\n  const _point = need.point(pointCursor);\n\n  return useEthereumTransaction(\n    useCallback(\n      (address, accept) => {\n        return azimuth.ecliptic.castUpgradeVote(\n          _contracts,\n          _point,\n          address,\n          accept\n        );\n      },\n      [_contracts, _point]\n    ),\n    useCallback(() => null, []), //TODO update polls[address].hasVoted ?\n    GAS_LIMITS.DEFAULT //TODO update once we have a decent sample size\n  );\n}\n\nexport default function Upgrades() {\n  const { pop } = useLocalRouter();\n  const { contracts } = useNetwork();\n  const { pointCursor } = usePointCursor();\n\n  const _contracts = need.contracts(contracts);\n  const _point = convertToInt(need.point(pointCursor), 10);\n\n  const { construct, reset, unconstruct, bind } = useCastUpgradeVote();\n\n  const [proposals, setProposals] = useState([]);\n  const [polls, setPolls] = useState({});\n  const [loading, setLoading] = useState(true);\n  const [votingOn, setVotingOn] = useState({});\n\n  //TODO update every second?\n  const now = Math.round(new Date().getTime() / 1000);\n\n  useEffect(() => {\n    (async () => {\n      let proposals = await azimuth.polls.getUpgradeProposals(_contracts);\n      let polls = {};\n      for (let address of proposals) {\n        let poll = await azimuth.polls.getUpgradePoll(_contracts, address);\n        poll.endTime = convertToInt(poll.start) + convertToInt(poll.duration);\n        poll.hasVoted = await azimuth.polls.hasVotedOnUpgradePoll(\n          _contracts,\n          _point,\n          address\n        );\n        polls[address] = poll;\n      }\n      setProposals(proposals);\n      setPolls(polls);\n      setLoading(false);\n    })();\n  }, [_contracts, _point]);\n\n  // eslint-disable-next-line\n  const [open, closed] = useMemo(() => {\n    let open = [];\n    let closed = [];\n    if (loading) return [open, closed];\n    for (let address of proposals) {\n      if (now > polls[address].endTime) {\n        closed.push(address);\n      } else {\n        open.push(address);\n      }\n    }\n    return [open, closed];\n  }, [loading, proposals, polls, now]);\n\n  const doVote = useCallback(\n    (address, accept) => {\n      construct(address, accept);\n      setVotingOn({ address, accept });\n    },\n    [construct]\n  );\n\n  const didVote = useCallback(() => {\n    reset();\n    unconstruct();\n    setPolls(polls => {\n      polls[votingOn.address].hasVoted = true;\n      return polls;\n    });\n    setVotingOn({});\n  }, [votingOn, reset, unconstruct]);\n\n  const openList = useMemo(() => {\n    return open.map(address => {\n      const hasVoted = polls[address].hasVoted;\n      return (\n        <>\n          <Grid.Item full className=\"mv2\" as={Text}>\n            <a\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              href={`https://etherscan.io/address/${address}#code`}\n              class=\"mb4 mono wrap pre\">\n              {address}↗\n            </a>\n            <P className=\"mt0\">\n              {hasVoted ? (\n                'Your vote has been cast.'\n              ) : (\n                <>\n                  <LinkButton onClick={() => doVote(address, true)}>\n                    {votingOn.address === address && votingOn.accept ? (\n                      <b>support</b>\n                    ) : (\n                      <>support</>\n                    )}\n                  </LinkButton>\n                  {' / '}\n                  <LinkButton onClick={() => doVote(address, false)}>\n                    {votingOn.address === address && !votingOn.accept ? (\n                      <b>reject</b>\n                    ) : (\n                      <>reject</>\n                    )}\n                  </LinkButton>\n                </>\n              )}\n            </P>\n          </Grid.Item>\n          <Grid.Divider />\n        </>\n      );\n    });\n  }, [open, polls, votingOn, doVote]);\n\n  return (\n    <View pop={pop} inset>\n      <Grid>\n        <Grid.Item full as={ViewHeader}>\n          Senate: Upgrade Proposals\n        </Grid.Item>\n\n        <Grid.Item full as={Grid}>\n          <Grid.Item full as={P}>\n            Current Ecliptic:\n          </Grid.Item>\n          <Grid.Item full className=\"mv2 mb4 mono wrap pre\" as={P}>\n            {_contracts.ecliptic.address}\n          </Grid.Item>\n        </Grid.Item>\n\n        {openList.length > 0 && (\n          <>\n            <Grid.Divider className=\"mv4\" />\n\n            <Grid.Item full as={Grid}>\n              <Grid.Item full as={P}>\n                Open upgrade polls:\n              </Grid.Item>\n              {openList}\n            </Grid.Item>\n\n            <BridgeForm>\n              {({ onSubmit, values }) => (\n                <Grid.Item\n                  full\n                  as={InlineEthereumTransaction}\n                  {...bind}\n                  onReturn={didVote}\n                />\n              )}\n            </BridgeForm>\n          </>\n        )}\n      </Grid>\n    </View>\n  );\n}\n","import React, { useCallback, useMemo } from 'react';\nimport cn from 'classnames';\nimport { Grid, Text } from 'indigo-react';\nimport * as azimuth from 'azimuth-js';\n\nimport { useNetwork } from 'store/network';\nimport { usePointCursor } from 'store/pointCursor';\nimport { usePointCache } from 'store/pointCache';\n\nimport * as need from 'lib/need';\nimport useEthereumTransaction from 'lib/useEthereumTransaction';\nimport { GAS_LIMITS } from 'lib/constants';\nimport { useLocalRouter } from 'lib/LocalRouter';\nimport useCurrentPermissions from 'lib/useCurrentPermissions';\nimport { patp2dec } from 'lib/patp2dec';\nimport { convertToInt } from 'lib/convertToInt';\n\nimport ViewHeader from 'components/ViewHeader';\nimport InlineEthereumTransaction from 'components/InlineEthereumTransaction';\nimport View from 'components/View';\nimport WarningBox from 'components/WarningBox';\n\nimport BridgeForm from 'form/BridgeForm';\nimport { PointInput, NumberInput } from 'form/Inputs';\nimport {\n  composeValidator,\n  buildNumberValidator,\n  buildPointValidator,\n} from 'form/validators';\nimport FormError from 'form/FormError';\nimport CopiableAddress from 'components/CopiableAddress';\n\nfunction useSetPoolSize() {\n  const { contracts } = useNetwork();\n  const { pointCursor } = usePointCursor();\n  const { syncExtras } = usePointCache();\n\n  const _contracts = need.contracts(contracts);\n  const _point = need.point(pointCursor);\n\n  return useEthereumTransaction(\n    useCallback(\n      (poolOwner, poolSize) =>\n        azimuth.delegatedSending.setPoolSize(\n          _contracts,\n          _point,\n          poolOwner,\n          poolSize\n        ),\n      [_contracts, _point]\n    ),\n    useCallback(() => syncExtras(_point), [_point, syncExtras]),\n    GAS_LIMITS.DEFAULT // TODO: GAS_LIMITS.SET_POOL_SIZE\n  );\n}\n\nexport default function PartySetPoolSize() {\n  const { pop } = useLocalRouter();\n  const { contracts } = useNetwork();\n  const { pointCursor } = usePointCursor();\n  const { getDetails } = usePointCache();\n\n  const _point = need.point(pointCursor);\n  const _details = need.details(getDetails(_point));\n  const hasKeysSet =\n    0 !== convertToInt(_details.encryptionKey, 16) &&\n    0 !== convertToInt(_details.authenticationKey, 16) &&\n    0 !== _details.cryptoSuiteVersion;\n\n  const _contracts = need.contracts(contracts);\n\n  const { spawnIsDelegatedSending } = useCurrentPermissions();\n\n  const {\n    construct,\n    unconstruct,\n    completed,\n    inputsLocked,\n    bind,\n  } = useSetPoolSize();\n\n  const validate = useMemo(\n    () =>\n      composeValidator({\n        poolOwner: buildPointValidator(),\n        poolSize: buildNumberValidator(0),\n      }),\n    []\n  );\n\n  const onValues = useCallback(\n    ({ valid, values }) => {\n      if (valid) {\n        construct(patp2dec(values.poolOwner), values.poolSize);\n      } else {\n        unconstruct();\n      }\n    },\n    [construct, unconstruct]\n  );\n\n  const initialValues = useMemo(() => ({ poolSize: 5 }), []);\n\n  return (\n    <View pop={pop} inset>\n      <Grid>\n        <Grid.Item full as={ViewHeader}>\n          Set Pool Size\n        </Grid.Item>\n\n        {!spawnIsDelegatedSending && (\n          <Grid.Item full as={WarningBox} className=\"mb4 f6\">\n            The spawn proxy must be set to{' '}\n            <CopiableAddress>\n              {_contracts.delegatedSending.address}\n            </CopiableAddress>{' '}\n            for invitations to be available for use.\n          </Grid.Item>\n        )}\n\n        {!hasKeysSet && (\n          <Grid.Item full as={WarningBox} className=\"mb4 f6\">\n            Networking keys must be configured for invitations to be available\n            for use.\n          </Grid.Item>\n        )}\n\n        <BridgeForm\n          validate={validate}\n          onValues={onValues}\n          initialValues={initialValues}>\n          {({ handleSubmit, values }) => (\n            <>\n              <Grid.Item\n                full\n                as={Text}\n                className={cn('f5 wrap', {\n                  green3: completed,\n                })}>\n                {completed ? (\n                  <>\n                    {values.poolSize} invites have been allocated to{' '}\n                    <CopiableAddress>{values.poolOwner}</CopiableAddress>\n                  </>\n                ) : (\n                  `Allocate invites to a child point.`\n                )}\n              </Grid.Item>\n\n              {!completed && (\n                <>\n                  <Grid.Item\n                    full\n                    as={PointInput}\n                    className=\"mt4\"\n                    name=\"poolOwner\"\n                    label=\"Point\"\n                    disabled={inputsLocked}\n                  />\n                  <Grid.Item\n                    full\n                    as={NumberInput}\n                    className=\"mb4\"\n                    name=\"poolSize\"\n                    label=\"Pool Size\"\n                    disabled={inputsLocked}\n                  />\n                </>\n              )}\n\n              <Grid.Item full as={FormError} />\n\n              <Grid.Item\n                full\n                as={InlineEthereumTransaction}\n                {...bind}\n                onReturn={() => pop()}\n              />\n            </>\n          )}\n        </BridgeForm>\n      </Grid>\n    </View>\n  );\n}\n","import React, { useCallback, useMemo } from 'react';\nimport cn from 'classnames';\nimport { Grid, Text, CheckboxInput } from 'indigo-react';\nimport * as azimuth from 'azimuth-js';\n\nimport { useNetwork } from 'store/network';\nimport { usePointCursor } from 'store/pointCursor';\nimport { usePointCache } from 'store/pointCache';\nimport { useWallet } from 'store/wallet';\n\nimport * as need from 'lib/need';\nimport useCurrentPointName from 'lib/useCurrentPointName';\nimport useEthereumTransaction from 'lib/useEthereumTransaction';\nimport { GAS_LIMITS } from 'lib/constants';\nimport { useLocalRouter } from 'lib/LocalRouter';\n\nimport ViewHeader from 'components/ViewHeader';\nimport InlineEthereumTransaction from 'components/InlineEthereumTransaction';\nimport View from 'components/View';\n\nimport BridgeForm from 'form/BridgeForm';\nimport { composeValidator, buildCheckboxValidator } from 'form/validators';\n\nfunction useAcceptTransfer() {\n  const { contracts } = useNetwork();\n  const { pointCursor } = usePointCursor();\n  const { syncExtras, syncControlledPoints } = usePointCache();\n  const { wallet } = useWallet();\n\n  const _contracts = need.contracts(contracts);\n  const _point = need.point(pointCursor);\n  const _address = need.addressFromWallet(wallet);\n\n  const transaction = useEthereumTransaction(\n    useCallback(\n      reset =>\n        azimuth.ecliptic.transferPoint(_contracts, _point, _address, reset),\n      [_contracts, _point, _address]\n    ),\n    useCallback(\n      () => Promise.all([syncExtras(_point), syncControlledPoints()]),\n      [_point, syncControlledPoints, syncExtras]\n    ),\n    GAS_LIMITS.TRANSFER\n  );\n\n  return {\n    ...transaction,\n  };\n}\n\nexport default function AcceptTransfer() {\n  const { pop } = useLocalRouter();\n\n  const name = useCurrentPointName();\n\n  const { completed, bind, inputsLocked, construct } = useAcceptTransfer();\n\n  const initialValues = useMemo(() => ({ noReset: false }), []);\n\n  const validate = useMemo(\n    () => composeValidator({ noReset: buildCheckboxValidator() }),\n    []\n  );\n\n  const onValues = useCallback(\n    ({ valid, values, form }) => {\n      construct(!values.noReset);\n    },\n    [construct]\n  );\n\n  return (\n    <View pop={pop} inset>\n      <Grid>\n        <Grid.Item full as={ViewHeader}>\n          Accept Transfer\n        </Grid.Item>\n\n        <Grid.Item\n          full\n          as={Text}\n          className={cn('f5 wrap', {\n            green3: completed,\n          })}>\n          {completed\n            ? `${name} has been accepted.`\n            : `Accept the incoming transfer of ${name}.`}\n        </Grid.Item>\n\n        <BridgeForm\n          validate={validate}\n          initialValues={initialValues}\n          onValues={onValues}>\n          {() => (\n            <Grid.Item\n              full\n              as={CheckboxInput}\n              name=\"noReset\"\n              label=\"Retain proxies and key configuration, in case of transferring to self\"\n              disabled={inputsLocked}\n            />\n          )}\n        </BridgeForm>\n\n        <Grid.Item\n          full\n          as={InlineEthereumTransaction}\n          {...bind}\n          onReturn={() => pop()}\n        />\n      </Grid>\n    </View>\n  );\n}\n","import React, { useCallback, useMemo } from 'react';\nimport cn from 'classnames';\nimport { Grid, Text } from 'indigo-react';\nimport * as azimuth from 'azimuth-js';\nimport { memoize } from 'lodash';\n\nimport { useNetwork } from 'store/network';\nimport { useWallet } from 'store/wallet';\nimport { useHistory } from 'store/history';\n\nimport * as need from 'lib/need';\nimport useEthereumTransaction from 'lib/useEthereumTransaction';\nimport { GAS_LIMITS } from 'lib/constants';\nimport { useLocalRouter } from 'lib/LocalRouter';\nimport { useFlowCommand } from 'lib/flowCommand';\nimport { isValidAddress, eqAddr } from 'lib/utils/address';\n\nimport ViewHeader from 'components/ViewHeader';\nimport InlineEthereumTransaction from 'components/InlineEthereumTransaction';\nimport View from 'components/View';\n\nimport BridgeForm from 'form/BridgeForm';\nimport { AddressInput } from 'form/Inputs';\nimport { composeValidator } from 'form/validators';\n\nfunction useAcceptLockup() {\n  const { contracts } = useNetwork();\n  const { push, names } = useHistory();\n\n  const flow = useFlowCommand();\n\n  const _contracts = need.contracts(contracts);\n\n  const transaction = useEthereumTransaction(\n    useCallback(\n      from => {\n        if (flow.lock === 'conditional') {\n          return azimuth.conditionalSR.transferCommitment(_contracts, from);\n        } else {\n          return azimuth.linearSR.transferBatch(_contracts, from);\n        }\n      },\n      [_contracts, flow]\n    ),\n    useCallback(() => push(names.STAR_RELEASE), [push, names]),\n    GAS_LIMITS.TRANSFER_LOCKUP\n  );\n\n  return {\n    ...transaction,\n  };\n}\n\nexport default function AcceptLockup() {\n  const { pop } = useLocalRouter();\n  const { contracts } = useNetwork();\n  const { wallet } = useWallet();\n  const flow = useFlowCommand();\n\n  const _contracts = need.contracts(contracts);\n  const _address = need.addressFromWallet(wallet);\n\n  const {\n    completed,\n    bind,\n    inputsLocked,\n    construct,\n    unconstruct,\n  } = useAcceptLockup();\n\n  const initialValues = useMemo(() => {\n    if (!flow.from) return {};\n    return { from: flow.from };\n  }, [flow]);\n\n  const getApproved = useMemo(() => {\n    return memoize(async from => {\n      console.log('------ looking up');\n      const lok = await (flow.lock === 'conditional'\n        ? azimuth.conditionalSR.getCommitment(_contracts, from)\n        : azimuth.linearSR.getBatch(_contracts, from));\n      return lok.approvedTransferTo;\n    });\n  }, [flow, _contracts]);\n\n  const validate = useMemo(\n    () =>\n      composeValidator({\n        from: async from => {\n          if (!isValidAddress(from)) {\n            return 'This is not a valid Ethereum address.';\n          }\n          const approved = await getApproved(from);\n          if (!eqAddr(_address, approved)) {\n            return 'Not permitted to take lockup from this address.';\n          }\n        },\n      }),\n    [_address, getApproved]\n  );\n\n  const onValues = useCallback(\n    ({ valid, values, form }) => {\n      if (valid) {\n        construct(values.from);\n      } else {\n        unconstruct();\n      }\n    },\n    [construct, unconstruct]\n  );\n\n  return (\n    <View pop={pop} inset>\n      <Grid>\n        <Grid.Item full as={ViewHeader}>\n          Accept Star Lockup\n        </Grid.Item>\n\n        <Grid.Item\n          full\n          as={Text}\n          className={cn('f5 wrap', {\n            green3: completed,\n          })}>\n          {completed\n            ? `You have accepted the star lockup.`\n            : `Accept the incoming transfer of a star lockup.`}\n        </Grid.Item>\n\n        <BridgeForm\n          validate={validate}\n          initialValues={initialValues}\n          onValues={onValues}>\n          {() => (\n            <Grid.Item\n              full\n              as={AddressInput}\n              name=\"from\"\n              label=\"Previous owner of the star lockup\"\n              disabled={inputsLocked}\n              className=\"mv4\"\n            />\n          )}\n        </BridgeForm>\n\n        <Grid.Item\n          full\n          as={InlineEthereumTransaction}\n          {...bind}\n          onReturn={() => pop()}\n        />\n      </Grid>\n    </View>\n  );\n}\n","import React, { useCallback, useEffect, useMemo } from 'react';\nimport { Grid } from 'indigo-react';\nimport * as ob from 'urbit-ob';\nimport { ecliptic } from 'azimuth-js';\n\nimport View from 'components/View';\nimport InlineEthereumTransaction from 'components/InlineEthereumTransaction';\nimport ViewHeader from 'components/ViewHeader';\n\nimport { useNetwork } from 'store/network';\nimport { usePointCache } from 'store/pointCache';\nimport { usePointCursor } from 'store/pointCursor';\nimport { useHistory } from 'store/history';\n\nimport { GAS_LIMITS } from 'lib/constants';\nimport useEthereumTransaction from 'lib/useEthereumTransaction';\nimport * as need from 'lib/need';\n\nfunction useAdopt() {\n  const { contracts } = useNetwork();\n  const _contracts = need.contracts(contracts);\n\n  const { pointCursor } = usePointCursor();\n  const point = need.point(pointCursor);\n\n  const { syncResidents } = usePointCache();\n\n  return useEthereumTransaction(\n    useCallback(\n      (adoptee, denied) =>\n        denied\n          ? ecliptic.reject(_contracts, adoptee)\n          : ecliptic.adopt(_contracts, adoptee),\n      [_contracts]\n    ),\n    useCallback(() => syncResidents(point), [syncResidents, point]),\n    GAS_LIMITS.DEFAULT\n  );\n}\n\nexport default function Adopt() {\n  const { pop, data } = useHistory();\n\n  const { adoptee, denied } = data;\n\n  const patp = useMemo(() => ob.patp(adoptee), [adoptee]);\n\n  const { construct, bind, completed } = useAdopt();\n\n  const body = useMemo(\n    () =>\n      denied ? (\n        <>\n          {completed ? 'Denied' : 'Denying'} adoption request to{' '}\n          <span className=\"mono\">{patp}</span>\n        </>\n      ) : (\n        <>\n          {completed ? 'Approved' : 'Approving'} adoption request to{' '}\n          <span className=\"mono\">{patp}</span>\n        </>\n      ),\n    [patp, denied, completed]\n  );\n\n  useEffect(() => {\n    construct(adoptee, denied);\n  }, [construct, adoptee, denied]);\n\n  return (\n    <View pop={() => pop()} inset>\n      <Grid>\n        <Grid.Item full as={ViewHeader} className=\"mb2\">\n          Adopt\n        </Grid.Item>\n        <Grid.Item full className=\"gray4 f5 mv2\">\n          {body}\n        </Grid.Item>\n        <Grid.Item\n          full\n          {...bind}\n          as={InlineEthereumTransaction}\n          onReturn={() => pop()}\n        />\n      </Grid>\n    </View>\n  );\n}\n","import React, { useCallback } from 'react';\nimport { Grid } from 'indigo-react';\n\nimport { useLocalRouter } from 'lib/LocalRouter';\n\nimport View from 'components/View';\nimport { ForwardButton } from 'components/Buttons';\n\nexport default function Bitcoin() {\n  const { pop, push, names } = useLocalRouter();\n\n  const goXpub = useCallback(() => push(names.BITCOIN_XPUB), [push, names]);\n  const goSignTransaction = useCallback(\n    () => push(names.BITCOIN_SIGN_TRANSACTION),\n    [push, names]\n  );\n\n  return (\n    <View pop={pop} inset>\n      <Grid.Item full className=\"mb4 f5\">\n        Bitcoin\n      </Grid.Item>\n      <Grid.Divider />\n      <Grid className=\"pt2\">\n        <Grid.Item\n          full\n          as={ForwardButton}\n          detail=\"Xpub for Landscape wallet\"\n          onClick={goXpub}>\n          Xpub\n        </Grid.Item>\n        <Grid.Divider />\n        <Grid.Item\n          full\n          as={ForwardButton}\n          className=\"mt1\"\n          detail=\"Sign transaction from Landscape\"\n          onClick={goSignTransaction}>\n          Sign Transaction\n        </Grid.Item>\n      </Grid>\n    </View>\n  );\n}\n","import React from 'react';\nimport { Grid, Text } from 'indigo-react';\nimport { useWallet } from 'store/wallet';\n\nimport { useLocalRouter } from 'lib/LocalRouter';\n\nimport ViewHeader from 'components/ViewHeader';\nimport View from 'components/View';\nimport WarningBox from 'components/WarningBox';\n\nimport CopiableAddressWrap from 'components/CopiableAddressWrap';\nimport Highlighted from 'components/Highlighted';\n\nimport * as need from 'lib/need';\n\nexport default function Xpub() {\n  const { pop } = useLocalRouter();\n  const { urbitWallet } = useWallet();\n\n  const { xpub: zpub } = need.urbitWallet(urbitWallet).bitcoinMainnet.keys;\n  const { xpub: vpub } = need.urbitWallet(urbitWallet).bitcoinTestnet.keys;\n\n  // set to false for BTC testnet\n  const isMainnet = true;\n\n  return (\n    <View pop={pop} inset>\n      <Grid className=\"mt4\">\n        <Grid.Item full as={ViewHeader}>\n          Bitcoin\n        </Grid.Item>\n        <Grid.Item full as={WarningBox}>\n          We do not recommend using this feature for significant amounts of\n          money, since your private keys are exposed to the browser.\n        </Grid.Item>\n        <Grid.Item full className=\"mt4\" as={Text}>\n          The public key derived from your master ticket.\n        </Grid.Item>\n        <Grid.Item full className=\"mt4\" as={Text}>\n          Paste it into landscape while setting up your wallet.\n        </Grid.Item>\n        <Grid.Item full className=\"mt4\" as={Text}>\n          <Highlighted>\n            <CopiableAddressWrap>{isMainnet ? zpub : vpub}</CopiableAddressWrap>\n          </Highlighted>\n        </Grid.Item>\n      </Grid>\n    </View>\n  );\n}\n","import React from 'react';\n\nexport default class WithErrorBoundary extends React.Component {\n  static getDerivedStateFromError(error) {\n    return { error };\n  }\n  constructor(props) {\n    super(props);\n\n    this.state = { error: null };\n  }\n\n  render() {\n    if (this.state.error) {\n      return this.props.render(this.state.error);\n    }\n\n    return this.props.children;\n  }\n}\n","import React, { useMemo } from 'react';\nimport newGithubIssueUrl from 'new-github-issue-url';\nimport { OutButton, RestartButton } from './Buttons';\nimport { versionLabel } from 'lib/flags';\n\nconst buildTitle = error => `Error Report: ${error.message}`;\n\nconst buildBody = error => `\\n\n<!-- Thanks for submitting this error! Can you help us identify the issue by providing additional context? -->\n\\n\n## Context\n\\n\n<!-- 1) What were you doing when you encountered this error? -->\n\\n\n<!-- 2) If you're comfortable sharing (don't self-dox!), what Ethereum address were you logged in with? -->\n\\n\n## Error\\n\\n\n\\`\\`\\`\n${error.stack}\n\\`\\`\\`\n\\n\nIn Bridge version ${versionLabel}.\\n\n`;\n\n/**\n * NOTE: we want to use as few normal components here as possible, since the\n * error might have originated from within those components, making this\n * whole error boundary useless.\n */\nexport default function GlobalErrorBoundary({ error }) {\n  const url = useMemo(\n    () =>\n      newGithubIssueUrl({\n        user: 'urbit',\n        repo: 'bridge',\n        labels: ['bug', 'error handling'],\n        title: buildTitle(error),\n        body: buildBody(error),\n      }),\n    [error]\n  );\n\n  return (\n    <div className=\"mw1 ph4\">\n      <h2 className=\"mt8\">\n        Bridge Error!{' '}\n        <span role=\"img\" aria-label=\"a bridge on fire\">\n          🌉🔥\n        </span>\n      </h2>\n      <p className=\"mt4 f5\">\n        We caught an error thrown by the Bridge application client-side code.\n        <br />\n        <b>Your points and assets are most likely safe.</b>\n      </p>\n      <p className=\"mt4\">\n        If you'd like to help us make Bridge better, you can submit the error\n        and your description of events to our GitHub issue tracker.\n      </p>\n      <OutButton href={url} solid>\n        Submit the Issue on GitHub\n      </OutButton>\n      <pre className=\"bg-gray1 mt4 p4 mono scroll-x\">{error.stack}</pre>\n      <p className=\"mt4\">\n        You can reload Bridge and retry the operation that caused an error. If\n        the error persists, please submit a bug report and we'll work with you\n        to resolve it!\n      </p>\n      <RestartButton onClick={() => document.location.reload()} solid success>\n        Reload Bridge\n      </RestartButton>\n    </div>\n  );\n}\n","import React from 'react';\nimport { useEffect } from 'react';\nimport { Just, Nothing } from 'folktale/maybe';\nimport { IndigoApp } from 'indigo-react';\n\nimport Router from 'components/Router';\n\nimport Provider from 'store/Provider';\n\nimport { ROUTE_NAMES } from 'lib/routeNames';\nimport { ROUTES } from 'lib/router';\nimport { NETWORK_TYPES } from 'lib/network';\nimport { walletFromMnemonic } from 'lib/wallet';\nimport { isDevelopment, isMainnet, isRopsten } from 'lib/flags';\nimport useImpliedTicket from 'lib/useImpliedTicket';\nimport useHasDisclaimed from 'lib/useHasDisclaimed';\n\nimport 'style/index.scss';\nimport WithErrorBoundary from 'components/WithErrorBoundary';\nimport GlobalErrorBoundary from 'components/GlobalErrorBoundary';\n\nconst INITIAL_NETWORK_TYPE = isRopsten\n  ? NETWORK_TYPES.ROPSTEN\n  : isDevelopment && !isMainnet\n  ? NETWORK_TYPES.LOCAL\n  : NETWORK_TYPES.MAINNET;\n\n// NB(shrugs): modify these variables to change the default local state.\nconst SHOULD_STUB_LOCAL = process.env.REACT_APP_STUB_LOCAL === 'true';\nconst IS_STUBBED = isDevelopment && SHOULD_STUB_LOCAL;\n\nconst INITIAL_WALLET = IS_STUBBED\n  ? walletFromMnemonic(\n      process.env.REACT_APP_DEV_MNEMONIC,\n      process.env.REACT_APP_HD_PATH\n    )\n  : undefined;\nconst INITIAL_MNEMONIC = IS_STUBBED\n  ? Just(process.env.REACT_APP_DEV_MNEMONIC)\n  : Nothing();\nconst INITIAL_POINT_CURSOR = IS_STUBBED ? Just(65792) : Nothing();\n\nfunction useInitialRoutes() {\n  const [hasDisclaimed] = useHasDisclaimed();\n  const hasImpliedTicket = !!useImpliedTicket();\n\n  const isActivateUrl = window.location.pathname === '/activate';\n\n  if (IS_STUBBED) {\n    return [\n      { key: ROUTE_NAMES.LOGIN },\n      { key: ROUTE_NAMES.POINTS },\n      { key: ROUTE_NAMES.POINT },\n    ];\n  }\n\n  if (hasImpliedTicket || isActivateUrl) {\n    return [{ key: ROUTE_NAMES.ACTIVATE }];\n  }\n\n  if (!hasDisclaimed) {\n    return [{ key: ROUTE_NAMES.DISCLAIMER, data: { next: ROUTE_NAMES.LOGIN } }];\n  }\n\n  return [{ key: ROUTE_NAMES.LOGIN }];\n}\n\nfunction Bridge() {\n  const initialRoutes = useInitialRoutes();\n\n  //  full reload if the user changes their selected network in Metamask\n  //\n  useEffect(() => {\n    if (window.ethereum) {\n      window.ethereum.on('chainChanged', () => {\n        document.location.reload();\n      });\n    }\n  }, []);\n\n  return (\n    <WithErrorBoundary render={error => <GlobalErrorBoundary error={error} />}>\n      <Provider\n        views={ROUTES}\n        names={ROUTE_NAMES}\n        initialRoutes={initialRoutes}\n        initialNetworkType={INITIAL_NETWORK_TYPE}\n        initialWallet={INITIAL_WALLET}\n        initialMnemonic={INITIAL_MNEMONIC}\n        initialPointCursor={INITIAL_POINT_CURSOR}>\n        <IndigoApp>\n          <Router />\n        </IndigoApp>\n      </Provider>\n    </WithErrorBoundary>\n  );\n}\n\nexport default Bridge;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport Bridge from './Bridge';\n\nif (process.env.NODE_ENV !== 'production') {\n  require('@welldone-software/why-did-you-render')(React);\n}\n\nReactDOM.render(<Bridge />, document.getElementById('root'));\n","import React from 'react';\nimport { createTeleporter } from 'react-teleporter';\n\nconst FooterTeleporter = createTeleporter();\n\nconst Footer = FooterTeleporter.Source;\nFooter.Target = props => <FooterTeleporter.Target as=\"footer\" {...props} />;\n\nexport default Footer;\n","import { crypto } from 'bitcoinjs-lib';\nimport { ecdsaSign } from 'secp256k1';\nimport Web3 from 'web3';\nimport WalletConnect from '@walletconnect/client';\n\nimport { WALLET_TYPES } from './constants';\nimport { ledgerSignMessage } from './ledger';\nimport { trezorSignMessage } from './trezor';\nimport BridgeWallet from './types/BridgeWallet';\n\nconst MESSAGE = 'Bridge Authentication Token';\n\nfunction signMessage(privateKey: Buffer) {\n  const msg = '\\x19Ethereum Signed Message:\\n' + MESSAGE.length + MESSAGE;\n  // #ecdsaSign requires a 32-byte buffer, hence sha256\n  const hashed = crypto.sha256(Buffer.from(msg));\n  const { signature } = ecdsaSign(Buffer.from(hashed), privateKey);\n\n  // add key recovery parameter\n  const ethSignature = new Uint8Array(65);\n  ethSignature.set(signature);\n  const v = (ethSignature[32] & 1) + 27;\n  ethSignature[64] = v;\n\n  return ethSignature;\n}\n\ntype MetamaskAuthTokenArgs = {\n  address: string;\n  web3: Web3;\n  walletType: symbol;\n};\n\ntype LedgerAuthTokenArgs = {\n  walletHdPath: string;\n  walletType: symbol;\n};\n\ntype TrezorAuthTokenArgs = LedgerAuthTokenArgs;\n\ntype WalletConnectAuthTokenArgs = {\n  address: string;\n  connector: WalletConnect;\n  walletType: symbol;\n};\n\ntype DefaultAuthTokenArgs = {\n  wallet: BridgeWallet;\n  walletType?: symbol;\n};\n\ntype GetAuthTokenArgs =\n  | MetamaskAuthTokenArgs\n  | LedgerAuthTokenArgs\n  | TrezorAuthTokenArgs\n  | WalletConnectAuthTokenArgs\n  | DefaultAuthTokenArgs;\n\nconst getMetamaskAuthToken = ({ address, web3 }: MetamaskAuthTokenArgs) => {\n  if (window.ethereum) {\n    //NOTE  this doesn't _seem_ to be affected by #596,\n    //      but web3.eth.personal.sign hits it semi-reliably?\n    //      no idea what's going on, we should figure it out,\n    //      but we apply this bandaid to hopefully stop the bleeding.\n    return window.ethereum.request({\n      method: 'personal_sign',\n      params: [MESSAGE, address],\n      from: address,\n    });\n  } else {\n    return web3.eth.personal.sign(MESSAGE, address, '');\n  }\n};\n\nconst getLedgerAuthToken = ({ walletHdPath }: LedgerAuthTokenArgs) => {\n  return ledgerSignMessage(MESSAGE, walletHdPath);\n};\n\nconst getTrezorAuthToken = ({ walletHdPath }: TrezorAuthTokenArgs) => {\n  return trezorSignMessage(MESSAGE, walletHdPath);\n};\n\nconst getWalletConnectAuthToken = ({\n  address,\n  connector,\n}: WalletConnectAuthTokenArgs) => {\n  return connector.signPersonalMessage([MESSAGE, address]);\n};\n\nconst getDefaultAuthToken = ({ wallet }: DefaultAuthTokenArgs) => {\n  const signature = signMessage(wallet.privateKey);\n\n  const token = `0x${Buffer.from(signature).toString('hex')}`;\n\n  return token;\n};\n\nexport const getAuthToken = async ({\n  walletType,\n  ...args\n}: GetAuthTokenArgs) => {\n  switch (walletType) {\n    case WALLET_TYPES.METAMASK:\n      return getMetamaskAuthToken(args);\n    case WALLET_TYPES.LEDGER:\n      return getLedgerAuthToken(args);\n    case WALLET_TYPES.TREZOR:\n      return getTrezorAuthToken(args);\n    case WALLET_TYPES.WALLET_CONNECT:\n      return getWalletConnectAuthToken(args);\n    default:\n      return getDefaultAuthToken(args);\n  }\n};\n","import Transport from '@ledgerhq/hw-transport-u2f';\nimport Eth from '@ledgerhq/hw-app-eth';\nimport BN from 'bn.js';\n\nexport const LEDGER_LEGACY_PATH = \"m/44'/60'/0'/x\";\nexport const LEDGER_LIVE_PATH = \"m/44'/60'/x'/0/0\";\n\nexport const chopHdPrefix = str =>\n  str.slice(0, 2) === 'm/' ? str.slice(2) : str;\nexport const addHdPrefix = str => (str.slice(0, 2) === 'm/' ? str : 'm/' + str);\n\nexport const ledgerSignTransaction = async (txn, hdPath) => {\n  const transport = await Transport.create();\n  const eth = new Eth(transport);\n\n  const path = chopHdPrefix(hdPath);\n  const serializedTx = txn.serialize().toString('hex');\n  const sig = await eth.signTransaction(path, serializedTx);\n\n  txn.v = new BN(sig.v, 'hex');\n  txn.r = new BN(sig.r, 'hex');\n  txn.s = new BN(sig.s, 'hex');\n\n  return txn;\n};\n\nexport const ledgerSignMessage = async (message, hdPath) => {\n  const transport = await Transport.create();\n  const eth = new Eth(transport);\n\n  const path = chopHdPrefix(hdPath);\n  const { r, s, v } = await eth.signPersonalMessage(\n    path,\n    Buffer.from(message).toString('hex')\n  );\n  const ethSignature = new Uint8Array(65);\n  ethSignature.set(Buffer.from(r, 'hex'));\n  ethSignature.set(Buffer.from(s, 'hex'), 32);\n  ethSignature[64] = v;\n\n  return `0x${Buffer.from(ethSignature).toString('hex')}`;\n};\n","import ob from 'urbit-ob';\nimport kg from 'urbit-key-generation';\nimport * as more from 'more-entropy';\nimport { chunk, flatMap, zipWith } from 'lodash';\nimport { shas } from 'lib/networkCode';\n\nimport {\n  MIN_STAR,\n  MIN_PLANET,\n  SEED_ENTROPY_BITS,\n  GALAXY_ENTROPY_BITS,\n  STAR_ENTROPY_BITS,\n  PLANET_ENTROPY_BITS,\n  ZOD,\n} from './constants';\n\nconst SEED_LENGTH_BYTES = SEED_ENTROPY_BITS / 8;\n\nconst getTicketBitSize = point =>\n  point < MIN_STAR\n    ? GALAXY_ENTROPY_BITS\n    : point < MIN_PLANET\n    ? STAR_ENTROPY_BITS\n    : PLANET_ENTROPY_BITS;\n\n// returns a promise for a ticket string\nexport const makeTicket = point => {\n  const bits = getTicketBitSize(point);\n\n  const bytes = bits / 8;\n  const some = new Uint8Array(bytes);\n  window.crypto.getRandomValues(some);\n\n  const gen = new more.Generator();\n\n  return new Promise((resolve, reject) => {\n    gen.generate(bits, result => {\n      const chunked = chunk(result, 2);\n      const desired = chunked.slice(0, bytes); // only take required entropy\n      const more = flatMap(desired, arr => arr[0] ^ arr[1]);\n      const entropy = zipWith(some, more, (x, y) => x ^ y);\n      const buf = Buffer.from(entropy);\n      const patq = ob.hex2patq(buf.toString('hex'));\n      resolve(patq);\n      reject('Entropy generation failed');\n    });\n  });\n};\n\nexport const makeDeterministicTicket = (point, seed) => {\n  const bits = getTicketBitSize(point);\n\n  const bytes = bits / 8;\n\n  const pointSalt = Buffer.concat([\n    Buffer.from(point.toString()),\n    Buffer.from('invites'),\n  ]);\n  const entropy = shas(Buffer.from(seed, 'hex'), pointSalt);\n\n  const buf = entropy.slice(0, bytes);\n  const patq = ob.hex2patq(buf.toString('hex'));\n  return patq;\n};\n\n// return a wallet object\nexport const generateWallet = async (point, ticket, boot) => {\n  const config = {\n    ticket: ticket,\n    seedSize: SEED_LENGTH_BYTES,\n    ship: point,\n    password: '',\n    revisions: {},\n    boot: boot,\n  };\n\n  // This is here to notify anyone who opens console because the thread\n  // hangs, blocking UI updates so this cannot be done in the UI\n  console.log('Generating Wallet for point address: ', point);\n\n  const wallet = await kg.generateWallet(config);\n\n  return wallet;\n};\n\nexport const generateOwnershipWallet = (ship, ticket) =>\n  kg.generateOwnershipWallet({ ship, ticket });\n\n// temporary wallets need to be derivable from just the ticket,\n// so we always use ~zod as the wallet point.\nexport const generateTemporaryOwnershipWallet = ticket =>\n  generateOwnershipWallet(ZOD, ticket);\n\nexport const generateTemporaryTicketAndWallet = async point => {\n  const ticket = await makeTicket(point);\n  const owner = await generateOwnershipWallet(ZOD, ticket);\n\n  return { ticket, owner };\n};\n\nexport const generateTemporaryDeterministicWallet = async (point, seed) => {\n  const ticket = makeDeterministicTicket(point, seed);\n  const owner = await generateOwnershipWallet(ZOD, ticket);\n\n  return { ticket, owner };\n};\n","var BigInteger = require('jsbn').BigInteger;\n\nfunction Noun() {\n  this._mug = 0;\n}\n\nNoun.prototype.loob = function () {\n  throw new Error(\"Bail\");\n};\n\nNoun.prototype.toString = function() {\n  var parts = [];\n  this.pretty(parts, false);\n  return parts.join('');\n};\n\nNoun.prototype.mug = function () {\n  if ( 0 === this._mug ) {\n    this._mug = this.calculateMug();\n  }\n  return this._mug;\n};\n\nNoun.prototype.mugged = function () {\n  return 0 !== this._mug;\n};\n\nNoun.prototype.deep = false;\nNoun.prototype.bump = function () {\n  throw new Error(\"Bail\");\n}\n\nNoun.prototype.equals = function(o) {\n  if ( this === o ) {\n    return true;\n  }\n\n  if ( this instanceof Cell ) {\n    if ( o instanceof Cell) {\n      return this.unify(o);\n    }\n    else {\n      return false;\n    }\n  }\n  else {\n    if ( o instanceof Cell ) {\n      return false;\n    }\n    else if (0 === this.number.compareTo(o.number)) {\n      o.number = this.number;\n      return true;\n    }\n    else {\n      return false;\n    }\n  }\n};\n\n\nfunction _mug_fnv(has_w) {\n  return Math.imul(has_w, 16777619);\n}\n\nfunction _mug_out(has_w) {\n  return (has_w >>> 31) ^ (has_w & 0x7fffffff);\n}\n\nfunction _mug_both(lef_w, rit_w) {\n  var bot_w = _mug_fnv(lef_w ^ _mug_fnv(rit_w));\n  var out_w = _mug_out(bot_w);\n\n  if ( 0 !== out_w ) {\n    return out_w;\n  }\n  else {\n    return _mug_both(lef_w, ++rit_w);\n  }\n}\n\nfunction Cell(head, tail) {\n  Noun.call(this);\n  this.head = head;\n  this.tail = tail;\n}\nCell.prototype = Object.create(Noun.prototype);\nCell.prototype.constructor = Cell;\nCell.prototype.deep = true;\n\nCell.prototype.pretty = function(out, tail) {\n  if ( !tail ) {\n    out.push('[');\n  }\n  this.head.pretty(out, false);\n  out.push(' ');\n  this.tail.pretty(out, true);\n  if ( !tail ) {\n    out.push(']');\n  }\n};\n\nCell.prototype.calculateMug = function() {\n  return _mug_both(this.head.mug(), this.tail.mug());\n};\n\nCell.prototype.unify = function(o) {\n  if ( this === o ) {\n    return true;\n  }\n\n  if ( o.mugged() ) {\n    if ( this.mugged() ) {\n      if ( this.mug() !== o.mug() ) {\n        return false;\n      }\n    }\n    else {\n      return o.unify(this);\n    }\n  }\n\n  if ( this.head.equals(o.head) ) {\n    o.head = this.head;\n    if ( this.tail.equals(o.tail) ) {\n      o._mug = this._mug;\n      o.tail = this.tail;\n      return true;\n    }\n  }\n\n  return false;\n};\n\nfunction Atom(number) {\n  Noun.call(this);\n  this.number = number;\n}\nAtom.prototype = Object.create(Noun.prototype);\nAtom.prototype.constructor = Atom;\n\nvar small = new Array(256);\n(function() {\n  var i, bi;\n  for ( i = 0; i < 256; ++i ) {\n    bi = new BigInteger();\n    bi.fromInt(i);\n    small[i] = new Atom(bi);\n  }\n})();\n\nvar fragCache = {\n  0: function(a) {\n    throw new Error(\"Bail\");\n  },\n  1: function(a) {\n    return a;\n  },\n};\nvar one = small[1];\nNoun.fragmenter = function(a) {\n  var s = a.shortCode();\n  if ( fragCache.hasOwnProperty(s) ) {\n    return fragCache[s];\n  }\n  else {\n    for ( var parts = ['a']; !one.equals(a); a = a.mas() ) {\n      parts.push( ( 2 === a.cap().valueOf() ) ? 'head' : 'tail' );\n    }\n    return fragCache[s] =\n      function(a) {\n        return parts.join('.');\n      }\n  }\n}\n\nNoun.prototype.at = function(a) {\n  return Noun.fragmenter(a)(this);\n};\n\nvar shortBi = new BigInteger();\nshortBi.fromInt(65536);\n\nAtom.prototype.bytes = function() {\n  var bytes = this.number.toByteArray();\n  var r = [];\n  for ( var i = bytes.length-1; i >= 0; --i ) {\n    r.push(bytes[i]&0xff);\n  }\n  return r;\n}\n\nAtom.cordToString = function(c) {\n  var bytes = c.bytes();\n  var chars = [];\n\n  for ( var i = 0; i < bytes.length; ++i ) {\n    chars.push(String.fromCharCode(bytes[i]));\n  }\n  return chars.join('');\n};\n\nAtom.prototype.pretty = function(out, tail) {\n  if ( this.number.compareTo(shortBi) < 0 ) {\n    return out.push(this.number.toString(10));\n  }\n  else {\n    var tap = [], isTa = true, isTas = true, bytes = this.number.toByteArray();\n    for ( var i = bytes.length - 1; i >= 0; --i) {\n      var c = bytes[i];\n      if ( isTa && ((c < 32) || (c > 127)) ) {\n        isTa = false;\n        isTas = false;\n        break;\n      }\n      else if ( isTas && !((c > 47 && c < 58) ||  // digits\n                           (c > 96 && c < 123) || // lowercase letters\n                            c === 45) ) {         // -\n        isTas = false;\n      }\n      tap.push(String.fromCharCode(c));\n    }\n    if ( isTas ) {\n      out.push('%');\n      out.push.apply(out, tap);\n    }\n    else if ( isTa ) {\n      out.push(\"'\");\n      out.push.apply(out, tap);\n      out.push(\"'\");\n    }\n    else {\n      out.push(\"0x\");\n      out.push(this.number.toString(16));\n    }\n  }\n};\n\nAtom.prototype.loob = function() {\n  switch ( this.number.intValue() ) {\n    case 0:\n      return true;\n    case 1:\n      return false;\n    default:\n      throw new Error(\"Bail\");\n  }\n};\n\nAtom.prototype.bump = function() {\n  return new Atom(this.number.add(BigInteger.ONE));\n};\n\nvar ida  = i(1);\nvar heda = i(2);\nvar tala = i(3);\n\nAtom.prototype.cap = function() {\n  switch (this.number.intValue()) {\n    case 0:\n    case 1:\n      throw new Error(\"Bail\");\n    default:\n    return this.number.testBit(this.number.bitLength() - 2) ? tala : heda;\n  }\n};\n\nAtom.prototype.mas = function() {\n  switch (this.number.intValue()) {\n    case 0:\n    case 1:\n      throw new Error(\"Bail\");\n    case 2:\n    case 3:\n      return ida;\n    default:\n      var n = this.number;\n      var l = n.bitLength() - 2;\n      var addTop = new BigInteger();\n      addTop.fromInt(1 << l);\n      var mask = new BigInteger();\n      mask.fromInt((1 << l)-1);\n      return new Atom(n.and(mask).xor(addTop));\n  }\n};\n\nAtom.prototype.calculateMug = function() {\n\tvar a = this.number.toByteArray();\n\tvar b, c, d, e, f, bot;\n\tfor ( e = a.length - 1, b = (2166136261|0); ; ++b ) {\n    c = b;\n    bot = ( 0 === a[0] ) ? 1 : 0;\n\t\tfor ( d = e; d >= bot; --d ) {\n      c = _mug_fnv(c ^ (0xff & a[d]));\n\t\t}\n    f = _mug_out(c);\n    if ( 0 !== f ) {\n      return f;\n    }\n\t}\n};\n\nAtom.prototype.shortCode = function() {\n  return this.number.toString(36); // max supported by BigInteger\n};\n\nfunction s(str, radix) {\n\treturn new Atom(new BigInteger(str, radix));\n}\n\nfunction i(num) {\n  if ( num < 256 ) {\n    return small[num];\n  }\n  else {\n    var bi = new BigInteger();\n    bi.fromInt(num);\n    return new Atom(bi);\n  }\n}\n\nfunction m(str) {\n  var i, j, octs = new Array(str.length);\n  for ( i = 0, j = octs.length - 1; i < octs.length; ++i, --j ) {\n    octs[j] = (str.charCodeAt(i) & 0xff).toString(16);\n  }\n  return new Atom(new BigInteger(octs.join(''), 16))\n}\n\nfunction dwim(a) {\n  var n = (arguments.length === 1 ? a : Array.apply(null, arguments));\n\tif ( n instanceof Noun ) {\n\t\treturn n;\n\t}\n\tif ( typeof n === \"number\" ) {\n\t\treturn i(n);\n\t}\n\telse if ( Array.isArray(n) ) {\n\t\tvar cel = new Cell(dwim(n[n.length-2]), dwim(n[n.length-1]));\n\t\tfor ( var j = n.length-3; j >= 0; --j ) {\n\t\t\tcel = new Cell(dwim(n[j]), cel);\n\t\t}\n\t\treturn cel;\n\t}\n\telse if ( typeof n === \"string\" ) {\n    return m(n);\n\t}\n}\n\nAtom.prototype.valueOf = function() {\n\treturn this.number.bitLength() <= 32\n\t\t? this.number.intValue()\n\t\t: this.number.toString();\n};\n\nmodule.exports = {\n\tdwim: dwim,\n\tNoun: Noun,\n\tCell: Cell,\n\tAtom: {\n\t\tAtom: Atom,\n\t\tyes:  i(0),\n\t\tno:   i(1),\n    fromMote:   m,\n\t\tfromInt:    i,\n\t\tfromString: s,\n\t},\n};\n","import { sigil, reactRenderer } from '@tlon/sigil-js';\n\nexport default function Sigil({ patp, size, colors, ...rest }) {\n  return sigil({\n    patp,\n    renderer: reactRenderer,\n    style: { width: '100%', height: '100%' }, // NOTE: scale to container\n    size,\n    margin: true,\n    colors,\n    ...rest,\n  });\n}\n","import TrezorConnect from 'trezor-connect';\nimport { convertToInt } from './convertToInt';\nimport BN from 'bn.js';\n\nconst TREZOR_PATH = \"m/44'/60'/0'/0/x\";\n\n// handles 0x-prefixed hex string as well as number type\nconst formatChainId = val =>\n  typeof val === 'number' ? val : convertToInt(val.slice(2), 16);\n\nconst trezorSignTransaction = async (txn, hdpath) => {\n  const trezorFormattedTxn = {\n    to: txn.to.toString('hex'),\n    value: txn.value.toString('hex'),\n    data: txn.data.toString('hex'),\n    gasLimit: txn.gasLimit.toString('hex'),\n    gasPrice: txn.gasPrice.toString('hex'),\n    nonce: txn.nonce.length === 0 ? '00' : txn.nonce.toString('hex'),\n    chainId: formatChainId(txn.common.chainId()),\n  };\n\n  const sig = await TrezorConnect.ethereumSignTransaction({\n    path: hdpath,\n    transaction: trezorFormattedTxn,\n  });\n\n  if (!sig.success) {\n    throw new Error(sig.payload.error);\n  }\n\n  const payload = sig.payload;\n\n  txn.v = new BN(payload.v.slice(2), 'hex');\n  txn.r = new BN(payload.r.slice(2), 'hex');\n  txn.s = new BN(payload.s.slice(2), 'hex');\n\n  return txn;\n};\n\nexport const trezorSignMessage = async (message, hdPath) => {\n  const sig = await TrezorConnect.ethereumSignMessage({\n    path: hdPath,\n    message,\n  });\n\n  if (!sig.success) {\n    throw new Error(sig.payload.error);\n  }\n\n  const { signature } = sig.payload;\n\n  return signature;\n};\n\nexport { TREZOR_PATH, trezorSignTransaction };\n","import React from 'react';\n\n/**\n * A very useful Flutter widget reimplemented with\n * the world's dumbest css hack.\n *\n * Simply: container div with appropriate relative padding,\n * then absolutely pin the child.\n *\n * via: https://www.w3schools.com/howto/howto_css_aspect_ratio.asp\n */\nexport default function AspectRatio({ aspectRatio = 1, children }) {\n  const percent = `${(1 / aspectRatio) * 100}%`;\n\n  return (\n    <div className=\"rel\" style={{ paddingTop: percent }}>\n      <div className=\"abs\" style={{ top: 0, bottom: 0, left: 0, right: 0 }}>\n        {children}\n      </div>\n    </div>\n  );\n}\n","import React from 'react';\nimport ob from 'urbit-ob';\n\nimport Sigil from './Sigil';\nimport AspectRatio from './AspectRatio';\n\n/**\n * patp is Maybe<string>\n */\nexport default function MaybeSigil({ className, patp, size, ...rest }) {\n  const validPatp = patp.matchWith({\n    Nothing: () => null,\n    Just: p =>\n      ob.isValidPatp(p.value) && p.value.length < 15 ? p.value : null,\n  });\n\n  return validPatp ? (\n    <Sigil patp={validPatp} size={size} {...rest} />\n  ) : (\n    <AspectRatio aspectRatio={1} />\n  );\n}\n","import { hex2patp } from 'urbit-ob';\nimport { createRing } from 'lib/keys';\n\nimport jssha256 from 'js-sha256';\n\nfunction shax(buf) {\n  const hashed = jssha256.sha256.array(buf);\n  return Buffer.from(hashed);\n}\n\nfunction hex2buf(hex) {\n  return Buffer.from(hex, 'hex').reverse();\n}\n\nfunction buf2hex(buf) {\n  return Buffer.from(buf)\n    .reverse()\n    .toString('hex');\n}\n\nexport function shas(buf, salt) {\n  return shax(xor(salt, shax(buf)));\n}\n\nfunction xor(a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    console.log('a', a);\n    console.log('b', b);\n    throw new Error('only xor buffers!');\n  }\n  const length = Math.max(a.byteLength, b.byteLength);\n  const result = new Uint8Array(length);\n  for (let i = 0; i < length; i++) {\n    result[i] = a[i] ^ b[i];\n  }\n  return result;\n}\n\nfunction shaf(buf, salt) {\n  const result = shas(buf, salt);\n  const halfway = result.length / 2;\n  const front = result.slice(0, halfway);\n  const back = result.slice(halfway, result.length);\n  return xor(front, back);\n}\n\nexport const generateCode = pair => {\n  const ring = hex2buf(createRing(pair));\n  const salt = hex2buf('73736170'); // salt is the noun %pass\n  const hash = shax(ring);\n  const result = shaf(hash, salt);\n  const half = result.slice(0, result.length / 2);\n\n  return hex2patp(buf2hex(half)).slice(1);\n};\n","import { isDevelopment } from './flags';\n\nconst CHECK_BLOCK_EVERY_MS = isDevelopment ? 1000 : 10000;\nconst DEFAULT_GAS_PRICE_GWEI = 40;\nconst MAX_GAS_PRICE_GWEI = 400;\n\nconst MIN_GALAXY = 0;\nconst MAX_GALAXY = 255;\nconst MIN_STAR = 256;\nconst MAX_STAR = 65535;\nconst MIN_PLANET = 65536;\nconst MAX_PLANET = 4294967297;\n\nconst ZOD = MIN_GALAXY;\n\nconst PLANET_ENTROPY_BITS = 64;\nconst STAR_ENTROPY_BITS = 128;\nconst GALAXY_ENTROPY_BITS = 384;\n\nconst SEED_ENTROPY_BITS = 128;\n\n//TODO move into azimuth-js\nconst GAS_LIMITS = {\n  SPAWN: 250000,\n  TRANSFER: 560000, //NOTE biggest, also update gas tank's max\n  CONFIGURE_KEYS: 100000,\n  SET_PROXY: 150000,\n  //\n  ESCAPE: 115000, //NOTE low sample size\n  ADOPT: 100000, //NOTE low sample size\n  CANCEL_ESCAPE: 200000, //NOTE no samples\n  REJECT: 200000, //NOTE no samples\n  DETACH: 200000, //NOTE no samples\n  //\n  GIFT_PLANET: 450000, //NOTE low sample size, //NOTE also update in gas tank\n  //\n  TRANSFER_LOCKUP: 700000, //NOTE low sample size\n  //\n  SEND_ETH: 21000,\n  //\n  DEFAULT: 550000,\n};\n\n// TODO: this is walletgen-ui specific, move into a wallet router later\nconst GEN_STATES = {\n  ENY_NOSTART: Symbol('ENY_NOSTART'),\n  ENY_PENDING: Symbol('ENY_PENDING'),\n  ENY_SUCCESS: Symbol('ENY_SUCCESS'),\n  ENY_FAILURE: Symbol('ENY_FAILURE'),\n  DERIVATION_NOSTART: Symbol('DERIVATION_NOSTART'),\n  DERIVATION_PENDING: Symbol('DERIVATION_PENDING'),\n  DERIVATION_SUCCESS: Symbol('DERIVATION_SUCCESS'),\n  DERIVATION_FAILURE: Symbol('DERIVATION_FAILURE'),\n  PAPER_NOSTART: Symbol('PAPER_NOSTART'),\n  PAPER_PENDING: Symbol('PAPER_PENDING'),\n  PAPER_SUCCESS: Symbol('PAPER_SUCCESS'),\n  PAPER_FAILURE: Symbol('PAPER_FAILURE'),\n};\n\nconst BUTTON_STATES = {\n  NOSTART: Symbol('NOSTART'),\n  SUCCESS: Symbol('SUCCESS'),\n  ERROR: Symbol('ERROR'),\n  PENDING: Symbol('PENDING'),\n};\n\nconst PROFILE_STATES = {\n  NOSTART: Symbol('NOSTART'),\n  UPLOAD_SUCCESS: Symbol('UPLOAD_SUCCESS'),\n  UPLOAD_ERROR: Symbol('UPLOAD_ERROR'),\n  INPUT_SUCCESS: Symbol('INPUT_SUCCESS'),\n  INPUT_ERROR: Symbol('INPUT_ERROR'),\n};\n\nconst PROGRESS_ANIMATION_DELAY_MS = 500; // .animated-width\n\nconst DEFAULT_HD_PATH = \"m/44'/60'/0'/0/0\";\nconst ETH_ZERO_ADDR = '0x0000000000000000000000000000000000000000';\nconst ETH_ZERO_ADDR_SHORT = '0x0';\n\nconst WALLET_TYPES = {\n  MNEMONIC: Symbol('MNEMONIC'),\n  TICKET: Symbol('TICKET'),\n  SHARDS: Symbol('SHARDS'),\n  LEDGER: Symbol('LEDGER'),\n  TREZOR: Symbol('TREZOR'),\n  PRIVATE_KEY: Symbol('PRIVATE_KEY'),\n  KEYSTORE: Symbol('KEYSTORE'),\n  METAMASK: Symbol('METAMASK'),\n  WALLET_CONNECT: Symbol('WALLET_CONNECT'),\n};\n\nconst NONCUSTODIAL_WALLETS = new Set([\n  WALLET_TYPES.METAMASK,\n  WALLET_TYPES.TREZOR,\n  WALLET_TYPES.LEDGER,\n  WALLET_TYPES.WALLET_CONNECT,\n]);\n\nexport {\n  CHECK_BLOCK_EVERY_MS,\n  DEFAULT_GAS_PRICE_GWEI,\n  DEFAULT_HD_PATH,\n  ETH_ZERO_ADDR,\n  ETH_ZERO_ADDR_SHORT,\n  MAX_GAS_PRICE_GWEI,\n  GAS_LIMITS,\n  GEN_STATES,\n  BUTTON_STATES,\n  PROFILE_STATES,\n  MIN_GALAXY,\n  MAX_GALAXY,\n  MIN_STAR,\n  MAX_STAR,\n  MIN_PLANET,\n  MAX_PLANET,\n  NONCUSTODIAL_WALLETS,\n  PLANET_ENTROPY_BITS,\n  STAR_ENTROPY_BITS,\n  GALAXY_ENTROPY_BITS,\n  SEED_ENTROPY_BITS,\n  WALLET_TYPES,\n  ZOD,\n  PROGRESS_ANIMATION_DELAY_MS,\n};\n","// an object is a promise if it has a `.then` function\n// https://github.com/then/is-promise/blob/master/index.js\nexport const isPromise = obj =>\n  !!obj &&\n  (typeof obj === 'object' || typeof obj === 'function') &&\n  typeof obj.then === 'function';\n","import { some } from 'lodash';\n\nimport {\n  validateNotEmpty,\n  validatePatq,\n  validateShard,\n  validateMnemonic,\n  validateHdPath,\n  validatePoint,\n  validateMaximumPatpByteLength,\n  validateOneOf,\n  validateHexString,\n  validateHexLength,\n  validateEthereumAddress,\n  validateGreaterThan,\n  validateLessThan,\n  validateEmail,\n  validateNotNullAddress,\n  validateHexPrefix,\n  validateLength,\n  validateUnique,\n  validatePsbt,\n} from 'lib/validators';\nimport { isPromise } from 'lib/isPromise';\n\nconst PRIVATE_KEY_CHAR_LENGTH = 64; // 64 hex characters\nconst ADDRESS_CHAR_LENGTH = 40; // 40 hex characters\n\n// iterate over validators, exiting early if there's an error\nconst buildValidator = (validators = [], validate) => value => {\n  for (const validator of validators) {\n    try {\n      const error = validator(value);\n      if (error) {\n        return error;\n      }\n    } catch (error) {\n      console.error(error);\n      return error.message;\n    }\n  }\n\n  if (validate) {\n    // the final validate function can optionally return a promise\n    return validate(value);\n  }\n};\n\n// maps a validator across an array of values\nexport const buildArrayValidator = validator => values => {\n  const errorsOrPromises = values.map(validator);\n  if (some(errorsOrPromises, isPromise)) {\n    return Promise.all(errorsOrPromises);\n  }\n\n  return errorsOrPromises;\n};\n\n// error object has errors if some of its fields are\n// 1) an array with any defined values\n// 2) any defined values\nexport const hasErrors = iter =>\n  some(iter, v => (Array.isArray(v) ? hasErrors(v) : v !== undefined));\n\nexport const buildPatqValidator = (validators = []) =>\n  buildValidator([validateNotEmpty, validatePatq, ...validators]);\nexport const buildShardValidator = (validators = []) =>\n  buildValidator([validateShard, ...validators]);\nexport const buildAnyMnemonicValidator = () =>\n  buildValidator([validateNotEmpty]);\nexport const buildMnemonicValidator = () =>\n  buildValidator([validateNotEmpty, validateMnemonic]);\nexport const buildCheckboxValidator = mustBe =>\n  buildValidator([\n    validateOneOf(mustBe !== undefined ? [mustBe] : [true, false]),\n  ]);\nexport const buildPassphraseValidator = () => buildValidator([]);\n// TODO: validate hdpath format\nexport const buildHdPathValidator = () => buildValidator([validateHdPath]);\nexport const buildPointValidator = (size = 4, validators = []) =>\n  buildValidator([\n    validateNotEmpty,\n    validateMaximumPatpByteLength(size),\n    validatePoint,\n    ...validators,\n  ]);\nexport const buildSelectValidator = options =>\n  buildValidator([validateOneOf(options.map(option => option.value))]);\nexport const buildHexValidator = length =>\n  buildValidator([\n    validateNotEmpty,\n    validateHexPrefix,\n    validateHexString,\n    validateHexLength(length),\n  ]);\nexport const buildPrivateKeyValidator = () =>\n  buildValidator([\n    validateNotEmpty,\n    validateHexString,\n    validateLength(PRIVATE_KEY_CHAR_LENGTH),\n  ]);\nexport const buildUploadValidator = () => buildValidator([validateNotEmpty]);\nexport const buildAddressValidator = () =>\n  buildValidator([\n    validateNotEmpty,\n    validateHexPrefix,\n    validateHexString,\n    validateHexLength(ADDRESS_CHAR_LENGTH),\n    validateNotNullAddress,\n    validateEthereumAddress,\n  ]);\nexport const buildNumberValidator = (min = 0, max = null) => {\n  let validators = [validateGreaterThan(min)];\n  if (max !== null) {\n    validators.push(validateLessThan(max));\n  }\n  return buildValidator(validators);\n};\n\nexport const buildEmailValidator = validate =>\n  buildValidator([validateNotEmpty, validateEmail], validate);\n\nexport const buildEmailArrayValidator = () =>\n  buildValidator([validateUnique, buildArrayValidator(buildEmailValidator())]);\n\nexport const buildPsbtValidator = btcWallet => buildValidator([validatePsbt]);\n\n// the form validator is the composition of all of the field validators\n// plus an additional form validator function\nexport const composeValidator = (\n  fieldValidators = {},\n  // the default form validator just returns field-level validations\n  formValidator = (values, errors) => errors\n) => {\n  const names = Object.keys(fieldValidators);\n\n  const fieldLevelValidators = names.map(name => value =>\n    fieldValidators[name](value)\n  );\n\n  // async reduce errors per-field into an errors object\n  const fieldLevelValidator = values => {\n    const errorsOrPromises = names.map((name, i) =>\n      fieldLevelValidators[i](values[name])\n    );\n\n    const reduce = errors =>\n      names.reduce(\n        (memo, name, i) => ({\n          ...memo,\n          [name]: errors[i],\n        }),\n        {}\n      );\n\n    if (some(errorsOrPromises, isPromise)) {\n      // if any of these results are a promise, await them all then reduce\n      return Promise.all(errorsOrPromises).then(reduce);\n    }\n\n    // otherwise return immediately\n    return reduce(errorsOrPromises);\n  };\n\n  // the final-form `validate` function\n  // NOTE: if we return a Promise to final-form it will toggle the `validating`\n  // state, which is expected. If our promise resolves immediately, however,\n  // that means our `validating` state flickers the UI and it looks pretty bad.\n  // The solution is to conditionally return a promise only when necessary.\n  return values => {\n    // ask for field-level errors\n    const errorsOrPromise = fieldLevelValidator(values);\n\n    // pass the current values and their validity to the form-level validator\n    // that can implement conditional logic and more complex validations\n    const runFormValidator = errors => formValidator(values, errors);\n\n    if (isPromise(errorsOrPromise)) {\n      // if promise, promise\n      return errorsOrPromise.then(runFormValidator);\n    }\n\n    // otherwise, it's an errors object\n    return runFormValidator(errorsOrPromise);\n  };\n};\n","const CONTRACT_ADDRESSES = {\n  DEV: {\n    azimuth: '0x863d9c2e5c4c133596cfac29d55255f0d0f86381',\n    delegatedSending: '0xb71c0b6cee1bcae56dfe95cd9d3e41ddd7eafc43',\n    linearSR: '0x03C3dC12BE658158D1d7F9e66E08ec4099c568e4',\n    conditionalSR: '0x35EB3B102d9C1B69Ac1469C1B1FE1799850CD3EB',\n  },\n  ROPSTEN: {\n    azimuth: '0x308ab6a6024cf198b57e008d0ac9ad0219886579',\n    delegatedSending: '0x3e8ca510354bc2fdbbd6150252d93105c9c27bbe',\n    linearSR: '0x1f8edd031ee414740aedb39b84fb8f2f66ca422f',\n    conditionalSR: '0x1f8edd031ee414740aedb39b84fb8f2f66ca422f',\n  },\n  MAINNET: {\n    azimuth: '0x223c067f8cf28ae173ee5cafea60ca44c335fecb',\n    delegatedSending: '0xF7908Ab1F1e352F83c5ebc75051c0565AEaea5FB',\n    linearSR: '0x86cd9cd0992f04231751e3761de45cecea5d1801',\n    conditionalSR: '0x8c241098c3d3498fe1261421633fd57986d74aea',\n  },\n};\n\nexport { CONTRACT_ADDRESSES };\n","import React, {\n  createContext,\n  forwardRef,\n  useContext,\n  useState,\n  useEffect,\n} from 'react';\nimport { Just, Nothing } from 'folktale/maybe';\nimport * as azimuth from 'azimuth-js';\nimport Web3 from 'web3';\n\nimport { CONTRACT_ADDRESSES } from '../lib/contracts';\nimport { NETWORK_TYPES, chainIdToNetworkType } from '../lib/network';\nimport { isDevelopment } from '../lib/flags';\n\nimport { Grid } from 'indigo-react';\nimport View from 'components/View';\nimport Blinky from 'components/Blinky';\n\nfunction _useNetwork(initialNetworkType = null) {\n  const [networkType, setNetworkType] = useState(initialNetworkType);\n\n  const [metamask, setMetamask] = useState(false);\n  const [web3, setWeb3] = useState(Nothing());\n  const [contracts, setContracts] = useState(Nothing());\n\n  useEffect(() => {\n    (async () => {\n      if (window.ethereum) {\n        try {\n          setMetamask(true);\n          setNetworkType(chainIdToNetworkType(window.ethereum.chainId));\n        } catch (e) {\n          console.log('Metamask denied');\n        }\n      }\n    })();\n  }, []);\n\n  useEffect(() => {\n    (async () => {\n      // given a web3 provider and contract addresses,\n      // build the web3 and contracts objects\n      const initWeb3 = async (provider, contractAddresses) => {\n        // use an in-window eth provider if possible\n        const _provider = metamask ? window.ethereum : provider;\n        const web3 = new Web3(_provider);\n\n        let contracts = await azimuth.initContractsPartial(\n          web3,\n          contractAddresses.azimuth\n        );\n        contracts = azimuth.contracts.newLinearStarRelease(\n          contracts,\n          web3,\n          contractAddresses.linearSR\n        );\n        contracts = azimuth.contracts.newConditionalStarRelease(\n          contracts,\n          web3,\n          contractAddresses.conditionalSR\n        );\n        contracts = azimuth.contracts.newDelegatedSending(\n          contracts,\n          web3,\n          contractAddresses.delegatedSending\n        );\n\n        setWeb3(Just(web3));\n        setContracts(Just(contracts));\n        return;\n      };\n\n      switch (networkType) {\n        case NETWORK_TYPES.LOCAL: {\n          const protocol = isDevelopment ? 'ws' : 'wss';\n          const endpoint = `${protocol}://${document.location.hostname}:8545`;\n\n          initWeb3(\n            new Web3.providers.WebsocketProvider(endpoint),\n            CONTRACT_ADDRESSES.DEV\n          );\n          return;\n        }\n        case NETWORK_TYPES.ROPSTEN: {\n          const endpoint = `https://ropsten.infura.io/v3/${process.env.REACT_APP_INFURA_ENDPOINT}`;\n\n          initWeb3(\n            new Web3.providers.HttpProvider(endpoint),\n            CONTRACT_ADDRESSES.ROPSTEN\n          );\n          return;\n        }\n        case NETWORK_TYPES.MAINNET: {\n          const endpoint = `https://mainnet.infura.io/v3/${process.env.REACT_APP_INFURA_ENDPOINT}`;\n\n          initWeb3(\n            new Web3.providers.HttpProvider(endpoint),\n            CONTRACT_ADDRESSES.MAINNET\n          );\n          return;\n        }\n        case NETWORK_TYPES.OFFLINE:\n        default: {\n          // NB (jtobin):\n          //\n          // The 'offline' network type targets the mainnet contracts, but does\n          // not actually use a provider to connect.  We use a web3 instance to\n          // initalise the contracts, but the network itself is set to Nothing.\n          //\n          // We may want to offer the ability to select a target network for\n          // transactions when offline.\n\n          // Note: example.com:3456 doesn't actually point to anything, we just\n          // need a provider to initialize the Web3 object\n          initWeb3(\n            new Web3.providers.HttpProvider('http://example.com:3456'),\n            isDevelopment ? CONTRACT_ADDRESSES.DEV : CONTRACT_ADDRESSES.MAINNET\n          );\n          setWeb3(Nothing());\n          // ^ overwrite the web3 object from initWeb3 with a Nothing\n          // to indicate that there is no valid web3 connection\n          return;\n        }\n      }\n    })();\n  }, [networkType, metamask]);\n\n  return { networkType, setNetworkType, web3, contracts };\n}\n\nconst NetworkContext = createContext(null);\n\n// provider\nexport function NetworkProvider({ initialNetworkType, children }) {\n  const value = _useNetwork(initialNetworkType);\n\n  if (Just.hasInstance(value.contracts)) {\n    return (\n      <NetworkContext.Provider value={value}>\n        {children}\n      </NetworkContext.Provider>\n    );\n  } else {\n    return (\n      <View inset>\n        <Grid>\n          <Grid.Item full className=\"mt8 t-center\">\n            <Blinky /> Connecting...\n          </Grid.Item>\n        </Grid>\n      </View>\n    );\n  }\n}\n\n// hook consumer\nexport function useNetwork() {\n  return useContext(NetworkContext);\n}\n\n// hoc consumer\nexport const withNetwork = Component =>\n  forwardRef((props, ref) => {\n    return (\n      <NetworkContext.Consumer>\n        {value => <Component ref={ref} {...value} {...props} />}\n      </NetworkContext.Consumer>\n    );\n  });\n","import React, { createContext, forwardRef, useContext, useState } from 'react';\nimport { Nothing } from 'folktale/maybe';\n\nexport const PointCursorContext = createContext(null);\n\n// pointCursor is Maybe<number>\nfunction _usePointCursor(initialPointCursor = Nothing()) {\n  const [pointCursor, setPointCursor] = useState(initialPointCursor);\n\n  return {\n    pointCursor,\n    setPointCursor,\n  };\n}\n\nexport function PointCursorProvider({ initialPointCursor, children }) {\n  const pointCursor = _usePointCursor(initialPointCursor);\n\n  return (\n    <PointCursorContext.Provider value={pointCursor}>\n      {children}\n    </PointCursorContext.Provider>\n  );\n}\n\n// Hook version\nexport function usePointCursor() {\n  return useContext(PointCursorContext);\n}\n\n// HOC version\nexport const withPointCursor = Component =>\n  forwardRef((props, ref) => (\n    <PointCursorContext.Consumer>\n      {pointCursor => <Component ref={ref} {...pointCursor} {...props} />}\n    </PointCursorContext.Consumer>\n  ));\n","// NB(shrugs): if we get any more complicated with dates, add `luxon`\nexport const formatDots = date => {\n  const year = date.getFullYear();\n  const month = `${date.getMonth() + 1}`.padStart(2, 0);\n  const day = `${date.getDate()}`.padStart(2, 0);\n\n  return [year, month, day].join('.');\n};\n\nexport const formatTime = date => date.toLocaleTimeString();\n\nexport const formatDotsWithTime = date =>\n  `${formatDots(date)} ${formatTime(date)}`;\n","import Web3 from 'web3';\nimport { toHex } from 'web3-utils';\nimport { FakeSignableTx, FakeSignResult } from './txn';\n\nexport function MetamaskWallet(address) {\n  this.address = address;\n}\n\n// Cheat a bit and pretend to sign transaction\n// Sign it actually when sending\nexport const metamaskSignTransaction = async (\n  txn: FakeSignableTx,\n  from: string\n) => {\n  txn.from = from;\n  return FakeSignResult(txn, metamaskSendTransaction);\n};\n\nconst metamaskSendTransaction = async (txn: FakeSignableTx, web3: Web3) => {\n  const metamaskFormattedTxn = {\n    data: txn.data,\n    gasLimit: txn.gasLimit,\n    gasPrice: txn.gasPrice,\n    nonce: txn.nonce,\n    to: toHex(txn.to),\n    from: toHex(txn.from),\n  };\n\n  let txHash;\n  if (window.ethereum) {\n    //NOTE  see also #596, #630, #646\n    //      no idea what's going on, we should figure it out,\n    //      but we apply this bandaid to hopefully stop the bleeding.\n    //      at least it also helps with the NOTE of the other branch.\n    txHash = await window.ethereum.request({\n      method: 'eth_sendTransaction',\n      params: [metamaskFormattedTxn],\n      from: txn.from,\n    });\n  } else {\n    //NOTE  since this gives us a receipt instead of just the hash of the\n    //      signed tx, it makes us wait for confirmation outside of our own\n    //      waitForTransactionConfirm. because of this the progress bar loses\n    //      its progressiveness for metamask users.\n    let receipt = await await web3.eth.sendTransaction(metamaskFormattedTxn);\n    txHash = receipt.transactionHash;\n  }\n  return txHash;\n};\n","import { useCallback, useMemo, useState, useEffect } from 'react';\n\n// via: https://usehooks.com/useMedia/\n// NB(shrugs): we reverse the order because we want to be 'mobile first'\n// and therefore want the breakpoint that is the most \"specific\"\nexport default function useMedia(queries, values, defaultValue) {\n  const reverseValues = useMemo(() => values.reverse(), [values]);\n  const mediaQueryLists = useMemo(\n    () => queries.reverse().map(q => window.matchMedia(q)),\n    [queries]\n  );\n\n  const getValue = useCallback(() => {\n    const index = mediaQueryLists.findIndex(mql => mql.matches);\n\n    return typeof reverseValues[index] !== 'undefined'\n      ? reverseValues[index]\n      : defaultValue;\n  }, [mediaQueryLists, reverseValues, defaultValue]);\n\n  const [value, setValue] = useState(getValue);\n\n  useEffect(() => {\n    const handler = () => setValue(getValue);\n    mediaQueryLists.forEach(mql => mql.addListener(handler));\n\n    return () => mediaQueryLists.forEach(mql => mql.removeListener(handler));\n  }, [mediaQueryLists, getValue]);\n\n  return value;\n}\n","import React from 'react';\n\nimport { createContext, useContext } from 'react';\nimport useMedia from './useMedia';\n\n// sync with //indigo/indigo/css/src/lib/_breakpoints.scss\nconst BREAKPOINTS = [\n  '(min-width: 550px)', // ns\n  '(min-width: 750px)', // md\n  '(min-width: 960px)', // lg\n];\n\nexport const MediaQueryContext = createContext(null);\n// provide the index to consumers so they can easily index an array\nexport const MediaQueryProvider = ({ children }) => (\n  <MediaQueryContext.Provider value={useMedia(BREAKPOINTS, [0, 1, 2], 0)}>\n    {children}\n  </MediaQueryContext.Provider>\n);\n\n// Hook version\nexport function useMediaQuery() {\n  return useContext(MediaQueryContext);\n}\n","import { createContext, useContext } from 'react';\n\nexport const LocalRouterContext = createContext(null);\nexport const LocalRouterProvider = LocalRouterContext.Provider;\n\n// Hook version\nexport function useLocalRouter() {\n  return useContext(LocalRouterContext);\n}\n","import React, {\n  createContext,\n  forwardRef,\n  useCallback,\n  useContext,\n  useState,\n  useEffect,\n} from 'react';\nimport { Just, Nothing } from 'folktale/maybe';\nimport { includes } from 'lodash';\n\nimport { walletFromMnemonic } from 'lib/wallet';\nimport {\n  DEFAULT_HD_PATH,\n  NONCUSTODIAL_WALLETS,\n  WALLET_TYPES,\n} from 'lib/constants';\nimport { getAuthToken } from 'lib/authToken';\nimport { BRIDGE_ERROR } from 'lib/error';\n\nimport { useNetwork } from 'store/network';\nimport { publicToAddress } from 'lib/utils/address';\n\nexport const WalletContext = createContext(null);\n\nconst DEFAULT_WALLET_TYPE = WALLET_TYPES.TICKET;\n\n// NB (jtobin):\n//\n// Note that the 'wallet' prop has type depending on the 'walletType' prop.\n// These could be bound together in a single structure (so that\n// 'walletType' acted more explicitly as a data constructor of sorts) but\n// it doesn't necessarily help us much, since we branch on 'walletType'\n// before setting 'wallet'.\n//\n// Wallets are always wrapped in   For most authentication\n// mechanisms, Maybe wraps a BIP32 HD wallet; for Ethereum private keys,\n// JSON keystore files, and Metamask authentication, it wraps an\n// 'EthereumWallet'.\nfunction _useWallet(initialWallet = Nothing(), initialMnemonic = Nothing()) {\n  const [walletType, _setWalletType] = useState(() =>\n    initialMnemonic.matchWith({\n      Nothing: () => DEFAULT_WALLET_TYPE,\n      Just: () => WALLET_TYPES.MNEMONIC,\n    })\n  );\n  const [walletHdPath, setWalletHdPath] = useState(DEFAULT_HD_PATH);\n  const [wallet, _setWallet] = useState(initialWallet);\n  const [urbitWallet, _setUrbitWallet] = useState(Nothing());\n  const [authMnemonic, setAuthMnemonic] = useState(initialMnemonic);\n  const [networkSeed, setNetworkSeed] = useState(Nothing());\n  const [networkRevision, setNetworkRevision] = useState(Nothing());\n\n  const [authToken, setAuthToken] = useState(Nothing());\n\n  const { web3 } = useNetwork();\n\n  useEffect(() => {\n    (async () => {\n      if (\n        !Just.hasInstance(wallet) ||\n        !Just.hasInstance(web3) ||\n        NONCUSTODIAL_WALLETS.has(walletType)\n      ) {\n        return;\n      }\n\n      const _wallet = wallet.value;\n      const _web3 = web3.value;\n      const token = await getAuthToken({\n        wallet: _wallet,\n        walletType,\n        walletHdPath,\n        web3: _web3,\n      });\n\n      setAuthToken(Just(token));\n    })();\n  }, [wallet, walletType, walletHdPath, web3]);\n\n  const setWalletType = useCallback(\n    walletType => {\n      if (!includes(WALLET_TYPES, walletType)) {\n        throw new Error(BRIDGE_ERROR.INVALID_WALLET_TYPE);\n      }\n\n      _setWalletType(walletType);\n    },\n    [_setWalletType]\n  );\n\n  const setWallet = useCallback(\n    wallet => {\n      // force that public addresses are derived for each wallet\n      // NOTE wallet is Maybe<> and .map is Maybe#map\n      wallet.map(wal => {\n        wal.address = wal.address || publicToAddress(wal.publicKey);\n        return wal;\n      });\n\n      _setWallet(wallet);\n    },\n    [_setWallet]\n  );\n\n  const setUrbitWallet = useCallback(\n    urbitWallet => {\n      if (Just.hasInstance(urbitWallet)) {\n        // when an urbit wallet is set, also derive\n        // a normal bip32 wallet using the ownership address\n        const wallet = walletFromMnemonic(\n          urbitWallet.value.ownership.seed,\n          DEFAULT_HD_PATH,\n          urbitWallet.value.meta.passphrase\n        );\n\n        setWallet(wallet);\n      } else {\n        setWallet(Nothing());\n      }\n\n      _setUrbitWallet(urbitWallet);\n    },\n    [setWallet]\n  );\n\n  const resetWallet = useCallback(() => {\n    _setWalletType(DEFAULT_WALLET_TYPE);\n    setWalletHdPath(DEFAULT_HD_PATH);\n    _setWallet(Nothing());\n    _setUrbitWallet(Nothing());\n    setAuthMnemonic(Nothing());\n    setNetworkSeed(Nothing());\n    setNetworkRevision(Nothing());\n  }, [\n    _setWalletType,\n    setWalletHdPath,\n    _setWallet,\n    _setUrbitWallet,\n    setAuthMnemonic,\n    setNetworkSeed,\n    setNetworkRevision,\n  ]);\n\n  return {\n    //\n    walletType,\n    setWalletType,\n    //\n    walletHdPath,\n    setWalletHdPath,\n    //\n    wallet,\n    setWallet,\n    //\n    urbitWallet,\n    setUrbitWallet,\n    authMnemonic,\n    setAuthMnemonic,\n    //\n    networkSeed,\n    setNetworkSeed,\n    networkRevision,\n    setNetworkRevision,\n    //\n    resetWallet,\n    //\n    authToken,\n    setAuthToken,\n  };\n}\n\nexport function WalletProvider({ initialWallet, initialMnemonic, children }) {\n  const wallet = _useWallet(initialWallet, initialMnemonic);\n\n  return (\n    <WalletContext.Provider value={wallet}>{children}</WalletContext.Provider>\n  );\n}\n\n// Hook version\nexport function useWallet() {\n  return useContext(WalletContext);\n}\n\n// HOC version\nexport const withWallet = Component =>\n  forwardRef((props, ref) => (\n    <WalletContext.Consumer>\n      {wallet => <Component ref={ref} {...wallet} {...props} />}\n    </WalletContext.Consumer>\n  ));\n","import React from 'react';\nimport { Button } from 'indigo-react';\nimport { Icon } from '@tlon/indigo-react';\n\nimport { blinkIf } from './Blinky';\n\n// NOTE: the -> is correct because inter recognizes the pair\nexport const ForwardButton = ({ loading, ...props }) => (\n  <Button accessory={blinkIf(loading, '->')} {...props} />\n);\nexport const DownloadButton = ({ loading, ...props }) => (\n  <Button accessory={blinkIf(loading, '↓')} {...props} />\n);\nexport const RestartButton = props => <Button accessory=\"↺\" {...props} />;\nexport const GenerateButton = ({ loading, ...props }) => (\n  <Button accessory={blinkIf(loading, '○')} solid {...props} />\n);\nexport const OutButton = props => (\n  <Button as=\"a\" target=\"_blank\" accessory=\"↗\" {...props} />\n);\n\nexport const OfflineButton = props => (\n  <OutButton {...props} href=\"https://github.com/urbit/bridge/releases\">\n    Offline\n  </OutButton>\n);\n\nexport const CopyButton = props => (\n  <Button\n    accessory={<Icon icon=\"Copy\" size=\"18px\" color={'black'} />}\n    {...props}\n  />\n);\n","import { useEffect } from 'react';\nimport { useForm } from 'react-final-form';\n\n/**\n * ValuesHandler notifies callback function when form values change.\n */\nexport default function ValuesHandler({ valid, validating, values, onValues }) {\n  const form = useForm();\n  const validationPaused = form.isValidationPaused();\n\n  useEffect(() => {\n    if (!validating && !validationPaused) {\n      onValues && onValues({ valid, values, form });\n    }\n  }, [form, onValues, valid, validating, validationPaused, values]);\n\n  return null;\n}\n","import { useEffect } from 'react';\nimport { useForm } from 'react-final-form';\n\n/**\n * pauses validation when it becomes unmounted\n *\n * NOTE: this is useful because for some reason, final-form will\n * re-run validation when a field is unregistered (even post submission !?),\n * which react-final-form does on unmount. So when we redirect away from\n * a page with a form on it, all of the validation is re-triggered.\n *\n * Normally, for boring sync-validation-only situations, this is ok, but for\n * long-running validators like ours (deriving seeds, checking chain, etc)\n * having them re-triggered when a form leaves the page is hilariously bad.\n *\n * So here we disable validation when unmounting, saving ourselves\n * from the footgun.\n *\n * see: https://github.com/final-form/react-final-form/issues/408\n */\nexport default function ValidationPauser() {\n  const form = useForm();\n\n  useEffect(() => () => form.pauseValidation(), [form]);\n\n  return null;\n}\n","import React, { useCallback } from 'react';\nimport { Form } from 'react-final-form';\nimport arrayMutators from 'final-form-arrays';\nimport { noop } from 'lodash';\n\nimport ValuesHandler from './ValuesHandler';\nimport ValidationPauser from './ValidationPauser';\n\n/**\n * BridgeForm adds nice-to-haves for every form in bridge.\n * + afterSubmit callback for redirects\n * + default onSubmit to noop so react-final-form doesn't throw\n * + pauses validation when the form is unmounted\n * + `onValues` handler for reactive changes\n * + automatically includes array and field data mutators\n */\nexport default function BridgeForm({\n  children,\n  onValues,\n  onSubmit = noop,\n  afterSubmit = noop,\n  ...rest\n}) {\n  const _onSubmit = useCallback(\n    async (...args) => {\n      const errors = await onSubmit(...args);\n      if (errors) {\n        return errors;\n      }\n\n      afterSubmit();\n    },\n    [afterSubmit, onSubmit]\n  );\n\n  return (\n    <Form mutators={{ ...arrayMutators }} onSubmit={_onSubmit} {...rest}>\n      {formProps => (\n        <form style={{ display: 'contents' }} onSubmit={formProps.handleSubmit}>\n          <ValidationPauser />\n          {children(formProps)}\n          {onValues && <ValuesHandler {...formProps} onValues={onValues} />}\n        </form>\n      )}\n    </Form>\n  );\n}\n","import { reduce } from 'lodash';\nimport { isAddress, keccak256 } from 'web3-utils';\nimport { pubToAddress } from 'ethereumjs-util';\nimport { ETH_ZERO_ADDR, ETH_ZERO_ADDR_SHORT } from 'lib/constants';\n\nexport const stripHexPrefix = (hex: string) => {\n  return hex.startsWith('0x') ? hex.slice(2) : hex;\n};\n\nexport const addHexPrefix = (hex: string) => {\n  return hex.startsWith('0x') ? hex : `0x${hex}`;\n};\n\nexport const isValidAddress = a => '0x0' === a || isAddress(a);\n\nexport const abbreviateAddress = address =>\n  `${address.slice(0, 6)}…${address.slice(-4)}`;\n\nexport const isZeroAddress = a =>\n  a === ETH_ZERO_ADDR || a === ETH_ZERO_ADDR_SHORT;\n\nexport const toChecksumAddress = address => {\n  const addr = stripHexPrefix(address).toLowerCase();\n  const hash = keccak256(addr).toString('hex');\n\n  return reduce(\n    addr,\n    (acc, char, idx) =>\n      parseInt(hash[idx], 16) >= 8 ? acc + char.toUpperCase() : acc + char,\n    '0x'\n  );\n};\n\nexport const eqAddr = (addr0, addr1) =>\n  toChecksumAddress(addr0) === toChecksumAddress(addr1);\n\nexport const publicToAddress = (publicKey: Buffer): string => {\n  return '0x' + pubToAddress(Buffer.from(publicKey), true).toString('hex');\n};\n","import React, { useEffect, useState } from 'react';\nimport { Just } from 'folktale/maybe';\n\nimport MaybeSigil from './MaybeSigil';\n\nconst selectColorway = (valid, error, active) => {\n  if (valid) {\n    return ['#2AA779', '#FFFFFF'];\n  }\n\n  if (active) {\n    return ['#4330FC', '#FFFFFF'];\n  }\n\n  if (error) {\n    return ['#F8C134', '#FFFFFF'];\n  }\n\n  return ['#7F7F7F', '#FFFFFF'];\n};\n\nexport default function InputSigil({\n  className,\n  patp,\n  size,\n  valid,\n  error,\n  active,\n  ...rest\n}) {\n  const [lastValidPatp, setLastValidPatp] = useState(patp);\n\n  useEffect(() => {\n    if (valid) {\n      setLastValidPatp(patp);\n    }\n  }, [patp, valid]);\n\n  return (\n    <MaybeSigil\n      patp={Just(lastValidPatp)}\n      size={size}\n      colors={selectColorway(valid, error, active)}\n      {...rest}\n    />\n  );\n}\n","import React from 'react';\nimport { Input, AccessoryIcon } from 'indigo-react';\nimport { useField } from 'react-final-form';\n\nimport {\n  convertToNumber,\n  buildFormatter,\n  downcase,\n  ensurePatFormat,\n  stripHexPrefix,\n  ensureHexPrefix,\n} from 'form/formatters';\nimport { DEFAULT_HD_PATH } from 'lib/constants';\nimport InputSigil from 'components/InputSigil';\n\nconst PLACEHOLDER_POINT = '~sampel-ponnym';\nconst PLACEHOLDER_HD_PATH = DEFAULT_HD_PATH;\nconst PLACEHOLDER_MNEMONIC =\n  'example crew supreme gesture quantum web media hazard theory mercy wing kitten';\nconst PLACEHOLDER_TICKET = '~sampel-ticlyt-migfun-falmel';\nconst PLACEHOLDER_PASSWORD = '••••••-••••••-••••••-••••••';\nconst PLACEHOLDER_ADDRESS = '0x';\nconst PLACEHOLDER_HEX = '0x';\nconst PLACEHOLDER_PRIVATE_KEY =\n  'a44de2416ee6beb2f323fab48b432925c9785808d33a6ca6d7ba00b45e9370c3';\nconst PLACEHOLDER_EMAIL = 'email@example.com';\n\nconst formatPat = buildFormatter([downcase, ensurePatFormat]);\n\nexport function TicketInput({ name, hidden, ...rest }) {\n  const {\n    meta: { valid, error, validating, touched, active },\n  } = useField(name, {\n    subscription: {\n      valid: true,\n      error: true,\n      validating: true,\n      touched: true,\n      active: true,\n    },\n  });\n\n  return (\n    <Input\n      type={hidden ? 'password' : 'text'}\n      name={name}\n      obscure={value => value.replace(/[^~-]+/g, '••••••')}\n      placeholder={hidden ? PLACEHOLDER_PASSWORD : PLACEHOLDER_TICKET}\n      autoCapitalize=\"none\"\n      autoCorrect=\"off\"\n      accessory={\n        touched && !active && error ? (\n          <AccessoryIcon.Failure />\n        ) : validating ? (\n          <AccessoryIcon.Pending />\n        ) : valid ? (\n          <AccessoryIcon.Success />\n        ) : null\n      }\n      config={{ parse: formatPat }}\n      mono\n      {...rest}\n    />\n  );\n}\n\nexport function MnemonicInput({ ...rest }) {\n  return (\n    <Input\n      type=\"textarea\"\n      placeholder={PLACEHOLDER_MNEMONIC}\n      autoCapitalize=\"none\"\n      autoComplete=\"off\"\n      mono\n      {...rest}\n    />\n  );\n}\n\nexport function HdPathInput({ ...rest }) {\n  return (\n    <Input\n      type=\"text\"\n      placeholder={PLACEHOLDER_HD_PATH}\n      autoCapitalize=\"none\"\n      autoComplete=\"off\"\n      autoCorrect=\"off\"\n      {...rest}\n    />\n  );\n}\n\nexport function PassphraseInput({ ...rest }) {\n  return (\n    <Input\n      type=\"password\"\n      placeholder=\"Passphrase\"\n      autoCapitalize=\"none\"\n      autoCorrect=\"off\"\n      {...rest}\n    />\n  );\n}\n\nexport function PointInput({ name, size = 4, ...rest }) {\n  const {\n    input: { value },\n    meta: { active, valid, error },\n  } = useField(name, {\n    subscription: { value: true, active: true, valid: true, error: true },\n  });\n\n  return (\n    <Input\n      type=\"text\"\n      label=\"Urbit ID\"\n      name={name}\n      placeholder={PLACEHOLDER_POINT}\n      autoCapitalize=\"none\"\n      autoComplete=\"off\"\n      autoCorrect=\"off\"\n      accessory={\n        value ? (\n          <InputSigil\n            patp={value}\n            size={44}\n            valid={valid}\n            error={error}\n            active={active}\n          />\n        ) : null\n      }\n      config={{ parse: formatPat }}\n      mono\n      {...rest}\n    />\n  );\n}\n\nexport function HexInput({ ...rest }) {\n  return (\n    <Input\n      type=\"text\"\n      placeholder={PLACEHOLDER_HEX}\n      autoCapitalize=\"none\"\n      autoComplete=\"off\"\n      autoCorrect=\"off\"\n      mono\n      config={{ parse: ensureHexPrefix }}\n      {...rest}\n    />\n  );\n}\n\nexport function PrivateKeyInput({ ...rest }) {\n  return (\n    <HexInput\n      type=\"password\"\n      placeholder={PLACEHOLDER_PRIVATE_KEY}\n      config={{ parse: stripHexPrefix }}\n      {...rest}\n    />\n  );\n}\n\nexport function PsbtInput({ ...rest }) {\n  return (\n    <HexInput\n      type=\"text\"\n      placeholder=\"\"\n      config={{ parse: stripHexPrefix }}\n      {...rest}\n    />\n  );\n}\n\nexport function AddressInput({ ...rest }) {\n  return (\n    <Input\n      type=\"text\"\n      placeholder={PLACEHOLDER_ADDRESS}\n      autoCapitalize=\"none\"\n      autoCorrect=\"off\"\n      mono\n      {...rest}\n    />\n  );\n}\n\nexport function NumberInput({ ...rest }) {\n  return (\n    <Input\n      type=\"number\"\n      label=\"Number\"\n      config={{ format: convertToNumber }}\n      {...rest}\n    />\n  );\n}\n\nexport function EmailInput({ ...rest }) {\n  return (\n    <Input\n      type=\"email\"\n      placeholder={PLACEHOLDER_EMAIL}\n      autoCapitalize=\"none\"\n      {...rest}\n    />\n  );\n}\n","import React from 'react';\nimport cn from 'classnames';\nimport { IconButton } from 'indigo-react';\n\nexport const MiniBackButton = ({ className, isExit = false, ...rest }) => {\n  return (\n    <IconButton className={cn('black', className)} {...rest}>\n      {'<-'}\n    </IconButton>\n  );\n};\n","import React, { useCallback } from 'react';\nimport cn from 'classnames';\nimport { Flex } from 'indigo-react';\n\nimport Footer from './Footer';\nimport useBreakpoints from 'lib/useBreakpoints';\nimport { MiniBackButton } from './MiniBackButton';\nimport { useHistory } from 'store/history';\nimport NavHeader from './NavHeader';\n\n// View is a top-level component that all Views must render to inherit styling\nfunction View({\n  className,\n  children,\n  inset = false,\n  full = false,\n  hideBack = false,\n  pop,\n  ...rest\n}) {\n  const { reset } = useHistory();\n  const isMobile = useBreakpoints([true, false, false]);\n  const shouldInset = inset && !isMobile;\n\n  const insetPadding = cn({\n    pt7: shouldInset,\n    pt5: !shouldInset,\n  });\n\n  const goBack = useCallback(() => pop(), [pop]);\n\n  const goLogout = reset;\n\n  const showBackButton = !!pop;\n\n  const Header = useCallback(\n    ({ logout }) => {\n      return showBackButton ? (\n        <Flex.Item\n          as={Flex}\n          className={cn(\n            insetPadding,\n            'flex-row-r justify-between pb5 align-center'\n          )}>\n          <Flex.Item\n            onClick={goLogout}\n            as=\"a\"\n            className=\"f5 gray4 underline mr2 pointer\">\n            Logout\n          </Flex.Item>\n          <Flex.Item as={NavHeader.Target} />\n        </Flex.Item>\n      ) : (\n        <Flex.Item className={insetPadding} as={NavHeader.Target} />\n      );\n    },\n    [goLogout, insetPadding, showBackButton]\n  );\n\n  return (\n    <Flex\n      row={!isMobile}\n      col={isMobile}\n      justify=\"between\"\n      className={cn(\n        'minh-100 ph5',\n        {\n          mw1: !full,\n          'mw2 ph9-md ph10-lg': full,\n        },\n        className\n      )}\n      {...rest}>\n      <Flex.Item\n        as={Flex}\n        col\n        style={{ width: '48px' }}\n        className={cn(insetPadding)}>\n        {showBackButton && !hideBack && (\n          <MiniBackButton\n            hpadding={!isMobile}\n            vpadding={isMobile}\n            onClick={goBack}\n            className=\"mt1\"\n          />\n        )}\n      </Flex.Item>\n\n      <Flex.Item flex={1} as={Flex} col justify=\"between\">\n        <Flex.Item className=\"pb5 \">\n          <Header logout={goBack} />\n          {children}\n        </Flex.Item>\n        <Flex.Item as={Footer.Target} />\n      </Flex.Item>\n\n      <Flex.Item style={{ width: '48px' }} />\n    </Flex>\n  );\n}\n\n// View.Full is sugar for <View full /> to help with readability\nView.Full = function FullView(props) {\n  return <View full {...props} />;\n};\n\nexport default View;\n","import React from 'react';\nimport { useFormState } from 'react-final-form';\nimport { ErrorText } from 'indigo-react';\n\nimport { WARNING } from './helpers';\n\nexport default function FormError(props) {\n  const {\n    submitError,\n    submitErrors,\n    error: validationError,\n    dirtySinceLastSubmit,\n  } = useFormState({\n    subscription: {\n      submitError: true,\n      submitErrors: true,\n      error: true,\n      dirtySinceLastSubmit: true,\n    },\n  });\n\n  const showValidationError = !!validationError;\n\n  const showSubmitError = !!submitError && !dirtySinceLastSubmit;\n\n  const warning = submitErrors && submitErrors[WARNING];\n  const showWarning = !!warning && !dirtySinceLastSubmit;\n\n  return showSubmitError || showValidationError || showWarning ? (\n    <ErrorText {...props}>\n      {submitError || validationError || warning}\n    </ErrorText>\n  ) : null;\n}\n","import * as bip39 from 'bip39';\nimport * as bitcoin from 'bitcoinjs-lib';\nimport ob from 'urbit-ob';\nimport { includes } from 'lodash';\n\nimport { isValidAddress } from './utils/address';\nimport { patp2dec } from './patp2dec';\nimport { patpStringLength } from './lib';\nimport {\n  ETH_ZERO_ADDR,\n  ETH_ZERO_ADDR_SHORT,\n  MIN_GALAXY,\n  MAX_GALAXY,\n} from './constants';\n\n// NOTE: do not use the /g modifier for these regexes\n// https://stackoverflow.com/a/21373261\n// https://stackoverflow.com/a/1520853\n\n// via: https://emailregex.com/\nconst emailRegExp = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\n// validate only strings that use hex characters\nconst isHexString = /[0-9A-Fa-f]/;\n\n// validate only strings that are prefixed with 0x\nconst isHexPrefixed = /^0x/;\n\n// Validates a bip39 mnemonic\nexport const validateMnemonic = v =>\n  !bip39.validateMnemonic(v) && 'This is not a valid mnemonic.';\n\nconst isHdPath = /^m(\\/[0-9]+'?)*$/;\nexport const validateHdPath = v =>\n  !isHdPath.test(v) && 'Invalid HD derivation path.';\n\n// Checks an empty field\nexport const validateNotEmpty = v =>\n  (v === undefined || v.length === 0) && 'This field is required.';\n\n// Checks if a patp is a valid galaxy\nexport const validateGalaxy = v => {\n  try {\n    const point = patp2dec(v);\n    const isValidGalaxy = point >= MIN_GALAXY && point <= MAX_GALAXY;\n    if (!isValidGalaxy) {\n      throw new Error();\n    }\n  } catch {\n    return 'This is not a valid galaxy.';\n  }\n};\n\nexport const validatePoint = v => {\n  try {\n    if (!ob.isValidPatp(v)) {\n      throw new Error();\n    }\n  } catch {\n    return 'This is not a valid point.';\n  }\n};\n\nexport const validatePatq = v => {\n  try {\n    if (!ob.isValidPatq(v)) {\n      throw new Error();\n    }\n  } catch {\n    return 'This is not a valid ticket.';\n  }\n};\n\nexport const validateShard = v => {\n  try {\n    if (v !== undefined && v !== '' && !ob.isValidPatq(v)) {\n      throw new Error();\n    }\n  } catch {\n    return 'This is not a valid shard.';\n  }\n};\n\nexport const validateOneOf = (options = []) => v =>\n  !includes(options, v) && 'Is not a valid option.';\n\nexport const validateHexString = v =>\n  !isHexString.test(v) && 'This is not a valid hex string.';\n\nexport const validateHexPrefix = v =>\n  !isHexPrefixed.test(v) && 'Must include 0x prefix.';\n\nexport const validateEthereumAddress = v =>\n  !isValidAddress(v) && 'This is not a valid Ethereum address.';\n\nexport const validateEmail = v =>\n  !emailRegExp.test(v) && 'This is not a valid email address.';\n\nexport const validateExactly = (value, error) => v => v !== value && error;\n\nexport const validateNotAny = (values = []) => v =>\n  values.includes(v) && `Cannot be ${v}.`;\n\nexport const validateLength = l => v =>\n  v.length !== l && `Must be exactly ${l} characters.`;\n\nexport const validateHexLength = l => v =>\n  v.length !== l + 2 && `Must be exactly ${l} hex characters.`;\n\nexport const validateMaximumLength = l => v =>\n  v.length > l && `Must be ${l} characters or fewer.`;\n\nexport const validateMinimumLength = l => v =>\n  v.length < l && `Must be ${l} characters or more.`;\n\nexport const validateGreaterThan = l => v =>\n  !(v > l) && `Must be greater than ${l}.`;\n\nexport const validateLessThan = l => v => !(v < l) && `Must be less than ${l}`;\n\nexport const validateInSet = (set, error) => v => !set.has(v) && error;\n\nexport const validateMaximumPatpByteLength = byteLength =>\n  validateMaximumLength(patpStringLength(byteLength));\n\nexport const validateMinimumPatpByteLength = byteLength =>\n  validateMinimumLength(patpStringLength(byteLength));\n\nexport const validateNotNullAddress = validateNotAny([\n  ETH_ZERO_ADDR,\n  ETH_ZERO_ADDR_SHORT,\n]);\n\nexport const validateUnique = arr => {\n  const res = [...new Set(arr)].length !== arr.length && 'Must be unique';\n  return res;\n};\n\nexport const validateChild = ourShip => ship =>\n  ourShip !== ob.sein(ship) && `This point is not a child of ${ourShip}.`;\n\nexport const validatePsbt = base64 => {\n  try {\n    bitcoin.Psbt.fromBase64(base64);\n  } catch (e) {\n    return 'Invalid Partially Signed Bitcoin Transaction';\n  }\n};\n","import { isNaN } from 'lodash';\n\n/**\n * a version of parseInt that throws for NaN\n * fun fact, parseInt also handles 0x-prefixed hex strings, assuming the radix\n * to be 16\n *\n * @throws\n * @returns {number}\n */\nexport const convertToInt = (num, radix) => {\n  const res = parseInt(num, radix);\n  if (isNaN(res)) {\n    throw new Error('NaN');\n  }\n  return res;\n};\n","import React, { useCallback, useMemo } from 'react';\nimport { Just, Nothing } from 'folktale/maybe';\nimport { Grid } from 'indigo-react';\n\nimport { useWallet } from 'store/wallet';\n\nimport { EthereumWallet } from 'lib/wallet';\nimport { stripHexPrefix } from 'lib/utils/address';\nimport { WALLET_TYPES } from 'lib/constants';\nimport useLoginView from 'lib/useLoginView';\n\nimport FormError from 'form/FormError';\nimport BridgeForm from 'form/BridgeForm';\nimport { PrivateKeyInput } from 'form/Inputs';\nimport { composeValidator, buildPrivateKeyValidator } from 'form/validators';\n\nimport SubmitButton from 'form/SubmitButton';\n\nexport default function PrivateKey({ className, goHome }) {\n  useLoginView(WALLET_TYPES.PRIVATE_KEY);\n\n  const { setWallet } = useWallet();\n\n  const validate = useMemo(\n    () =>\n      composeValidator({\n        privateKey: buildPrivateKeyValidator(64),\n      }),\n    []\n  );\n\n  const onValues = useCallback(\n    ({ valid, values }) => {\n      if (valid) {\n        const sec = Buffer.from(stripHexPrefix(values.privateKey), 'hex');\n        const newWallet = new EthereumWallet(sec);\n        setWallet(Just(newWallet));\n      } else {\n        setWallet(Nothing());\n      }\n    },\n    [setWallet]\n  );\n\n  return (\n    <Grid className={className}>\n      <BridgeForm validate={validate} onValues={onValues} afterSubmit={goHome}>\n        {({ handleSubmit }) => (\n          <>\n            <Grid.Item\n              full\n              as={PrivateKeyInput}\n              name=\"privateKey\"\n              label=\"Private key\"\n            />\n            <Grid.Item full as={FormError} />\n            <Grid.Item full as={SubmitButton} handleSubmit={handleSubmit}>\n              Login\n            </Grid.Item>\n          </>\n        )}\n      </BridgeForm>\n    </Grid>\n  );\n}\n","import React, { useCallback, useMemo } from 'react';\nimport cn from 'classnames';\nimport { Just } from 'folktale/maybe';\nimport { P, Text, Grid, H5, CheckboxInput, SelectInput } from 'indigo-react';\nimport { times } from 'lodash';\nimport { bip32 } from 'bitcoinjs-lib';\nimport Transport from '@ledgerhq/hw-transport-u2f';\nimport Eth from '@ledgerhq/hw-app-eth';\nimport { publicKeyConvert } from 'secp256k1';\n\nimport { useWallet } from 'store/wallet';\n\nimport {\n  LEDGER_LIVE_PATH,\n  LEDGER_LEGACY_PATH,\n  chopHdPrefix,\n  addHdPrefix,\n} from 'lib/ledger';\nimport { WALLET_TYPES } from 'lib/constants';\nimport useLoginView from 'lib/useLoginView';\nimport useBreakpoints from 'lib/useBreakpoints';\n\nimport {\n  composeValidator,\n  buildCheckboxValidator,\n  buildHdPathValidator,\n  buildSelectValidator,\n} from 'form/validators';\nimport BridgeForm from 'form/BridgeForm';\nimport FormError from 'form/FormError';\nimport SubmitButton from 'form/SubmitButton';\nimport Condition from 'form/Condition';\nimport { FORM_ERROR } from 'final-form';\nimport { HdPathInput } from 'form/Inputs';\nimport { getAuthToken } from 'lib/authToken';\n\nconst PATH_OPTIONS = [\n  { text: 'Ledger Live', value: LEDGER_LIVE_PATH },\n  { text: 'Ledger Legacy', value: LEDGER_LEGACY_PATH },\n];\n\nconst ACCOUNT_OPTIONS = times(20, i => ({\n  text: `Account #${i + 1}`,\n  value: i,\n}));\n\nexport default function Ledger({ className, goHome }) {\n  useLoginView(WALLET_TYPES.LEDGER);\n\n  const { setWallet, setWalletHdPath, setAuthToken } = useWallet();\n\n  const validate = useMemo(\n    () =>\n      composeValidator({\n        useCustomPath: buildCheckboxValidator(),\n        derivationpath: buildSelectValidator(PATH_OPTIONS),\n        account: buildSelectValidator(ACCOUNT_OPTIONS),\n        hdpath: buildHdPathValidator(),\n      }),\n    []\n  );\n\n  const onSubmit = useCallback(\n    async values => {\n      const transport = await Transport.create();\n      const eth = new Eth(transport);\n      const path = chopHdPrefix(values.hdpath);\n\n      try {\n        const info = await eth.getAddress(path, false, true);\n        const publicKey = Buffer.from(info.publicKey, 'hex');\n        const chainCode = Buffer.from(info.chainCode!.toString(), 'hex');\n        const pub = Buffer.from(publicKeyConvert(publicKey, true));\n        const hd = bip32.fromPublicKey(pub, chainCode);\n        const authToken = await getAuthToken({\n          wallet: hd,\n          walletType: WALLET_TYPES.LEDGER,\n          walletHdPath: addHdPrefix(values.hdpath),\n        });\n\n        setAuthToken(Just(authToken));\n        setWallet(Just(hd));\n        setWalletHdPath(addHdPrefix(values.hdpath));\n      } catch (error) {\n        console.error(error);\n        return { [FORM_ERROR]: error.message };\n      }\n    },\n    [setAuthToken, setWallet, setWalletHdPath]\n  );\n\n  const onValues = useCallback(({ valid, values, form }) => {\n    if (!valid) {\n      return;\n    }\n\n    // when the base path pattern or the account index changes\n    // update the hd path in our input\n    if (!values.useCustomPath) {\n      form.change(\n        'hdpath',\n        values.derivationpath.replace(/x/g, values.account)\n      );\n    }\n  }, []);\n\n  const initialValues = useMemo(\n    () => ({\n      useCustomPath: false,\n      hdpath: PATH_OPTIONS[0].value.replace(/x/g, ACCOUNT_OPTIONS[0].value),\n      derivationpath: PATH_OPTIONS[0].value,\n      account: ACCOUNT_OPTIONS[0].value,\n    }),\n    []\n  );\n\n  const full = useBreakpoints([true, true, false]);\n  const half = useBreakpoints([false, false, true]);\n  const isHTTPS = document.location.protocol === 'https:';\n\n  // when not on https, tell user how to get there\n  const renderHTTP = () => (\n    <>\n      <Grid.Item full as={H5}>\n        Running on HTTP?\n      </Grid.Item>\n\n      <Grid.Item full as={P}>\n        To authenticate and sign transactions with a Ledger, Bridge must be\n        serving over HTTPS on localhost. You can do this via the following:\n      </Grid.Item>\n\n      <Grid.Item full as=\"ol\">\n        <li>\n          Install{' '}\n          <a\n            target=\"_blank\"\n            href=\"https://github.com/FiloSottile/mkcert\"\n            rel=\"noopener noreferrer\">\n            mkcert\n          </a>\n        </li>\n        <li className=\"mt3\">\n          Install a local certificate authority via <code>mkcert -install</code>\n        </li>\n        <li className=\"mt3\">\n          In your <code>bridge</code> directory, generate a certificate valid\n          for localhost via <code>mkcert localhost</code>. This will produce two\n          files: <code>localhost.pem</code>, the local certificate, and\n          <code>localhost-key.pem</code> , its corresponding private key.\n        </li>\n        <li className=\"mt3\">\n          Run <code>python bridge-https.py</code>\n        </li>\n        <li className=\"mt3\">Return to this page.</li>\n      </Grid.Item>\n    </>\n  );\n\n  const renderHTTPS = () => (\n    <>\n      <Grid.Item full as={Text} className=\"f6 gray4 mb3\">\n        Connect and authenticate to your Ledger, and then open the \"Ethereum\"\n        application. If you're running on older firmware, make sure the \"browser\n        support\" option is turned on. To sign transactions, you'll also need to\n        enable the \"contract data\" option. You will be prompted to sign a\n        message. This allows Bridge to operate correctly. Never sign this\n        message outside of Bridge.\n      </Grid.Item>\n\n      <Grid.Item full as={Text} className=\"f6 gray4 mb3\">\n        Connecting a Ledger directly is no longer supported in Chrome-based\n        browsers. To log in to Bridge with a Ledger, either use Firefox, add\n        your Ledger to Metamask, or connect through another kind of wallet.\n      </Grid.Item>\n\n      <BridgeForm\n        validate={validate}\n        onValues={onValues}\n        onSubmit={onSubmit}\n        afterSubmit={goHome}\n        initialValues={initialValues}>\n        {({ handleSubmit, submitting }) => (\n          <>\n            <Condition when=\"useCustomPath\" is={true}>\n              <Grid.Item full as={HdPathInput} name=\"hdpath\" label=\"HD Path\" />\n            </Condition>\n\n            <Condition when=\"useCustomPath\" is={false}>\n              <Grid.Item\n                full={full}\n                half={half && 1}\n                as={SelectInput}\n                className={cn({ pr1: half })}\n                name=\"derivationpath\"\n                label=\"Derivation Path\"\n                placeholder=\"Choose path pattern...\"\n                options={PATH_OPTIONS}\n              />\n\n              <Grid.Item\n                full={full}\n                half={half && 2}\n                as={SelectInput}\n                className={cn({ pl1: half })}\n                name=\"account\"\n                label=\"Account\"\n                placeholder=\"Choose account...\"\n                options={ACCOUNT_OPTIONS}\n              />\n            </Condition>\n\n            <Grid.Item\n              full\n              as={CheckboxInput}\n              className=\"mv3\"\n              name=\"useCustomPath\"\n              label=\"Custom HD Path\"\n            />\n\n            <Grid.Item full as={FormError} />\n\n            <Grid.Item full as={SubmitButton} handleSubmit={handleSubmit}>\n              {!submitting && 'Authenticate'}\n              {submitting && 'Please check your device'}\n            </Grid.Item>\n          </>\n        )}\n      </BridgeForm>\n    </>\n  );\n\n  return (\n    <Grid className={className}>{isHTTPS ? renderHTTPS() : renderHTTP()}</Grid>\n  );\n}\n","import { ITxData } from '@walletconnect/types';\nimport { Transaction } from '@ethereumjs/tx';\nimport { stripHexPrefix } from './utils/address';\nimport { FakeSignableTx, FakeSignResult } from './txn';\nimport Web3 from 'web3';\n\ntype SignWalletConnectTransactionArgs = {\n  from: string;\n  txn: Transaction;\n  txnSigner: (txn: ITxData) => Promise<string>;\n  txnSender: (txn: FakeSignableTx) => Promise<string>;\n};\n\nconst walletConnectSignTransaction = async ({\n  from,\n  txn,\n  txnSigner,\n  txnSender,\n}: SignWalletConnectTransactionArgs) => {\n  // TS compiler complains next line about missing from and gas, which we set on the following lines\n  let wcFormattedTx: FakeSignableTx = txn.toJSON();\n  wcFormattedTx.from = from;\n  wcFormattedTx.gas = wcFormattedTx.gasLimit;\n\n  let signature;\n  try {\n    signature = await txnSigner(wcFormattedTx);\n  } catch (e) {\n    if (e.message === 'METHOD_NOT_SUPPORTED') {\n      console.log('connected wc wallet does not support tx signing.');\n      return FakeSignResult(\n        wcFormattedTx,\n        walletConnectSendTransaction(txnSender)\n      );\n    } else {\n      throw e;\n    }\n  }\n  const serializedTx = Buffer.from(stripHexPrefix(signature), 'hex');\n  const signedTx = Transaction.fromSerializedTx(serializedTx);\n\n  return signedTx;\n};\n\nconst walletConnectSendTransaction = (\n  txnSender: (tx: FakeSignableTx) => Promise<string>\n) => (txn: FakeSignableTx, _web3: Web3): Promise<string> => txnSender(txn);\n\nexport { walletConnectSignTransaction };\n","import React, { useCallback, useMemo } from 'react';\nimport { Just } from 'folktale/maybe';\nimport { bip32 } from 'bitcoinjs-lib';\nimport { publicKeyConvert } from 'secp256k1';\nimport { times } from 'lodash';\nimport TrezorConnect, { HDNodeResponse } from 'trezor-connect';\nimport { Text, Grid, CheckboxInput, SelectInput } from 'indigo-react';\n\nimport { useWallet } from 'store/wallet';\n\nimport { TREZOR_PATH } from 'lib/trezor';\nimport { WALLET_TYPES } from 'lib/constants';\nimport useLoginView from 'lib/useLoginView';\nimport { getAuthToken } from 'lib/authToken';\n\nimport {\n  composeValidator,\n  buildCheckboxValidator,\n  buildSelectValidator,\n  buildHdPathValidator,\n} from 'form/validators';\nimport BridgeForm from 'form/BridgeForm';\nimport Condition from 'form/Condition';\nimport FormError from 'form/FormError';\n\nimport SubmitButton from 'form/SubmitButton';\nimport { FORM_ERROR } from 'final-form';\nimport { HdPathInput } from 'form/Inputs';\n\nconst ACCOUNT_OPTIONS = times(20, i => ({\n  text: `Account #${i + 1}`,\n  value: i,\n}));\n\n// see Ledger.js for context — Trezor is basicaly Ledger with less complexity\nexport default function Trezor({ className, goHome }) {\n  useLoginView(WALLET_TYPES.TREZOR);\n\n  const { setWallet, setWalletHdPath, setAuthToken } = useWallet();\n\n  const validate = useMemo(\n    () =>\n      composeValidator({\n        useCustomPath: buildCheckboxValidator(),\n        account: buildSelectValidator(ACCOUNT_OPTIONS),\n        hdPath: buildHdPathValidator(),\n      }),\n    []\n  );\n\n  const onSubmit = useCallback(\n    async values => {\n      TrezorConnect.manifest({\n        email: 'bridge-trezor@urbit.org',\n        appUrl: 'https://github.com/urbit/bridge',\n      });\n\n      const { success, payload } = await TrezorConnect.getPublicKey({\n        path: values.hdPath,\n      });\n\n      if (!success) {\n        return { [FORM_ERROR]: 'Failed to authenticate with your Trezor.' };\n      }\n\n      // At this point, request is succesful, so payload will be\n      // type HDNodeResponse (seems Trezor lib's TS types are slightly off)\n      const publicKey = Buffer.from(\n        (payload as HDNodeResponse).publicKey,\n        'hex'\n      );\n      const chainCode = Buffer.from(\n        (payload as HDNodeResponse).chainCode,\n        'hex'\n      );\n\n      const pub = Buffer.from(publicKeyConvert(publicKey, true));\n      const hd = bip32.fromPublicKey(pub, chainCode);\n\n      const authToken = await getAuthToken({\n        wallet: hd,\n        walletType: WALLET_TYPES.TREZOR,\n        walletHdPath: values.hdPath,\n      });\n\n      setAuthToken(Just(authToken));\n      setWallet(Just(hd));\n      setWalletHdPath(values.hdPath);\n    },\n    [setAuthToken, setWallet, setWalletHdPath]\n  );\n\n  const onValues = useCallback(({ valid, values, form }) => {\n    if (!valid) {\n      return;\n    }\n\n    if (!values.useCustomPath) {\n      form.change('hdPath', TREZOR_PATH.replace(/x/g, values.account));\n    }\n  }, []);\n\n  const initialValues = useMemo(\n    () => ({\n      useCustomPath: false,\n      hdPath: TREZOR_PATH.replace(/x/g, ACCOUNT_OPTIONS[0].value),\n      account: ACCOUNT_OPTIONS[0].value,\n    }),\n    []\n  );\n\n  return (\n    <Grid className={className}>\n      <Grid.Item full as={Text} className=\"f6 gray4 mb3\">\n        Connect and authenticate to your Trezor. If you'd like to use a custom\n        derivation path, you may enter it below. Upon login, you will prompted\n        to sign the message \"Bridge Authentication Token\". This allows Bridge to\n        operate correctly. Never sign this message outside of Bridge.\n      </Grid.Item>\n\n      <BridgeForm\n        validate={validate}\n        onValues={onValues}\n        onSubmit={onSubmit}\n        afterSubmit={goHome}\n        initialValues={initialValues}>\n        {({ handleSubmit, submitting }) => (\n          <>\n            <Condition when=\"useCustomPath\" is={true}>\n              <Grid.Item full as={HdPathInput} name=\"hdPath\" label=\"HD Path\" />\n            </Condition>\n\n            <Condition when=\"useCustomPath\" is={false}>\n              <Grid.Item\n                full\n                as={SelectInput}\n                name=\"account\"\n                label=\"Account\"\n                placeholder=\"Choose account...\"\n                options={ACCOUNT_OPTIONS}\n              />\n            </Condition>\n\n            <Grid.Item\n              full\n              as={CheckboxInput}\n              className=\"mv3\"\n              name=\"useCustomPath\"\n              label=\"Custom HD Path\"\n            />\n\n            <Grid.Item full as={FormError} />\n\n            <Grid.Item full as={SubmitButton} handleSubmit={handleSubmit}>\n              {!submitting && 'Authenticate'}\n              {submitting && 'Please check your device'}\n            </Grid.Item>\n          </>\n        )}\n      </BridgeForm>\n    </Grid>\n  );\n}\n","import React from 'react';\nimport cn from 'classnames';\nimport { useFormState } from 'react-final-form';\n\nimport { ForwardButton } from 'components/Buttons';\n\nimport { blinkIf } from 'components/Blinky';\nimport { onlyHasWarning } from './helpers';\n\nexport default function SubmitButton({\n  as: As = ForwardButton,\n  className,\n  children,\n  handleSubmit,\n  ...rest\n}) {\n  const {\n    valid,\n    validating,\n    submitting,\n    hasValidationErrors,\n    hasSubmitErrors,\n    dirtySinceLastSubmit,\n    submitErrors,\n    submitSucceeded,\n  } = useFormState();\n\n  const onlyWarningInSubmitErrors = onlyHasWarning(submitErrors);\n\n  // can submit if:\n  // 1) is valid\n  //      OR has submit errors\n  //      AND\n  //        a) is dirty\n  //        b) OR only has a warning (double conf)\n  // 2) AND is not validating\n  // 3) AND has no validation errors\n  // 4) AND is not actively submitting\n  // 5) AND submit has not yet succeeded\n  const canSubmit =\n    (valid ||\n      (hasSubmitErrors &&\n        (dirtySinceLastSubmit || onlyWarningInSubmitErrors))) &&\n    !validating &&\n    !hasValidationErrors &&\n    !submitting &&\n    !submitSucceeded;\n\n  // show the warning action text if\n  // 1) we have that warning at all\n  // 2) we can submit or are submitting\n  const showWarningSubmitText =\n    onlyWarningInSubmitErrors &&\n    !dirtySinceLastSubmit &&\n    (canSubmit || submitting);\n\n  return (\n    <As\n      type=\"submit\"\n      className={cn('mt4', className)}\n      disabled={!canSubmit}\n      accessory={blinkIf(validating || submitting)}\n      onClick={handleSubmit}\n      solid\n      {...rest}>\n      {typeof children === 'function'\n        ? children(showWarningSubmitText)\n        : children}\n    </As>\n  );\n}\n","var noun    = require('./noun.js'),\n    list    = require('./list.js'),\n    Cell    = noun.Cell,\n    bits    = require('./bits.js'),\n    zero    = noun.Atom.yes,\n    one     = noun.Atom.no,\n    i       = noun.Atom.fromInt,\n    two     = i(2),\n    three   = i(3),\n    NounMap = require('./hamt.js').NounMap;\n\nfunction rub(a, b) {\n\tvar c, d, e, w, x, y, z, p, q, m;\n\n\tm = bits.add(a, i(bits.met(0, b)));\n\tx = a;\n\n\twhile ( zero.equals(bits.cut(zero, x, one, b)) ) {\n\t\ty = bits.add(one, x);\n\n\t\t//  Sanity check: crash if decoding more bits than available\n\t\tif ( bits.gth(x, m) ) {\n\t\t\tthrow new Error(\"Bail\");\n\t\t}\n\n\t\tx = y;\n\t}\n\n\tif ( a.equals(x) ) {\n\t\treturn new Cell(one, zero);\n\t}\n\n\tc = bits.sub(x, a);\n\td = bits.add(x, one);\n\n\tx = bits.dec(c);\n\ty = bits.bex(x);\n\tz = bits.cut(zero, d, x, b);\n\n\te = bits.add(y, z);\n\tw = bits.add(c, c);\n\ty = bits.add(w, e);\n\tz = bits.add(d, x);\n\n\tp = bits.add(w, e);\n\tq = bits.cut(zero, z, e, b);\n\n\treturn new Cell(p, q);\n}\n\nfunction cue_in(m, a, b) {\n  var c,l,u,v,w,y,p,q,d,x;\n\n  if ( zero.equals(bits.cut(zero, b, one, a)) ) {\n    x = bits.add(b, one);\n    c = rub(x, a);\n    p = bits.add(c.head, one);\n    q = c.tail;\n    m.insert(b, q);\n  }\n  else {\n    c = bits.add(two, b);\n    l = bits.add(one, b);\n\n    if ( zero.equals(bits.cut(zero, l, one, a)) ) {\n      u = cue_in(m, a, c);\n      x = bits.add(u.head, c);\n      v = cue_in(m, a, x);\n      w = new Cell(u.tail.head, v.tail.head);\n      y = bits.add(u.head, v.head);\n      p = bits.add(two, y);\n      q = w;\n      m.insert(b, q);\n    }\n    else {\n      d = rub(c, a);\n      x = m.get(d.tail);\n\n      if ( undefined === x ) {\n        throw new Error(\"Bail\");\n      }\n\n      p = bits.add(two, d.head);\n      q = x;\n    }\n  }\n  return new Cell(p, new Cell(q, zero));\n}\n\nfunction cue(a) {\n  return cue_in(new NounMap(), a, zero).tail.head;\n}\n\nfunction mat(a) {\n\tif ( zero.equals(a) ) {\n\t\treturn noun.dwim(1, 1);\n\t}\n  else {\n\t\tvar b = noun.dwim(bits.met(0, a)),\n\t\t    c = noun.dwim(bits.met(0, b)),\n\t\t    u = bits.dec(c),\n        v = bits.add(c, c),\n        x = bits.end(zero, u, b),\n        w = bits.bex(c),\n        y = bits.lsh(zero, u, a),\n        z = bits.mix(x, y),\n        p = bits.add(v, b),\n        q = bits.cat(zero, w, z);\n    return noun.dwim(p, q);\n\t}\n}\n\nfunction _jam_in_pair(m, h_a, t_a, b, l) {\n\tvar w = noun.dwim([2, 1], l),\n      x = bits.add(two, b),\n      d = _jam_in(m, h_a, x, w),\n      y = bits.add(x, d.head),\n      e = _jam_in(m, t_a, y, d.tail.head),\n      z = bits.add(d.head, e.head);\n\n  return noun.dwim(bits.add(two, z), e.tail.head, zero);\n}\n\nfunction _jam_in_ptr(m, u_c, l) {\n  var d = mat(u_c),\n      x = bits.lsh(zero, two, d.tail),\n      y = bits.add(two, d.head);\n\n  return noun.dwim(y, [[y, bits.mix(three, x)], l], zero);\n}\n\nfunction _jam_in_flat(m, a, l) {\n\tvar d = mat(a),\n      x = bits.add(one, d.head);\n\n  return noun.dwim(x, [[x, bits.lsh(zero, one, d.tail)], l], zero);\n}\n\nfunction _jam_in(m, a, b, l) {\n  var c = m.get(a);\n\n  if ( undefined === c ) {\n    m.insert(a, b);\n    return a.deep ?\n      _jam_in_pair(m, a.head, a.tail, b, l) :\n      _jam_in_flat(m, a, l);\n  }\n  else if ( !a.deep && bits.met(0, a) <= bits.met(0, c) ) {\n    return _jam_in_flat(m, a, l);\n  }\n  else {\n    return _jam_in_ptr(m, c, l);\n  }\n}\n\nfunction jam(n) {\n  var x = _jam_in(new NounMap(), n, zero, zero),\n      q = list.flop(x.tail.head);\n\n  return bits.can(zero, q);\n}\n\nmodule.exports = {\n  cue: cue,\n  mat: mat,\n  jam: jam\n};\n","import React, { createContext, forwardRef, useContext } from 'react';\n\nimport useRouter from 'lib/useRouter';\nimport { LocalRouterProvider } from 'lib/LocalRouter';\n\n/**\n * `useHistory` is just a global `useRouter`\n * and we call it `history` to distinguish it within a local router.\n * (see Invite.js for an example)\n */\n\nexport const HistoryContext = createContext(null);\n\nexport function HistoryProvider({ names, views, initialRoutes, children }) {\n  const router = useRouter({ names, views, initialRoutes });\n\n  return (\n    <HistoryContext.Provider value={router}>\n      <LocalRouterProvider value={router}>{children}</LocalRouterProvider>\n    </HistoryContext.Provider>\n  );\n}\n\n// Hook version\nexport function useHistory() {\n  return useContext(HistoryContext);\n}\n\n// HOC version\nexport const withHistory = Component =>\n  forwardRef((props, ref) => (\n    <HistoryContext.Consumer>\n      {router => <Component ref={ref} history={router} {...props} />}\n    </HistoryContext.Consumer>\n  ));\n","import React, { useState, useRef } from 'react';\nimport { times } from 'lodash';\n\nimport useInterval from 'lib/useInterval';\nimport { formatDots } from 'lib/dateFormat';\n\n// TODO: make these characters display as the same width\nexport const LOADING_CHARACTER = '▓';\nexport const INTERSTITIAL_CHARACTER = '░';\nconst BLINK_AFTER_MS = 2500; // ms\n\nconst buildDate = char =>\n  [4, 2, 2].map(t => times(t, () => char).join('')).join('.');\nconst DATE_A = buildDate(LOADING_CHARACTER);\nconst DATE_B = buildDate(INTERSTITIAL_CHARACTER);\n\nexport const matchBlinky = obj =>\n  obj.matchWith({\n    Nothing: () => <Blinky delayed />,\n    Just: p => p.value,\n  });\n\nexport const matchBlinkyDate = obj =>\n  obj.matchWith({\n    Nothing: () => <Blinky a={DATE_A} b={DATE_B} delayed />,\n    Just: p => formatDots(p.value),\n  });\n\nexport const blinkIf = (test, right) => (test ? <Blinky /> : right);\n\nexport default function Blinky({\n  a = LOADING_CHARACTER,\n  b = INTERSTITIAL_CHARACTER,\n  delayed = false,\n}) {\n  const [value, setValue] = useState(true);\n  const now = useRef(new Date());\n\n  useInterval(() => {\n    // only start blinking if we've elapsed enough time and want to delay\n    if (!delayed || new Date() - now.current > BLINK_AFTER_MS) {\n      setValue(val => !val);\n    }\n  }, 1000);\n\n  return <span className=\"arial\">{value ? a : b}</span>;\n}\n","import { useEffect, useRef } from 'react';\n\n// via: https://overreacted.io/making-setinterval-declarative-with-react-hooks/\nexport default function useInterval(callback, delay) {\n  const savedCallback = useRef();\n\n  // Remember the latest callback.\n  useEffect(() => {\n    savedCallback.current = callback;\n  }, [callback]);\n\n  // Set up the interval.\n  useEffect(() => {\n    function tick() {\n      savedCallback.current();\n    }\n    if (delay !== null) {\n      let id = setInterval(tick, delay);\n      return () => clearInterval(id);\n    }\n  }, [delay]);\n}\n","import Common, { Chain, Hardfork } from '@ethereumjs/common';\nimport { JsonTx, Transaction } from '@ethereumjs/tx';\nimport { ITxData } from '@walletconnect/types';\nimport { toHex } from 'web3-utils';\nimport { safeFromWei, safeToWei } from './lib';\nimport retry from 'async-retry';\n\nimport { NETWORK_TYPES } from './network';\nimport { ledgerSignTransaction } from './ledger';\nimport { trezorSignTransaction } from './trezor';\nimport { walletConnectSignTransaction } from './WalletConnect';\nimport { metamaskSignTransaction } from './metamask';\nimport { addHexPrefix } from './utils/address';\nimport { CHECK_BLOCK_EVERY_MS, WALLET_TYPES } from './constants';\nimport { patp2dec } from './patp2dec';\nimport Web3 from 'web3';\n\nconst RETRY_OPTIONS = {\n  retries: 99999,\n  factor: 1,\n  minTimeout: CHECK_BLOCK_EVERY_MS,\n  randomize: false,\n};\n\n// catch-all type: Metamask passes an obj shaped like ITxData, WC passes JsonTx + from\nexport type FakeSignableTx =\n  | ITxData\n  | (JsonTx & { from: string; to: string; gas: string });\n\ntype TxSender = (txn: FakeSignableTx, web3: Web3) => Promise<string>; // Metamask requires Web3 (txhash)\n\ntype SignedTx = {\n  serialize: () => string;\n};\n\ntype FakeSignedTx = SignedTx & {\n  txn: FakeSignableTx;\n  send: TxSender;\n};\n\nconst FakeSignResult = (txn: FakeSignableTx, send: TxSender): FakeSignedTx => {\n  return {\n    txn,\n    serialize: () => {\n      return '???'; //NOTE  update tank.js when changing this!\n    },\n    send,\n  };\n};\n\nconst signTransaction = async ({\n  wallet,\n  walletType,\n  walletHdPath,\n  networkType,\n  txn,\n  nonce, // number\n  chainId, // number\n  gasPrice, // string, in gwei\n  gasLimit, // string | number\n  txnSigner, // optionally inject a transaction signing function,\n  txnSender, // and a sending function, for wallets that need these passed in.\n}) => {\n  // TODO: require these in txn object\n  nonce = toHex(nonce);\n  chainId = toHex(chainId);\n  gasPrice = toHex(safeToWei(gasPrice, 'gwei'));\n  gasLimit = toHex(gasLimit);\n  const from = wallet.address;\n\n  const txParams = { nonce, chainId, gasPrice, gasLimit, from };\n\n  // NB (jtobin)\n  //\n  // Ledger does not seem to handle EIP-155 automatically.  When using a Ledger,\n  // if the block number is at least FORK_BLKNUM = 2675000, one needs to\n  // pre-set the ECDSA signature parameters with r = 0, s = 0, and v = chainId\n  // prior to signing.\n  //\n  // The easiest way to handle this is to just branch on the network, since\n  // mainnet and Ropsten have obviously passed FORK_BLKNUM.  This is somewhat\n  // awkward when dealing with offline transactions, since we might want to\n  // test them on a local network as well.\n  //\n  // The best thing to do is probably to add an 'advanced' tab to offline\n  // transaction generation where one can disable the defaulted-on EIP-155\n  // settings in this case.  This is pretty low-priority, but is a\n  // comprehensive solution.\n  //\n  // See:\n  //\n  // See https://github.com/LedgerHQ/ledgerjs/issues/43#issuecomment-366984725\n  //\n  // https://github.com/ethereum/EIPs/blob/master/EIPS/eip-155.md\n\n  const eip155Params = {\n    r: '0x00',\n    s: '0x00',\n    v: chainId,\n  };\n\n  const defaultEip155Networks = [\n    NETWORK_TYPES.MAINNET,\n    NETWORK_TYPES.ROPSTEN,\n    NETWORK_TYPES.OFFLINE,\n  ];\n\n  const needEip155Params =\n    walletType === WALLET_TYPES.LEDGER &&\n    defaultEip155Networks.includes(networkType);\n\n  const signingParams = needEip155Params\n    ? Object.assign(txParams, eip155Params)\n    : txParams;\n\n  const utx = Object.assign(txn, signingParams);\n\n  const txConfig: any = { freeze: false };\n  //  we must specify the chain *either* in the Common object,\n  //  *or* eip155 style, but never both!\n  //\n  if (!needEip155Params) {\n    const chain =\n      networkType === NETWORK_TYPES.ROPSTEN ? Chain.Ropsten : Chain.Mainnet;\n    txConfig.common = new Common({\n      chain: chain,\n      hardfork: Hardfork.MuirGlacier,\n    });\n  }\n\n  let stx = Transaction.fromTxData(utx, txConfig);\n\n  //TODO should try-catch and display error message to user,\n  //     ie ledger's \"pls enable contract data\"\n  //     needs to maybe happen at call-site though\n  if (walletType === WALLET_TYPES.LEDGER) {\n    await ledgerSignTransaction(stx, walletHdPath);\n  } else if (walletType === WALLET_TYPES.TREZOR) {\n    await trezorSignTransaction(stx, walletHdPath);\n  } else if (walletType === WALLET_TYPES.METAMASK) {\n    return metamaskSignTransaction(utx, wallet.address);\n  } else if (walletType === WALLET_TYPES.WALLET_CONNECT) {\n    stx = await walletConnectSignTransaction({\n      from,\n      txn: stx,\n      txnSigner,\n      txnSender,\n    });\n  } else {\n    stx = stx.sign(wallet.privateKey);\n  }\n\n  return stx;\n};\n\nconst sendSignedTransaction = (\n  web3: Web3,\n  stx: Transaction | FakeSignedTx,\n  doubtNonceError: boolean\n): Promise<string> => {\n  //  if we couldn't sign it, we depend on the given sender function\n  if (!(stx instanceof Transaction)) {\n    if (doubtNonceError) {\n      console.log('why doubting nonce error? tank unavailable without rawtx.');\n    }\n    if (!stx.send) {\n      throw new Error('no sign+sending function available');\n    }\n    return stx.send(stx.txn, web3);\n  }\n\n  let rawTx: string = hexify(stx.serialize());\n  let eventEmitter = web3.eth.sendSignedTransaction(rawTx);\n  return new Promise(async (resolve, reject) => {\n    eventEmitter\n      .on('transactionHash', (hash: string) => {\n        resolve(hash);\n      })\n      .on('error', err => {\n        // if there's a nonce error, but we used the gas tank, it's likely\n        // that it's because the tank already submitted our transaction.\n        // we just wait for first confirmation here.\n        const message = typeof err === 'string' ? err : err.message || '';\n        const isKnownError =\n          message.includes('known transaction') ||\n          message.includes('already known');\n        const isNonceError =\n          message.includes(\"the tx doesn't have the correct nonce.\") ||\n          message.includes('nonce too low');\n        if (rawTx && (isKnownError || (doubtNonceError && isNonceError))) {\n          console.log(\n            'tx send error likely from gas tank submission, ignoring:',\n            message\n          );\n          const txHash = web3.utils.keccak256(rawTx);\n          resolve(txHash);\n        } else {\n          console.error(err);\n          const wrappedErr = err instanceof Error ? err : new Error(message);\n          reject(wrappedErr);\n        }\n      });\n  });\n};\n\n// returns a Promise<void>, throwing on tx failure\nconst waitForTransactionConfirm = (web3, txHash) => {\n  return retry(async (bail, n) => {\n    const receipt = await web3.eth.getTransactionReceipt(txHash);\n    const confirmed = receipt !== null;\n    if (!confirmed) {\n      throw new Error('Transaction not confirmed.');\n    }\n\n    const success = receipt.status === true;\n    if (!success) {\n      return bail(new Error('Transaction failed.'));\n    }\n    return receipt;\n  }, RETRY_OPTIONS);\n};\n\n// returns a Promise that resolves when all stxs have been sent & confirmed\nconst sendAndAwaitAll = (web3, stxs, doubtNonceError) => {\n  return Promise.all(\n    stxs.map(async tx => {\n      const txHash = await sendSignedTransaction(web3, tx, doubtNonceError);\n      return await waitForTransactionConfirm(web3, txHash);\n    })\n  );\n};\n\nconst sendAndAwaitAllSerial = (web3, stxs, doubtNonceError) => {\n  return stxs.reduce(\n    (promise, stx) =>\n      promise.then(async (receipts = []) => {\n        const txHash = await sendSignedTransaction(web3, stx, doubtNonceError);\n        return [...receipts, await waitForTransactionConfirm(web3, txHash)];\n      }),\n    Promise.resolve()\n  );\n};\n\nconst sendTransactionsAndAwaitConfirm = async (web3, signedTxs, usedTank) =>\n  Promise.all(signedTxs.map(tx => sendSignedTransaction(web3, tx, usedTank)));\n\nconst hexify = val => addHexPrefix(val.toString('hex'));\n\nconst renderSignedTx = stx => ({\n  messageHash: hexify(stx.hash()),\n  v: hexify(stx.v),\n  s: hexify(stx.s),\n  r: hexify(stx.r),\n  rawTransaction: hexify(stx.serialize()),\n});\n\nconst getTxnInfo = async (web3, addr) => {\n  let nonce = await web3.eth.getTransactionCount(addr);\n  let chainId = await web3.eth.net.getId();\n  let gasPrice = await web3.eth.getGasPrice();\n\n  return {\n    nonce: nonce,\n    chainId: chainId,\n    gasPrice: safeFromWei(gasPrice, 'gwei'),\n  };\n};\n\n// TODO(shrugs): deprecate, unifiy with other callsites\nconst canDecodePatp = p => {\n  try {\n    patp2dec(p);\n    return true;\n  } catch (_) {\n    return false;\n  }\n};\n\nexport {\n  RETRY_OPTIONS,\n  FakeSignResult,\n  signTransaction,\n  sendSignedTransaction,\n  waitForTransactionConfirm,\n  sendTransactionsAndAwaitConfirm,\n  sendAndAwaitAll,\n  sendAndAwaitAllSerial,\n  getTxnInfo,\n  hexify,\n  renderSignedTx,\n  canDecodePatp,\n};\n","import ob from 'urbit-ob';\nimport { patp2dec } from './patp2dec';\nimport { fromWei, toWei, toBN } from 'web3-utils';\n\nconst safeFromWei = (num, target) => {\n  try {\n    return fromWei(toBN(num), target);\n  } catch (e) {\n    e.message =\n      `(safeFromWei got ${typeof num} (${num}), made ${typeof toBN(\n        num\n      )}. Please report this issue!) ` + e.message;\n    throw e;\n  }\n};\n\nconst safeToWei = (num, source) => {\n  try {\n    return toWei(toBN(num), source);\n  } catch (e) {\n    e.message =\n      `(safeToWei got ${typeof num} (${num}), made ${typeof toBN(\n        num\n      )}. Please report this issue!) ` + e.message;\n    throw e;\n  }\n};\n\nconst compose = (...fs) =>\n  fs.reduceRight(\n    (pF, nF) => (...args) => nF(pF(...args)),\n    v => v\n  );\n\nconst allFalse = (...args) => args.every(a => a === false);\n\nconst isLast = (l, i) => i === l - 1;\n\nconst isUndefined = v => v === undefined;\n\nconst defaultTo = (v, d) => (isUndefined(v) ? d : v);\n\nconst seq = n => Array.from(Array(n), (_, i) => i);\n\nconst fill = (n, v) => Array.from(Array(n), () => v);\n\nconst strSplice = (arr, i, val) => `${arr.slice(0, i)}${val}${arr.slice(i)}`;\n\nconst isValidGalaxy = name => {\n  let point;\n  try {\n    point = patp2dec(name);\n  } catch (err) {\n    return false;\n  }\n  return point >= 0 && point < 256;\n};\n\nconst randomPatq = len => {\n  let bytes = window.crypto.getRandomValues(new Uint8Array(len));\n  let hex = bytes.reduce(\n    (acc, byt) => acc + byt.toString(16).padStart(2, '0'),\n    ''\n  );\n  return ob.hex2patq(hex);\n};\n\n// TODO: is there a function for this calculation in urbit-ob or similar?\n// 3 characters per byte, plus a tilde and hypen prefix per pair of bytes\nconst patpStringLength = byteLength =>\n  byteLength * 3 + Math.ceil(byteLength / 2);\n\nexport {\n  safeFromWei,\n  safeToWei,\n  compose,\n  allFalse,\n  isLast,\n  isUndefined,\n  defaultTo,\n  seq,\n  fill,\n  strSplice,\n  isValidGalaxy,\n  randomPatq,\n  patpStringLength,\n};\n","import { version } from '../../package.json';\n\n// are we running bridge in a development build\nexport const isDevelopment = process.env.NODE_ENV === 'development';\nexport const isRopsten = process.env.REACT_APP_ROPSTEN === 'true';\nexport const isMainnet = process.env.REACT_APP_MAINNET === 'true';\nexport const versionLabel =\n  process.env.REACT_APP_BRIDGE_VERSION || `${version}${isRopsten ? 'r' : ''}`;\n","const NETWORK_TYPES = {\n  OFFLINE: Symbol('OFFLINE'),\n  LOCAL: Symbol('LOCAL'),\n  ROPSTEN: Symbol('ROPSTEN'),\n  MAINNET: Symbol('MAINNET'),\n};\n\nconst renderNetworkType = network =>\n  network === NETWORK_TYPES.OFFLINE\n    ? 'Offline'\n    : network === NETWORK_TYPES.ROPSTEN\n    ? 'Ropsten'\n    : network === NETWORK_TYPES.MAINNET\n    ? 'Main Network'\n    : network === NETWORK_TYPES.LOCAL\n    ? 'Local Node'\n    : 'Offline';\n\nconst chainIdToNetworkType = chainId => {\n  switch (chainId) {\n    case '0x1':\n      return NETWORK_TYPES.MAINNET;\n    case '0x3':\n      return NETWORK_TYPES.ROPSTEN;\n    default:\n      return NETWORK_TYPES.LOCAL;\n  }\n};\n\nexport { NETWORK_TYPES, renderNetworkType, chainIdToNetworkType };\n","import BN from 'bn.js';\nimport { Just, Nothing } from 'folktale/maybe';\n\nimport * as noun from '../nockjs/noun';\nimport * as serial from '../nockjs/serial';\nimport * as kg from 'urbit-key-generation';\n\nimport { addHexPrefix, eqAddr } from './utils/address';\nimport { shas } from './networkCode';\n\n// the curve param for the network keys\nexport const NETWORK_KEY_CURVE_PARAMETER = '42';\n// the current crypto suite version\nexport const CRYPTO_SUITE_VERSION = 1;\n\nexport const CURVE_ZERO_ADDR =\n  '0x0000000000000000000000000000000000000000000000000000000000000000';\n\n// ctsy joemfb\nconst b64 = buf => {\n  let hex = buf.reverse().toString('hex');\n  let n = new BN(hex, 'hex');\n  let c = [];\n  while (1 === n.cmpn(0)) {\n    c.push(n.andln(0x3f));\n    n = n.shrn(6);\n  }\n\n  // prettier-ignore\n  const trans = j =>\n    10 > j\n    ? j + 48\n    : 36 > j\n    ? j + 87\n    : 62 > j\n    ? j + 29\n    : 62 === j\n    ? 45\n    : 126;\n\n  return (\n    '0w' +\n    c.reduce(\n      (a, b, i) =>\n        String.fromCharCode(trans(b)) + (i && 0 === i % 5 ? '.' : '') + a,\n      ''\n    )\n  );\n};\n\nconst jam = seed => {\n  const hex = serial\n    .jam(seed)\n    .toString()\n    .slice(2);\n  const pad = hex.length % 2 === 0 ? hex : '0' + hex;\n  return Buffer.from(pad, 'hex').reverse();\n};\n\n// simple alias to avoid importing kg into component scope\nexport const deriveNetworkKeys = seed => kg.deriveNetworkKeys(seed);\n\nexport const createRing = pair =>\n  pair.crypt.private + pair.auth.private + NETWORK_KEY_CURVE_PARAMETER;\n\n/**\n * @param {object} pair\n * @param {number} point\n * @param {number} revision\n * @return {string}\n */\nexport const compileNetworkingKey = (pair, point, revision) => {\n  const bnsec = new BN(createRing(pair), 'hex');\n\n  const sed = noun.dwim(\n    noun.Atom.fromInt(point),\n    noun.Atom.fromInt(revision),\n    noun.Atom.fromString(bnsec.toString()),\n    noun.Atom.yes\n  );\n\n  return b64(jam(sed));\n};\n\n/**\n * @param {object} urbitWallet\n * @param {number} revision\n * @return {Promise<Maybe<string>>}\n */\nexport const deriveNetworkSeedFromUrbitWallet = async (\n  urbitWallet,\n  revision = 1\n) => {\n  return await deriveNetworkSeedFromMnemonic(\n    urbitWallet.management.seed,\n    urbitWallet.meta.passphrase,\n    revision\n  );\n};\n\n/**\n * @param {Maybe<any>} wallet\n * @param {string} authMnemonic\n * @param {object} details\n * @param {number} revision\n * @return {Promise<Maybe<string>>}\n */\nexport const deriveNetworkSeedFromManagementMnemonic = async (\n  wallet,\n  authMnemonic,\n  details,\n  revision = 1\n) => {\n  const isManagementProxy = eqAddr(wallet.address, details.managementProxy);\n\n  // the network seed is derivable iff this mnemonic is the management proxy\n  if (isManagementProxy) {\n    return await deriveNetworkSeedFromMnemonic(\n      authMnemonic,\n      wallet.passphrase,\n      revision\n    );\n  }\n\n  return Nothing();\n};\n\n/**\n * @param {string} mnemonic\n * @param {string} passphrase\n * @param {number} revision\n * @return {Promise<Maybe<string>>}\n */\nconst deriveNetworkSeedFromMnemonic = async (\n  mnemonic,\n  passphrase,\n  revision\n) => {\n  //NOTE revision is the point's on-chain revision number. since common uhdw\n  //     usage derives the first key at revision/index 0, we need to decrement\n  //     the on-chain revision number by one to get the number to derive with.\n  return Just(await kg.deriveNetworkSeed(mnemonic, passphrase, revision - 1));\n};\n\n/**\n * @param {number} point\n * @param {string} authToken\n * @param {number} revision\n * @return {Maybe<string>}\n */\nexport const deriveNetworkSeedFromAuthToken = (point, authToken, revision) => {\n  //NOTE revision is the point's on-chain revision number.\n  //     since deriveNetworkSeedFromMnemonic does this too, we decrement the\n  //     revision number by one before deriving from it.\n  const salt = Buffer.from(`revision-${point}-${revision - 1}`);\n  const networkSeed = shas(authToken, salt)\n    .toString('hex')\n    .slice(0, 32);\n  return Just(networkSeed);\n};\n\n/**\n * Derives from either a full Urbit Wallet, a current management mnemonic,\n * or an auth token, in that order of preference.\n * @return {Promise<Maybe<string>>}\n */\nexport const attemptNetworkSeedDerivation = async ({\n  urbitWallet,\n  wallet,\n  authMnemonic,\n  details,\n  point,\n  authToken,\n  revision,\n}) => {\n  if (Just.hasInstance(urbitWallet)) {\n    return await deriveNetworkSeedFromUrbitWallet(urbitWallet.value, revision);\n  }\n\n  if (Just.hasInstance(wallet) && Just.hasInstance(authMnemonic)) {\n    const managementSeed = await deriveNetworkSeedFromManagementMnemonic(\n      wallet.value,\n      authMnemonic.value,\n      details,\n      revision\n    );\n    if (Just.hasInstance(managementSeed)) {\n      return managementSeed;\n    }\n  }\n\n  if (Just.hasInstance(authToken)) {\n    return deriveNetworkSeedFromAuthToken(point, authToken.value, revision);\n  }\n\n  return Nothing();\n};\n\n/**\n *\n * @param {object} pair\n * @param {object} details\n * @return {boolean}\n */\nexport const keysMatchChain = (pair, details) => {\n  const { crypt, auth } = pair;\n  const { encryptionKey, authenticationKey } = details;\n\n  return (\n    encryptionKey === addHexPrefix(crypt.public) &&\n    authenticationKey === addHexPrefix(auth.public)\n  );\n};\n\nexport const segmentNetworkKey = hex => {\n  if (hex === CURVE_ZERO_ADDR) {\n    return null;\n  }\n\n  const sl = i => hex.slice(i, i + 4);\n  const rowFrom = i => `${sl(i)}.${sl(i + 4)}.${sl(i + 8)}.${sl(i + 12)}`;\n\n  return [rowFrom(2), rowFrom(18), rowFrom(34), rowFrom(50)];\n};\n","import { useField } from 'react-final-form';\n\n// inspired by: https://codesandbox.io/s/lm4p3m92q\n// renders childen if the relevant field's value is the test value\nexport default function Condition({ when, is, children }) {\n  const {\n    input: { value },\n  } = useField(when, { subscription: { value: true } });\n\n  return value === is ? children : null;\n}\n","import ob from 'urbit-ob';\n\nimport { convertToInt } from './convertToInt';\n\n/**\n * Convert a patp string into a number, or throw.\n *\n * @throws\n * @return number\n */\nexport const patp2dec = patp => convertToInt(ob.patp2dec(patp), 10);\n","// import * as bip32 from 'bip32';\nimport * as bip39 from 'bip39';\nimport { bip32 } from 'bitcoinjs-lib';\nimport { Just, Nothing } from 'folktale/maybe';\nimport * as secp256k1 from 'secp256k1';\nimport * as kg from 'urbit-key-generation';\nimport { publicToAddress } from './utils/address';\n\nexport function EthereumWallet(privateKey) {\n  this.privateKey = privateKey;\n  this.publicKey = secp256k1.publicKeyCreate(this.privateKey);\n  this.address = publicToAddress(this.publicKey);\n}\n\nexport const urbitWalletFromTicket = async (ticket, point, passphrase) => {\n  return await kg.generateWallet({\n    ticket: ticket,\n    ship: point,\n    passphrase: passphrase,\n  });\n};\n\nexport const walletFromMnemonic = (\n  mnemonic,\n  hdpath,\n  passphrase,\n  skipMnemonicCheck\n) => {\n  const seed =\n    skipMnemonicCheck || bip39.validateMnemonic(mnemonic)\n      ? Just(bip39.mnemonicToSeedSync(mnemonic, passphrase))\n      : Nothing();\n\n  const toWallet = (sd, path) => {\n    let wal;\n    const hd = bip32.fromSeed(sd);\n    wal = hd.derivePath(path);\n    wal.address = publicToAddress(wal.publicKey);\n    wal.passphrase = passphrase || '';\n    wal = Just(wal);\n    return wal;\n  };\n\n  const wallet = seed.chain(sd => toWallet(sd, hdpath));\n\n  return wallet;\n};\n","import { useEffect } from 'react';\nimport { Nothing } from 'folktale/maybe';\n\nimport { useWallet } from 'store/wallet';\nimport { usePointCursor } from 'store/pointCursor';\n\n// All the things we want to do when we mount a login view\nexport default function useLoginView(walletType) {\n  const { setWalletType, resetWallet } = useWallet();\n  const { setPointCursor } = usePointCursor();\n\n  useEffect(() => {\n    resetWallet();\n    setWalletType(walletType);\n    setPointCursor(Nothing());\n  }, [setWalletType, walletType, setPointCursor, resetWallet]);\n}\n","import React from 'react';\nimport { createTeleporter } from 'react-teleporter';\n\nconst NavHeaderTeleporter = createTeleporter();\n\nconst NavHeader = NavHeaderTeleporter.Source;\nNavHeader.Target = props => <NavHeaderTeleporter.Target as=\"div\" {...props} />;\n\nexport default NavHeader;\n","import { compose, strSplice } from 'lib/lib';\nimport { convertToInt } from 'lib/convertToInt';\n\nconst HEX_PREFIX = '0x';\nconst TICKET_MAX_BYTE_LEN = 32; // tickets can be as large as 32 bytes\nconst PAT_BLOCK_CHAR_LENGTH = 6; // pat{p,q} blocks are 6 characters long\n\nexport const buildFormatter = (formatters = []) =>\n  compose(...formatters.reverse());\n\n/**\n * inserts a ~ or - before every pat block\n */\nexport const ensurePatFormat = s => {\n  // bail if falsy or empty string, nothing to do\n  if (!s || s.length === 0) {\n    return s || '';\n  }\n\n  // ensure there's a dash every 6 + 1 characters\n  const dashAt = i => i * (PAT_BLOCK_CHAR_LENGTH + 1);\n  const maxBlocks = TICKET_MAX_BYTE_LEN / 2;\n\n  // for every index that may need a separator\n  for (let i = 0; i !== maxBlocks; i++) {\n    const dashIndex = dashAt(i);\n\n    // if the string is too short to have a separator here, we're done\n    if (s.length - 1 < dashIndex) {\n      return s;\n    }\n\n    // insert the separator at the correct index if not already there\n    const sep = i === 0 ? '~' : '-';\n    if (s.charAt(dashIndex) !== sep) {\n      s = strSplice(s, dashIndex, sep);\n    }\n  }\n\n  return s;\n};\n\nexport const ensureHexPrefix = s => {\n  if (!s || s.length < HEX_PREFIX.length) {\n    return s || '';\n  }\n\n  return s.indexOf(HEX_PREFIX) !== 0 ? `${HEX_PREFIX}${s}` : s;\n};\n\nexport const convertToNumber = s => {\n  if (!s) {\n    return s || '';\n  }\n\n  try {\n    return convertToInt(s, 10);\n  } catch {\n    return 0;\n  }\n};\n\nexport const downcase = s => {\n  if (!s) {\n    return s;\n  }\n\n  return s.toLowerCase();\n};\n\nexport const stripHexPrefix = s => {\n  if (!s) {\n    return s;\n  }\n\n  return s.toLowerCase().indexOf(HEX_PREFIX) === 0\n    ? s.slice(HEX_PREFIX.length)\n    : s;\n};\n","import { safeFromWei } from './lib';\n\nconst BRIDGE_ERROR = {\n  MISSING_WEB3: 'no web3 object found',\n  MISSING_WALLET: 'no wallet found',\n  MISSING_TXN: 'no transaction found',\n  MISSING_CONTRACTS: 'no contracts found',\n  MISSING_KEYSTORE: 'no keystore text found',\n  MISSING_MNEMONIC: 'no authentication mnemonic found',\n  MISSING_URBIT_WALLET: 'no urbit wallet found',\n  MISSING_POINT: 'no point found',\n  MISSING_POINT_DETAILS: 'no details of point found',\n  INVALID_ROUTE: 'invalid route',\n  INVALID_NETWORK_TYPE: 'invalid network type',\n  INVALID_WALLET_TYPE: 'invalid wallet type',\n};\n\nconst renderTxnError = (web3, msg) => {\n  const txnCost = (web3, msg) => {\n    const costWei = msg.match(/upfront cost is: ([0-9]+)/);\n    const costEth = safeFromWei(costWei[1], 'ether');\n    return parseFloat(costEth).toFixed(4);\n  };\n\n  const acctBalance = (web3, msg) => {\n    const balWei = msg.match(/sender's account only has: ([0-9]+)/);\n    const balEth = safeFromWei(balWei[1], 'ether');\n    return parseFloat(balEth).toFixed(4);\n  };\n\n  return msg.includes(\"doesn't have enough funds\")\n    ? \"The account doesn't have enough Ether. \" +\n        `The up-front transaction cost is ${txnCost(web3, msg)} ETH, but the ` +\n        `account only holds ${acctBalance(web3, msg)} ETH.`\n    : 'You may want to verify that the account that has signed the ' +\n        'transaction holds sufficient Ether to pay for the gas, and ' +\n        \"also that you haven't set the gas limit for the transaction \" +\n        'too low.';\n};\n\nexport { BRIDGE_ERROR, renderTxnError };\n"],"sourceRoot":""}